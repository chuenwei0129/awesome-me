# äººç±»é«˜è´¨é‡å‡½æ•°å¼ç¼–ç¨‹å­¦ä¹ æŒ‡å—

## ç¼–ç¨‹èŒƒå¼

### å‘½ä»¤å¼ç¼–ç¨‹

**å‘½ä»¤å¼ç¼–ç¨‹** æ˜¯ä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ç¼–ç¨‹é£æ ¼ï¼Œå®ƒæ˜¯ç«™åœ¨è®¡ç®—æœºçš„è§’åº¦å»æ€è€ƒé—®é¢˜ï¼Œä¸»è¦æ€æƒ³æ˜¯ï¼š**å…³æ³¨è®¡ç®—æœºæ‰§è¡Œçš„æ­¥éª¤ï¼Œå³ä¸€æ­¥ä¸€æ­¥å‘Šè¯‰è®¡ç®—æœºå…ˆåšä»€ä¹ˆå†åšä»€ä¹ˆã€‚**

ç”±äºå­˜åœ¨å¾ˆå¤šéœ€è¦æ§åˆ¶çš„æ­¥éª¤ï¼Œæ‰€ä»¥å‘½ä»¤å¼ç¼–ç¨‹æ™®éå­˜åœ¨ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- **æ§åˆ¶è¯­å¥**
  - å¾ªç¯è¯­å¥ï¼š`while`ã€`for`
  - æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼š`if else`ã€`switch`
  - æ— æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼š`return`ã€`break`ã€`continue`
- **å˜é‡**
  - èµ‹å€¼è¯­å¥

> **ğŸŒ° ä¾‹å­ï¼š**

```js
// éœ€æ±‚ï¼šç­›é€‰å‡ºæ•°ç»„ä¸­ä¸ºå¥‡æ•°çš„å­é›†åˆ

const arr = [1, 2, 3, 4, 5, 6, 7, 8, 9]
// æ­¥éª¤ 1ï¼šå®šä¹‰æ‰§è¡Œç»“æœå˜é‡
const res = []
// æ­¥éª¤ 2ï¼šæ§åˆ¶ç¨‹åºå¾ªç¯è°ƒç”¨
for (let i = 0; i < arr.length; i++) {
  // æ­¥éª¤ 3ï¼šåˆ¤æ–­ç­›é€‰æ¡ä»¶
  if (arr[i] % 2 !== 0) {
    // æ­¥éª¤ 4ï¼šåŠ å…¥æ‰§è¡Œç»“æœ
    res.push(arr[i])
  }
}

// æ­¥éª¤ 5ï¼šå¾—åˆ°æœ€ç»ˆçš„ç»“æœ res
console.log(res) // [1, 3, 5, 7, 9]
```

**ä¼˜ç‚¹ï¼š**

å‘½ä»¤å¼ç¼–ç¨‹çš„æ¯ä¸€ä¸ªæ­¥éª¤éƒ½å¯ä»¥ç”±ç¨‹åºå‘˜å®šä¹‰ï¼Œè¿™æ ·å¯ä»¥æ›´ç²¾ç»†åŒ–ã€æ›´ä¸¥è°¨åœ°æ§åˆ¶ä»£ç ï¼Œä»è€Œæé«˜ç¨‹åºçš„æ€§èƒ½ã€‚

**ç¼ºç‚¹ï¼š**

å‘½ä»¤å¼ç¼–ç¨‹éœ€è¦å¤§é‡çš„æµç¨‹æ§åˆ¶è¯­å¥ï¼Œåœ¨å¤„ç†å¤šçº¿ç¨‹çŠ¶æ€åŒæ­¥é—®é¢˜æ—¶ï¼Œå®¹æ˜“é€ æˆé€»è¾‘æ··ä¹±ï¼Œé€šå¸¸éœ€è¦åŠ é”æ¥è§£å†³ã€‚

### å£°æ˜å¼ç¼–ç¨‹

**å£°æ˜å¼ç¼–ç¨‹** åŒæ ·æ˜¯ä¸€ç§ç¼–ç¨‹é£æ ¼ï¼Œå®ƒé€šè¿‡å®šä¹‰å…·ä½“çš„è§„åˆ™ï¼Œä»¥ä¾¿ç³»ç»Ÿåº•å±‚å¯ä»¥è‡ªåŠ¨å®ç°å…·ä½“åŠŸèƒ½ã€‚ä¸»è¦æ€æƒ³æ˜¯ï¼š**å‘Šè¯‰è®¡ç®—æœºåº”è¯¥åšä»€ä¹ˆï¼Œä½†ä¸æŒ‡å®šå…·ä½“è¦æ€ä¹ˆåšã€‚**

> **ç”¨å£°æ˜å¼çš„æ–¹å¼é‡æ„ä¾‹å­ï¼š**

```js
// ç­›é€‰å‡ºæ•°ç»„ä¸­ä¸ºå¥‡æ•°çš„å­é›†åˆ
const array = [1, 2, 3, 4, 5, 6, 7, 8, 9]
const result = array.filter(item => item % 2 !== 0)
console.log(result) // [1, 3, 5, 7, 9]
```

**å£°æ˜å¼ç¼–ç¨‹çš„ä¼˜ç¼ºç‚¹ï¼š**

- å£°æ˜å¼ç¼–ç¨‹çš„å…·ä½“æ“ä½œéƒ½æ˜¯åº•å±‚ç»Ÿä¸€ç®¡ç†ï¼Œå¯ä»¥é™ä½é‡å¤å·¥ä½œã€‚
- å£°æ˜å¼ç¼–ç¨‹åº•å±‚å®ç°çš„é€»è¾‘å¹¶ä¸å¯æ§ï¼Œä¸é€‚åˆåšæ›´ç²¾ç»†åŒ–çš„ä¼˜åŒ–ã€‚

å…¸å‹çš„å£°æ˜å¼ç¼–ç¨‹çš„æ¡ˆä¾‹ï¼šHTML æ ‡ç­¾å£°æ˜ç½‘é¡µçš„å†…å®¹ã€‚

### å‡½æ•°å¼ç¼–ç¨‹

**å‡½æ•°å¼ç¼–ç¨‹** å±äºå£°æ˜å¼ç¼–ç¨‹ä¸­çš„ä¸€ç§ï¼Œå®ƒçš„ä¸»è¦æ€æƒ³æ˜¯ï¼š**å°†è®¡ç®—æœºè¿ç®—çœ‹ä½œä¸ºå‡½æ•°çš„è®¡ç®—ï¼Œä¹Ÿå°±æ˜¯æŠŠç¨‹åºé—®é¢˜æŠ½è±¡æˆæ•°å­¦é—®é¢˜å»è§£å†³ã€‚**

**å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„å˜é‡éƒ½æ˜¯å”¯ä¸€çš„å€¼**ï¼Œå°±åƒæ˜¯æ•°å­¦ä¸­çš„ä»£æ•° `x`ã€`y`ï¼Œå®ƒä»¬è¦ä¹ˆè¿˜æœªè§£å‡ºæ¥ï¼Œè¦ä¹ˆå·²ç»è¢«è§£å‡ºä¸ºå›ºå®šå€¼ï¼Œæ‰€ä»¥å¯¹äºï¼š`x = x+1` è¿™æ ·çš„è‡ªå¢æ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºä¿®æ”¹äº†ä»£æ•°å€¼ï¼Œä¸ç¬¦åˆæ•°å­¦é€»è¾‘ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œ**ä¸¥æ ¼æ„ä¹‰ä¸Šçš„å‡½æ•°å¼ç¼–ç¨‹ä¹Ÿä¸åŒ…æ‹¬å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­ç­‰æ§åˆ¶è¯­å¥**ï¼Œå¦‚æœéœ€è¦æ¡ä»¶åˆ¤æ–­ï¼Œå¯ä»¥ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ä»£æ›¿ã€‚

**å‡½æ•°å¼ç¼–ç¨‹æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š**

- **å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘**ï¼šå‡½æ•°å¯ä»¥å’Œå˜é‡ä¸€æ ·ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºåˆ«çš„å‡½æ•°è¿”å›å€¼ã€‚

- **åªç”¨è¡¨è¾¾å¼ï¼Œä¸ç”¨è¯­å¥**ï¼šè¡¨è¾¾å¼æ˜¯ä¸€æ®µå•çº¯çš„è¿ç®—è¿‡ç¨‹ï¼Œæ€»æ˜¯æœ‰è¿”å›å€¼ã€‚è¯­å¥æ˜¯æ‰§è¡ŒæŸç§æ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚**å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„æ¯ä¸€æ­¥éƒ½æ˜¯å•çº¯çš„è¿ç®—**ï¼Œè€Œä¸”éƒ½æœ‰è¿”å›å€¼ã€‚

- **æ— å‰¯ä½œç”¨**ï¼šä¸ä¼šäº§ç”Ÿé™¤è¿ç®—ä»¥å¤–çš„å…¶ä»–ç»“æœã€‚åŒä¸€ä¸ªè¾“å…¥æ°¸è¿œå¾—åˆ°åŒä¸€ä¸ªè¾“å‡ºã€‚

- **ä¸å¯å˜æ€§**ï¼šä¸ä¿®æ”¹å˜é‡ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å€¼ã€‚

- **å¼•ç”¨é€æ˜**ï¼šå‡½æ•°çš„è¿è¡Œä¸ä¾èµ–äºå¤–éƒ¨å˜é‡ï¼Œåªä¾èµ–äºè¾“å…¥çš„å‚æ•°ã€‚

## å‡½æ•°å¼ç¼–ç¨‹æœ¯è¯­

> ç¬”è®°æ¥æº [functional-programing-jargon](https://github.com/hemanth/functional-programming-jargon)

### é«˜é˜¶å‡½æ•° (Higher Order Function)

ä»¥å‡½æ•°ä¸ºå‚æ•°æˆ–è¿”å›å€¼ã€‚

```js
const filter = (predicate, xs) => xs.filter(predicate)
const is = type => x => Object(x) instanceof type

filter(is(Number), [0, '1', 2, null]) // 0, 2
```

### åå‡½æ•° (Partial Function)

"éƒ¨åˆ†åœ°"åº”ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå³é¢„è®¾åŸå§‹å‡½æ•°çš„éƒ¨åˆ†å‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚

**ä½¿ç”¨ `Function.prototype.bind` å®ç°åå‡½æ•°ï¼š**

```js
const add = (a, b, c) => a + b + c // (c) => 2 + 3 + c
const addMore = add.bind(null, 1, 2)

console.log(addMore(3)) // 6
```

**æ‰‹å†™ partial å‡½æ•°ï¼š**

```js
const add = (a, b, c) => a + b + c

const partial =
  (f, ...args) =>
  (...rest) =>
    f(...args, ...rest)

const addMore = partial(add, 1, 2)

console.log(addMore(3)) // 6
```

### æŸ¯é‡ŒåŒ– (Currying)

å°†ä¸€ä¸ªå¤šå…ƒå‡½æ•°è½¬å˜ä¸ºä¸€å…ƒå‡½æ•°çš„è¿‡ç¨‹ã€‚æ¯å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä»…ä»…æ¥æ”¶ä¸€ä¸ªå‚æ•°å¹¶ä¸”è¿”å›å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œç›´åˆ°ä¼ é€’å®Œæ‰€æœ‰çš„å‚æ•°ã€‚

```js
const sum = (a, b) => a + b
const curriedSum = a => b => a + b
curriedSum(3)(4) // 7

const add2 = curriedSum(2)
add2(10) // 12
```

**ä½¿ç”¨ `Function.prototype.bind` å®ç° curry å‡½æ•°ï¼š**

```js
const curry = f => {
  return (...args) => {
    // curriedF æ¯æ¬¡è°ƒç”¨éƒ½ä¼šä½¿ f.length - args.length
    // æœ€å f.length === 0
    if (args.length < f.length) {
      return curry(f.bind(null, ...args))
    } else {
      return f(...args)
    }
  }
}
```

**æ‰‹å†™ curry å‡½æ•°ï¼š**

```js
const curry = f => {
  // curriedF æ¯æ¬¡è°ƒç”¨éƒ½ä¼šæ”¶é›†å½“å‰ä¼ é€’çš„å‚æ•°ï¼Œåˆ©ç”¨ accArgs é—­åŒ…æ”¶é›†å‚æ•°ï¼Œæ”¶é›†é½äº†å°±è°ƒç”¨åŸå‡½æ•°
  const R = (...accArgs) =>
    accArgs.length >= f.length ? f(...accArgs) : (...restArgs) => R(...restArgs, ...accArgs)
  return R
}
```

> [ç¤ºä¾‹](../fp/curry.js)

### å‡½æ•°ç»„åˆ (Function Composing)

æ¥æ”¶å¤šä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œä»å³åˆ°å·¦ï¼Œä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºã€‚

```js
const compose = (f, g) => a => f(g(a)) // å®šä¹‰
const floorAndToString = compose(val => val.toString(), Math.floor) // ä½¿ç”¨
floorAndToString(12.12) // '12'
```

**æ‰‹å†™ compose å‡½æ•°ï¼š**

```js
const compose =
  fns =>
  (...args) =>
    fns.reduceRight((acc, f) =>
      // reduceRight ç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ ï¼Œç¬¬ä¸€æ¬¡ acc ä¸ºæ•°ç»„ fns æœ€åä¸€é¡¹ï¼Œç¬¬äºŒæ¬¡ä»¥åå°±ä¸ºå‡½æ•°è¿”å›å€¼å‚æ•°ï¼Œç›´åˆ°å¾ªç¯ç»“æŸã€‚
      typeof acc === 'function' ? f(acc(...args)) : f(acc)
    )
```

> [ç¤ºä¾‹](../fp/compose.js)

### å‰¯ä½œç”¨ (Side effects)

å¦‚æœä¸€ä¸ªå‡½æ•°æˆ–è€…è¡¨è¾¾å¼é™¤äº†è¿”å›ä¸€ä¸ªå€¼ä¹‹å¤–ï¼Œè¿˜ä¸å¤–éƒ¨å¯å˜çŠ¶æ€è¿›è¡Œäº†äº¤äº’ï¼ˆè¯»å–æˆ–å†™å…¥ï¼‰ï¼Œåˆ™å®ƒæ˜¯æœ‰å‰¯ä½œç”¨çš„ã€‚

```js
console.log('IO is a side effect!')
```

### å¹‚ç­‰æ€§ (Idempotent)

å¦‚æœä¸€ä¸ªå‡½æ•°æ‰§è¡Œå¤šæ¬¡çš†è¿”å›ç›¸åŒçš„ç»“æœï¼Œåˆ™å®ƒæ˜¯å¹‚ç­‰æ€§çš„ã€‚

```js
f(f(x)) â‰ f(x)
```

### çº¯å‡½æ•° (Purity)

è¾“å‡ºä»…ç”±è¾“å…¥å†³å®šï¼Œä¸”ä¸äº§ç”Ÿå‰¯ä½œç”¨ã€‚

```js
const greet = name => `hello, ${name}`
greet('world')
```

**ä»¥ä¸‹ä»£ç ä¸æ˜¯çº¯å‡½æ•°ï¼š**

```js
window.name = 'Brianna'

const greet = () => `Hi, ${window.name}`
greet() // "Hi, Brianna"
```

ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œå‡½æ•°ä¾èµ–å¤–éƒ¨çŠ¶æ€ã€‚

```js
let greeting

const greet = name => {
  greeting = `Hi, ${name}`
}

greet('Brianna')

console.log(greeting)  // "Hi, Brianna"
```

ä»¥ä¸Šå®ä¾‹ä¸­ï¼Œå‡½æ•°ä¿®æ”¹äº†å¤–éƒ¨çŠ¶æ€ã€‚


### å€¼ (Value)

ä»»ä½•å¯ä»¥èµ‹ç»™å˜é‡çš„ä¸œè¥¿å«åšå€¼ã€‚

```js
5
Object.freeze({name: 'John', age: 30})
;(a) => a
;[1]
undefined
```

### å¸¸é‡ (Constant)

ä¸€æ—¦è¢«å®šä¹‰ä¹‹åå°±ä¸å¯ä»¥è¢«é‡æ–°èµ‹å€¼ã€‚

**å¸¸é‡æ˜¯å¼•ç”¨é€æ˜çš„**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬å¯ä»¥è¢«å®ƒä»¬æ‰€ä»£è¡¨çš„å€¼æ›¿ä»£è€Œä¸å½±å“ç»“æœã€‚

```js
const five = 5
const john = Object.freeze({name: 'John', age: 30})

// å¯¹äºä»¥ä¸Šä¸¤ä¸ªå¸¸é‡ï¼Œä»¥ä¸‹è¯­å¥æ€»ä¼šè¿”å› trueã€‚
john.age + five === ({name: 'John', age: 30}).age + (5)
```

### å¼•ç”¨é€æ˜æ€§ (Referential Transparency)

ä¸€ä¸ªè¡¨è¾¾å¼èƒ½å¤Ÿè¢«å®ƒçš„å€¼æ›¿ä»£è€Œä¸æ”¹å˜ç¨‹åºçš„è¡Œä¸ºæˆä¸ºå¼•ç”¨é€æ˜ã€‚

```js
const greet = () => 'hello, worldï¼'
```

ä»»ä½•å¯¹ `greet()` çš„è°ƒç”¨éƒ½å¯ä»¥æ›¿æ¢ä¸º `Hello Worldï¼` å› æ­¤ï¼Œ`greet` æ˜¯å¼•ç”¨é€æ˜çš„ã€‚

### Lambda

ä¸€ç§å¯ä»¥è¢«è§†ä½œä¸€ä¸ªå€¼çš„åŒ¿åå‡½æ•°ã€‚

```js
;(function (a) {
    return a + 1
})

;(a) => a + 1
```

Lambda é€šå¸¸ä½œä¸ºå‚æ•°è¢«ä¼ é€’ç»™é«˜é˜¶å‡½æ•°ã€‚

```js
[1, 2].map((a) => a + 1)
```

å¯ä»¥æŠŠ Lambda èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚

```js
const add1 = (a) => a + 1
```

### è°“è¯ (æ–­å®š Predicate)

æ ¹æ®è¾“å…¥è¿”å› `true` æˆ– `false`ã€‚é€šå¸¸ç”¨åœ¨ `Array.prototype.filter` çš„å›è°ƒå‡½æ•°ä¸­ã€‚

```js
const predicate = a => a > 2

;[1, 2, 3, 4].filter(predicate)
```

### Point-Free é£æ ¼ (Point-Free Style)

å®šä¹‰å‡½æ•°æ—¶ï¼Œä¸æ˜¾å¼åœ°æŒ‡å‡ºå‡½æ•°æ‰€å¸¦å‚æ•°ã€‚è¿™ç§é£æ ¼é€šå¸¸éœ€è¦æŸ¯é‡ŒåŒ–æˆ–è€…é«˜é˜¶å‡½æ•°ã€‚ä¹Ÿå« `Tacit programming`ã€‚

```js
const _map = fn => list => list.map(fn)
const add = a => b => a + b

// Points-Free   list æ˜¯æ˜¾å¼å‚æ•°
const incrementAll = numbers => _map(add(1))(numbers)

// Points-Free   list æ˜¯éšå¼å‚æ•°
const incrementAll2 = _map(add(1))

console.log(incrementAll([1, 2, 3])) // [2, 3, 4]
console.log(incrementAll2([1, 2, 3])) // [2, 3, 4]
```

`incrementAll` è¯†åˆ«å¹¶ä¸”ä½¿ç”¨äº† `numbers` å‚æ•°ï¼Œå› æ­¤å®ƒä¸æ˜¯ `Point-Free` é£æ ¼çš„ã€‚ `incrementAll2` è¿æ¥å‡½æ•°ä¸å€¼ï¼Œå¹¶ä¸æåŠå®ƒæ‰€ä½¿ç”¨çš„å‚æ•°ï¼Œå› ä¸ºå®ƒæ˜¯ `Point-Free` é£æ ¼çš„ã€‚

`Point-Free` é£æ ¼çš„å‡½æ•°å°±åƒå¹³å¸¸çš„èµ‹å€¼ï¼Œä¸ä½¿ç”¨ `function` æˆ–è€… `=>`ã€‚

### å‡½å­ (Functor)

ä¸€ä¸ªå®ç°äº† `map` å‡½æ•°çš„å¯¹è±¡ï¼Œ`map` ä¼šéå†å¯¹è±¡ä¸­çš„æ¯ä¸ªå€¼å¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚éµå®ˆä¸¤ä¸ªå‡†åˆ™

#### ä¸€è‡´æ€§ (Preserves identity)

```js
object.map(x => x) â‰ object
```

#### ç»„åˆæ€§ (Composable)

```js
object.map(compose(f, g)) â‰ object.map(g).map(f)  // f, g ä¸ºä»»æ„å‡½æ•°
```

åœ¨ `javascript` ä¸­ä¸€ä¸ªå¸¸è§çš„å‡½å­æ˜¯ `Array`, å› ä¸ºå®ƒéµå®ˆå› å­çš„ä¸¤ä¸ªå‡†åˆ™ã€‚

```js
const f = x => x + 1
const g = x => x * 2

;[1, 2, 3].map(x => f(g(x)))
;[1, 2, 3].map(g).map(f)
```

### æŒ‡å‘å‡½å­ (Pointed Functor)

ä¸€ä¸ªå®ç°äº† `of` å‡½æ•°çš„å¯¹è±¡ï¼Œå¯ä»¥å°†ä¸€ä¸ªä»»ä½•å€¼æ”¾å…¥å®ƒè‡ªèº«ã€‚

`ES2015` æ·»åŠ äº† `Array.of`ï¼Œä½¿ `Array` æˆä¸ºäº† `Pointed Functor`

```js
Array.of(1)
```

### æƒ°æ€§æ±‚å€¼ (Lazy evaluation)

æƒ°æ€§æ±‚å€¼æ˜¯ä¸€ç§æŒ‰éœ€è°ƒç”¨çš„æ±‚å€¼æœºåˆ¶ï¼Œå®ƒå°†è¡¨è¾¾å¼çš„æ±‚å€¼å»¶è¿Ÿåˆ°éœ€è¦å®ƒçš„å€¼ä¸ºæ­¢ï¼Œåœ¨å‡½æ•°å¼è¯­è¨€ä¸­ï¼Œå…è®¸ç±»ä¼¼æ— é™åˆ—è¡¨è¿™æ ·çš„ç»“æ„å­˜åœ¨ï¼Œè€Œè¿™åœ¨éå¸¸é‡è§†å‘½ä»¤é¡ºåºçš„å‘½ä»¤å¼è¯­è¨€ä¸­é€šå¸¸æ˜¯ä¸å¯ç”¨çš„ã€‚

```js
const rand = function* () {
  while (true) {
    yield Math.random()
  }
}

const randIter = rand()
randIter.next() // æ¯æ¬¡æ‰§è¡Œäº§ç”Ÿä¸€ä¸ªéšæœºå€¼ï¼Œè¡¨è¾¾å¼ä¼šåœ¨éœ€è¦æ—¶æ±‚å€¼ã€‚
```

### å¹ºåŠç¾¤ (Monoid)

> ä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªå‡½æ•°ç”¨æ¥è¿æ¥ç›¸åŒç±»å‹çš„å¯¹è±¡ã€‚

æ•°å€¼åŠ æ³•æ˜¯ä¸€ä¸ªç®€å•çš„ `Monoid`

```js
1 + 1 // 2
```

ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œæ•°å€¼æ˜¯å¯¹è±¡è€Œ `+` æ˜¯å‡½æ•°ã€‚

**ä¸å¦ä¸€ä¸ªå€¼ç»“åˆè€Œä¸ä¼šæ”¹å˜å®ƒçš„å€¼å¿…é¡»å­˜åœ¨**ï¼Œç§°ä¸º `identity`ã€‚

åŠ æ³•çš„ `identity` å€¼ä¸º `0`:

```js
1 + 0 // 1
```

éœ€è¦æ»¡è¶³ç»“åˆå¾‹

```js
1 + (2 + 3) === 1 + 2 + 3 // true
```

æ•°ç»„çš„ç»“åˆä¹Ÿæ˜¯ `Monoid`

```js
;[1, 2].concat([3, 4])
```

`identity` å€¼ä¸ºç©ºæ•°ç»„

```js
;[1, 2].concat([])
```

`identity` ä¸ `compose` å‡½æ•°èƒ½å¤Ÿç»„æˆ `monoid`

```js
const identity = a => a
const compose = (f, g) => x => f(g(x))
```

`foo` æ˜¯åªå¸¦ä¸€ä¸ªå‚æ•°çš„ä»»æ„å‡½æ•°

```js
compose(foo, identity) â‰ compose(identity, foo) â‰ foo
```

### Monad

æ‹¥æœ‰ `of` å’Œ `chain` å‡½æ•°çš„å¯¹è±¡ã€‚`chain` å¾ˆåƒ `map`ï¼Œ é™¤äº†ç”¨æ¥é“ºå¹³åµŒå¥—æ•°æ®ã€‚

```js
Array.prototype.chain = function (f) {
  return this.reduce((acc, it) => acc.concat(f(it)), [])
}

// ['cat', 'dog', 'fish', 'bird']
Array.of('cat,dog', 'fish,bird').chain(s => s.split(','))

// [['cat', 'dog'], ['fish', 'bird']]
Array.of('cat,dog', 'fish,bird').map(s => s.split(','))
```

åœ¨æœ‰äº›è¯­è¨€ä¸­ï¼Œ`of` ä¹Ÿç§°ä¸º `return`ï¼Œ`chain` ä¹Ÿç§°ä¸º `flatmap` ä¸ `bind`ã€‚

### åŠç¾¤ (Semigroup)

ä¸€ä¸ªæ‹¥æœ‰ `concat` å‡½æ•°çš„å¯¹è±¡ã€‚`concat` å¯ä»¥è¿æ¥ç›¸åŒç±»å‹çš„ä¸¤ä¸ªå¯¹è±¡ã€‚

```js
;[1].concat([2]) // [1, 2]
```

### Foldable

ä¸€ä¸ªæ‹¥æœ‰ `reduce` å‡½æ•°çš„å¯¹è±¡ã€‚`reduce` å¯ä»¥æŠŠä¸€ç§ç±»å‹çš„å¯¹è±¡è½¬åŒ–ä¸ºå¦ä¸€ç§ç±»å‹ã€‚

```js
const sum = list => list.reduce((acc, val) => acc + val, 0)
sum([1, 2, 3]) // 6
```

### Setoid

æ‹¥æœ‰ `equals` å‡½æ•°çš„å¯¹è±¡ã€‚`equals` å¯ä»¥ç”¨æ¥å’Œå…¶å®ƒå¯¹è±¡æ¯”è¾ƒã€‚

```js
Array.prototype.equals = function (arr) {
  const len = this.length
  if (len !== arr.length) {
    return false
  }
  for (let i = 0; i < len; i++) {
    if (this[i] !== arr[i]) {
      return false
    }
  }
  return true
}
;[1, 2].equals([1, 2]) // true
;[1, 2].equals([3, 4]) // false
```

### æ€å°„ (Morphism)

ä¸€ä¸ªå˜å½¢çš„å‡½æ•°ã€‚

#### è‡ªåŒæ€ (Endomorphism)

è¾“å…¥è¾“å‡ºæ˜¯ç›¸åŒç±»å‹çš„å‡½æ•°ã€‚

```js
// uppercase :: String -> String
const uppercase = str => str.toUpperCase()

// decrement :: Number -> Number
const decrement = x => x - 1
```

#### åŒæ„ (Isomorphism)

ä¸ç”¨ç±»å‹å¯¹è±¡çš„å˜å½¢ï¼Œä¿æŒç»“æ„å¹¶ä¸”ä¸ä¸¢å¤±æ•°æ®ã€‚

ä¾‹å¦‚ï¼Œä¸€ä¸ªäºŒç»´åæ ‡æ—¢å¯ä»¥è¡¨ç¤ºä¸ºæ•°ç»„ `[2, 3]`ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºå¯¹è±¡ `{x: 2, y: 3}`ã€‚

```js
// æä¾›å‡½æ•°åœ¨ä¸¤ç§ç±»å‹é—´äº’ç›¸è½¬æ¢
const pairToCoords = pair => ({ x: pair[0], y: pair[1] })

const coordsToPair = coords => [coords.x, coords.y]

coordsToPair(pairToCoords([1, 2])) // [1, 2]

pairToCoords(coordsToPair({ x: 1, y: 2 })) // {x: 1, y: 2}
```

## ç»è¿‡ curry çš„ç±»å‹è¡¨è¾¾å¼

```js
map: Functor f => (a -> b) -> f a -> f b
// a ç±»å‹ æ˜ å°„ b ç±»å‹ f æ˜¯æ•°æ®ç»“æ„ Array ï¼ˆa -> bï¼‰å‡½å­çš„ map å‡½æ•°
// Array<number> -> Array<string>
// [1, 2, 3].map(...).map(...).map(...)
// Promise.then(...).then(...).then(...)
// Monad
```

æ€è€ƒï¼š `Functor` æ˜¯ä»€ä¹ˆï¼Ÿ

1. `Functor` æ˜¯ `Array<T>`
2. `Functor` å‡½å­ï¼šèŒƒç•´é—´çš„åŒæ€ï¼ˆè¯´äººè¯ï¼šå¸¦æ³›å‹çš„ç±»å‹ `Array<T>`, `Promise<T>` ï¼‰

### èŒƒç•´ (Category)

åœ¨èŒƒç•´è®ºä¸­ï¼ŒèŒƒç•´æ˜¯æŒ‡å¯¹è±¡é›†åˆåŠå®ƒä»¬ä¹‹é—´çš„æ€å°„ (morphism)ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œæ•°æ®ç±»å‹ä½œä¸ºå¯¹è±¡ï¼Œå‡½æ•°ä½œä¸ºæ€å°„ã€‚

ä¸€ä¸ªæœ‰æ•ˆçš„èŒƒç•´éµä»ä»¥ä¸‹ä¸‰ä¸ªåŸåˆ™ï¼š

1. å¿…æœ‰ä¸€ä¸ª `identity` æ€å°„ï¼Œä½¿å¾— `map` ä¸€ä¸ªå¯¹è±¡æ˜¯å®ƒè‡ªèº«ã€‚`a` æ˜¯èŒƒç•´é‡Œçš„ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¿…æœ‰ä¸€ä¸ªå‡½æ•°ä½¿ `a -> a`ã€‚
2. æ€å°„å¿…æ˜¯å¯ç»„åˆçš„ã€‚`aï¼Œbï¼Œc` æ˜¯èŒƒç•´é‡Œçš„å¯¹è±¡ï¼Œ`f` æ˜¯æ€å°„ `a -> b`ï¼Œ`g` æ˜¯ `b -> c` æ€å°„ã€‚`g(f(x))` ä¸€å®šä¸ `(g â— f)(x)` æ˜¯ç­‰ä»·çš„ã€‚
3. ç»„åˆæ»¡è¶³ç»“åˆå¾‹ã€‚`f â— (g â— h)` ä¸ `(f â— g) â— h` æ˜¯ç­‰ä»·çš„ã€‚

è¿™äº›å‡†åˆ™æ˜¯éå¸¸æŠ½è±¡çš„ï¼ŒèŒƒç•´è®ºå¯¹ä¸å‘ç°ç»„åˆçš„æ–°æ–¹æ³•æ˜¯ä¼Ÿå¤§çš„ã€‚


### å¥‘çº¦ (Contracts)

å¥‘çº¦è§„å®šäº†å‡½æ•°æˆ–è¡¨è¾¾å¼åœ¨è¿è¡Œæ—¶çš„è¡Œä¸ºçš„èŒè´£å’Œä¿éšœã€‚å®ƒè¡¨ç°ä¸ºä¸€ç»„è§„åˆ™ï¼Œè¿™äº›è§„åˆ™æ˜¯å¯¹å‡½æ•°æˆ–è¡¨è¾¾å¼çš„è¾“å…¥å’Œè¾“å‡ºçš„æœŸæœ›ã€‚å½“è¿åå¥‘çº¦æ—¶ï¼Œå°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

```js
// typescript
// å®šä¹‰çš„ contract: int -> boolean
const contract = (input) => {
  if (typeof input === 'number') return true
  throw new Error('Contract Violated: expected int -> int')
}

const addOne = (num) => contract(num) && num + 1

addOne(2) // 3
addOne('hello') // è¿åäº†contract: int -> boolean
```
