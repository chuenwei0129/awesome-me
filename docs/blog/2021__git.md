---
group:
  title: 2021 ğŸ®
  order: -2021
title: Git å¤‡å¿˜å½•
toc: content
---

# æ€•é—å¿˜ git çš„æˆ‘ï¼ŒæŠŠç›¸å…³çŸ¥è¯†ç‚¹éƒ½è®°å½•ä¸‹æ¥å°±å¯¹äº†

## ä½¿ç”¨ SSH æäº¤ä»£ç 

### å‡†å¤‡å·¥ä½œ

**è¿œç¨‹ä»“åº“**ä¸€èˆ¬æ”¯æŒä¸¤ç§åè®®ï¼šSSH å’Œ HTTPSï¼Œ**SSH åè®®åªè®¤æœºå™¨ï¼ŒHTTPS åè®®åªè®¤è´¦å·**ï¼›ä¹Ÿå³ä¸ºï¼šå¦‚æœä½¿ç”¨ SSH æ“ä½œè¿œç¨‹ä»“åº“çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å…¬é’¥å’Œç§é’¥å¯¹æ¥åšæƒé™çš„è®¤è¯ï¼Œå¦‚æœä½¿ç”¨ HTTPS æ“ä½œè¿œç¨‹ä»“åº“ï¼Œåˆ™éœ€è¦ä½¿ç”¨è´¦å·å¯†ç æ¥åšæƒé™çš„è®¤è¯ã€‚

æ— è®ºæ˜¯å…¬é’¥ç§é’¥å¯¹ï¼Œè¿˜æ˜¯è´¦å·å¯†ç ï¼Œéƒ½åªåšæƒé™çš„è®¤è¯ï¼›ä½†æ˜¯**è¿œç¨‹ä»“åº“é‡Œéœ€è¦è®°å½•è¿™äº›æäº¤è®°å½•æ˜¯ç”±è°æ¥å®Œæˆçš„**ï¼›æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™æœ¬åœ°çš„ Git è®¾ç½®ç”¨æˆ·åå’Œé‚®ç®±ï¼Œç”¨äºä»æœ¬åœ°ä»“åº“å‘è¿œç¨‹ä»“åº“æäº¤è®°å½•æ—¶ï¼Œåœ¨è¿œç¨‹ä»“åº“è®°å½•ä¸‹è¿™äº›æ“ä½œæ˜¯ç”±è°æ¥å®Œæˆçš„ã€‚

### æ“ä½œ

#### 1. ç”Ÿæˆä¸€ä¸ª ssh-key

**æ‰§è¡Œå‘½ä»¤ï¼š**

```perl
ssh-keygen -t rsa -C "chuenwei0129@gmail.com"
```

- `-t`: å¯é€‰æ‹© dsa | ecdsa | ed25519 | rsa | rsa1ï¼Œä»£è¡¨åŠ å¯†æ–¹å¼
- `-C`: æ³¨é‡Šï¼Œä¸€èˆ¬å†™è‡ªå·±çš„é‚®ç®±

å¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œåˆ‡æ¢åˆ° `~/.ssh` ç›®å½•ä¸‹ï¼Œæ­¤æ—¶ç›®å½•åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºã€‚

```perl
.ssh
â”œâ”€â”€ id_rsa
â””â”€â”€ id_rsa.pub
```

> id_rsa / id_rsa.pub é…å¯¹çš„ç§é’¥ä¸å…¬é’¥

#### 2. å¤åˆ¶ `id_rsa.pub` çš„å†…å®¹

ä»¥ Github ä¸ºä¾‹ï¼Œè¿›å…¥ `settings -> SSH and GPG keys` é€šè¿‡ `cat` å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ `id_rsa.pub` çš„å†…å®¹ï¼Œç„¶åå¤åˆ¶è¿‡æ¥ï¼Œç‚¹å‡» `add ssh key`ï¼Œè¿™ä¸€æ­¥ç­‰äºè¯´æŠŠä½ çš„å…¬é’¥æ”¾åˆ°äº† Github ä¸Šè¿›è¡Œæ‰˜ç®¡ã€‚

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/-k3u1fbpfcp.webp)

#### 3. å…¨å±€é…ç½® Git çš„ç”¨æˆ·åå’Œé‚®ç®±

å› ä¸º Git æ˜¯åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªæœºå™¨éƒ½å¿…é¡»è‡ªæŠ¥å®¶é—¨ï¼šä½ çš„åå­—å’Œ email åœ°å€ï¼ˆåå­—å’Œé‚®ç®±éƒ½ä¸ä¼šè¿›è¡ŒéªŒè¯ï¼‰ï¼Œè¿™æ ·è¿œç¨‹ä»“åº“æ‰çŸ¥é“å“ªæ¬¡æäº¤æ˜¯ç”±è°å®Œæˆçš„ã€‚

```perl
git config --global user.name "chuenwei0129"
git config --global user.email "chuenwei0129@gmail.com"
```

**é…ç½®çš„ç”¨æˆ·åå’Œé‚®ç®±å¯¹ push ä»£ç åˆ°è¿œç¨‹ä»“åº“æ—¶çš„èº«ä»½éªŒè¯æ²¡æœ‰ä½œç”¨ï¼Œå³ä¸ç”¨ä»–ä»¬è¿›è¡Œèº«ä»½éªŒè¯**ï¼›ä»–ä»¬ä»…ä»…ä¼šå‡ºç°åœ¨è¿œç¨‹ä»“åº“çš„ commits é‡Œã€‚

#### 4. æŸ¥çœ‹æ˜¯å¦æˆåŠŸé…ç½®äº† SSH

å®Œæˆä»¥ä¸Šæ­¥éª¤ï¼Œå°±å¯ä»¥æ„‰å¿«ä½¿ç”¨ SSH æäº¤ä»£ç äº†ã€‚

```perl
# -v è¯¦ç»†å±•ç¤ºé“¾æ¥è¿‡ç¨‹
ssh -T git@github.com
# Hi chuenwei0129! You've successfully authenticated, but GitHub does not provide shell access.
```

### è¸©å‘

#### Github ä»“åº“ä¸­çš„ commit ä¸æ˜¾ç¤ºè‡ªå·±çš„å¤´åƒ

Github å®˜æ–¹ç»™å‡ºäº†ä¸€ä¸ª[å®˜æ–¹æ–‡ä»¶](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/managing-contribution-settings-on-your-profile/why-are-my-contributions-not-showing-up-on-my-profile)ï¼Œå‘Šè¯‰æˆ‘ä»¬ commit è¢«è®°å…¥ contribution ä¸­å¿…é¡»æ»¡è¶³ç”¨äº commit çš„é‚®ä»¶åœ°å€å¿…é¡»ä¸ Github è´¦æˆ·ç›¸å…³è”ï¼Œ**æœ¬åœ°é…ç½®çš„ç”¨æˆ·åå’Œé‚®ç®±åœ°å€åªæœ‰ä¸åˆ›å»º Github æ—¶çš„é‚®ç®±å’Œåœ°å€ç›¸åŒæ—¶**ï¼Œæ¯æ¬¡å¾€ Github ä¸Š commit æ—¶ï¼ŒGithub æ‰ä¼šè¯†åˆ«å‡º commit çš„æ˜¯ä½ æœ¬äººï¼Œæ­¤æ—¶è¿™æ¬¡ commit æ‰ä¼šè¢«è®°å…¥ contributionã€‚

#### ä»£ç†

```perl
# è¿™ä¸ªæç¤ºæ˜¯ä¸»è¦æç¤ºæ˜¯ä¸å…è®¸ä½ ä»£ç†è¿™ä¸ª ip ç™»å½• ssh
kex_exchange_identification: Connection closed by remote host
Connection closed by 127.0.0.1 port 7890
```

è§£å†³æ–¹æ¡ˆå°±æ˜¯ç”¨ Github çš„ 443 ç«¯å£ <https://docs.github.com/en/authentication/troubleshooting-ssh/using-ssh-over-the-https-port> æˆ–è€…æŠŠä»£ç†å…³äº†ã€‚

æ›´å¤šè®¨è®ºï¼š[sshè¿œç¨‹ç™»é™†æœ‰æ—¶å€™æ­£å¸¸ï¼Œæœ‰æ—¶å€™æ˜¾ç¤ºï¼šssh_exchange_identification: Connection closed by remote hostï¼Œè¿™æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ](https://www.zhihu.com/question/20023544)

#### [å‡çº§ Ventura å git ssh ä¼¼ä¹å‡ºäº†é—®é¢˜](https://www.v2ex.com/t/890332#reply17)

**åŸå› **ï¼šè‹¹æœç³»ç»Ÿå‡çº§åé»˜è®¤ç¦ç”¨äº†**ç”¨ SHA-1 çš„å“ˆå¸Œç®—æ³•çš„ RSA ç­¾å**ï¼Œå› ä¸ºè‹¹æœè®¤ä¸ºå…¶ä¸å®‰å…¨ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** åœ¨ `~/.ssh/config` æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹

```perl
HostKeyAlgorithms +ssh-rsa
PubkeyAcceptedKeyTypes +ssh-rsa
```

å¦å¤–ï¼šå»ºè®®ç›´æ¥æ¢ ed25519 ç®—æ³•ï¼Œå› ä¸ºå®ƒæ›´å®‰å…¨ã€‚

> [ä½¿ç”¨ Ed25519 ç®—æ³•ç”Ÿæˆä½ çš„ SSH å¯†é’¥](https://zhuanlan.zhihu.com/p/110413836)

## Git å·¥ä½œåŸç†

### Git çš„ä¸‰ç§çŠ¶æ€

è¿™ä¸‰ç§çŠ¶æ€åˆ†åˆ«æ˜¯ï¼š

- å·¥ä½œåŒºï¼ˆWorking Directoryï¼‰
- æš‚å­˜åŒºï¼ˆStaging Indexï¼‰
- æäº¤å†å²ï¼ˆCommit Historyï¼‰

#### å·¥ä½œåŒº

å·¥ä½œåŒºï¼Œå°±æ˜¯å¹³æ—¶è¿›è¡Œå¼€å‘æ”¹åŠ¨çš„åœ°æ–¹ï¼Œæ˜¯å½“å‰çœ‹åˆ°æœ€æ–°çš„å†…å®¹ï¼Œåœ¨å¼€å‘çš„è¿‡ç¨‹ä¹Ÿå°±æ˜¯å¯¹å·¥ä½œåŒºçš„æ“ä½œã€‚

> æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå½“æˆä¸€ä¸ªæ²™ç›’ï¼Œåœ¨å…¶ä¸­éšæ„åœ°æ·»åŠ æˆ–ç¼–è¾‘æ–‡ä»¶ï¼Œç„¶åå†å°†ä¿®æ”¹åçš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºå¹¶è®°å½•åˆ°æäº¤å†å²ä¸­ã€‚
>
> Git å¯ä»¥æŠŠå·¥ä½œåŒºä¸­çš„æ–‡ä»¶å¤„ç†ã€å‹ç¼©æˆä¸€ä¸ªæäº¤å¯¹è±¡ï¼Œä¹Ÿèƒ½å°†å–å¾—çš„æäº¤å¯¹è±¡è§£åŒ…æˆæ–‡ä»¶åŒæ­¥åˆ°å·¥ä½œåŒºä¸­ã€‚

#### æš‚å­˜åŒº

> [ä¸ºä»€ä¹ˆè¦å…ˆ git add æ‰èƒ½ git commitï¼Ÿ](https://www.zhihu.com/question/19946553)

æš‚å­˜åŒºï¼ˆStageï¼‰ï¼Œå½“æ‰§è¡Œ `git add` çš„å‘½ä»¤åï¼Œå·¥ä½œåŒºçš„æ–‡ä»¶å°±ä¼šè¢«ç§»å…¥æš‚å­˜åŒºï¼Œ**æš‚å­˜åŒºæ ‡è®°äº†å½“å‰å·¥ä½œåŒºä¸­é‚£äº›å†…å®¹æ˜¯è¢« Git ç®¡ç†çš„**ï¼Œå½“å®ŒæˆæŸä¸ªéœ€æ±‚æˆ–è€…åŠŸèƒ½åéœ€è¦æäº¤ä»£ç ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯é€šè¿‡ `git add` å…ˆæäº¤åˆ°æš‚å­˜åŒºã€‚

  1. Git æŠŠå®ƒä½œä¸ºå·¥ä½œåŒºä¸æäº¤å†å²ä¹‹é—´çš„ä¸­é—´åŒºåŸŸï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹æäº¤å†…å®¹è¿›è¡Œç»„ç»‡ï¼š
     1. æˆ‘ä»¬å¯èƒ½ä¼šåœ¨å·¥ä½œåŒºåŒæ—¶æ›´æ”¹å¤šä¸ªå®Œå…¨ä¸ç›¸å¹²çš„æ–‡ä»¶ï¼Œè¿™æ—¶å¯ä»¥å°†å®ƒä»¬åˆ†åˆ«æ”¾å…¥æš‚å­˜åŒºï¼Œå¹¶åœ¨ä¸åŒçš„æäº¤ä¸­åŠ å…¥æäº¤å†å²ã€‚

     2. æ­¤å¤–æš‚å­˜åŒºè¿˜ç”¨äºåˆå¹¶å†²çªæ—¶å­˜æ”¾æ–‡ä»¶çš„ä¸åŒç‰ˆæœ¬ã€‚

  2. **é™¤éæ˜¯ä¸€ä¸ªåˆšåˆšåˆå§‹åŒ–çš„ Git ä»“åº“ï¼Œå¦åˆ™æš‚å­˜åŒºå¹¶ä¸æ˜¯ç©ºçš„**ï¼Œå®ƒä¼šå¡«å……æœ€è¿‘ä¸€æ¬¡æäº¤æ‰€å¯¹åº”çš„æ–‡ä»¶å¿«ç…§ï¼Œå› æ­¤å½“æˆ‘ä»¬åŸºäºæœ€è¿‘ä¸€æ¬¡æäº¤åœ¨å·¥ä½œåŒºåšäº†ä¸€äº›ä¿®æ”¹ä¹‹åï¼Œ`git status` ä¼šå°†å·¥ä½œåŒºçš„æ–‡ä»¶ä¸æš‚å­˜åŒºçš„æ–‡ä»¶å¿«ç…§è¿›è¡Œå¯¹æ¯”ï¼Œå¹¶æç¤ºæˆ‘ä»¬æœ‰å“ªäº›åšäº†ä¿®æ”¹çš„æ–‡ä»¶å°šæœªåŠ å…¥æš‚å­˜åŒºã€‚

  3. æš‚å­˜åŒºå¹¶ä¸åƒå·¥ä½œåŒºæœ‰å¯è§çš„æ–‡ä»¶ç³»ç»Ÿç›®å½•ï¼Œæˆ–è€…åƒæäº¤å†å²ä¸€æ ·é€šè¿‡ .git/objects ç›®å½•ä¿å­˜ç€æ‰€æœ‰æäº¤å¯¹è±¡ï¼Œå®ƒæ²¡æœ‰å®é™…å­˜åœ¨çš„ç›®å½•æˆ–æ–‡ä»¶å¤¹ï¼Œå®ƒçš„å®ä½“æ˜¯ä½äº .git ç›®å½•çš„ index æ–‡ä»¶ã€‚index æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…å«ç€ä¸€ä¸ªç”±è·¯å¾„åç§°ã€æƒé™å’Œ blob å¯¹è±¡çš„ SHA-1 å€¼ç»„æˆçš„æœ‰åºåˆ—è¡¨ã€‚å¯ä»¥é€šè¿‡ `git ls-files` å‘½ä»¤æŸ¥çœ‹ index ä¸­çš„å†…å®¹ï¼š

     ![20240302144341](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240302144341.png)

     index ä¸­è®°å½•äº†æš‚å­˜åŒºæ–‡ä»¶çš„è·¯å¾„åç§°å’Œ SHA-1 IDï¼Œæ–‡ä»¶å†…å®¹å·²ç»ä½œä¸º blob å¯¹è±¡ä¿å­˜åˆ°äº† .git/objects ç›®å½•ä¸­ã€‚

#### æäº¤å†å²

æäº¤å†å²æ˜¯å·¥ä½œåŒºæ–‡ä»¶åœ¨ä¸åŒæ—¶é—´çš„æ–‡ä»¶å¿«ç…§ï¼ˆå¿«ç…§å³æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹åœ¨ç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å†…å®¹å’Œå…ƒä¿¡æ¯ï¼‰ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ `git log` å‘½ä»¤æŸ¥çœ‹å½“å‰åˆ†æ”¯çš„æäº¤å†å²ï¼š

![20240302144553](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240302144553.png)

### åˆ†æ”¯

Git åˆ†æ”¯çš„æœ¬è´¨ï¼š**ä¸€ä¸ªæŒ‡å‘æŸä¸€ç³»åˆ—æäº¤ä¹‹é¦–çš„æŒ‡é’ˆæˆ–å¼•ç”¨**ã€‚

æˆ‘ä»¬ç”¨ HEAD æ¥æŒ‡å‘æœ€è¿‘çš„ä¸€æ¬¡æäº¤ï¼ŒHEAD æ–‡ä»¶é€šå¸¸æ˜¯ä¸€ä¸ªç¬¦å·å¼•ç”¨ï¼ˆsymbolic referenceï¼‰ï¼ŒæŒ‡å‘ç›®å‰æ‰€åœ¨çš„åˆ†æ”¯ã€‚æ‰€è°“ç¬¦å·å¼•ç”¨ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªæŒ‡å‘å…¶ä»–å¼•ç”¨çš„å¼•ç”¨ï¼š

![20240302150251](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240302150251.png)

**å½“æˆ‘ä»¬ `git checkout` ä¸€ä¸ªåˆ†æ”¯æˆ–æäº¤æ—¶ï¼Œå®ƒä¼šä¿®æ”¹ HEAD æŒ‡å‘æ–°çš„åˆ†æ”¯å¼•ç”¨æˆ–æäº¤ï¼Œå°†æš‚å­˜åŒºå¡«å……ä¸ºè¯¥æ¬¡æäº¤çš„æ–‡ä»¶å¿«ç…§ï¼Œç„¶åå°†æš‚å­˜åŒºçš„å†…å®¹è§£åŒ…å¤åˆ¶åˆ°å·¥ä½œåŒºä¸­ã€‚**

![20240302152423](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240302152423.png)

## Git åŸºæœ¬æ“ä½œ

### git config

#### å¯¹æ‰€æœ‰æœ¬åœ°ä»“åº“çš„ç”¨æˆ·ä¿¡æ¯è¿›è¡Œé…ç½®

```perl
# å¯¹ä½ çš„ commit æ“ä½œè®¾ç½®å…³è”çš„ç”¨æˆ·å
git config --global user.name "chuenwei0129"
# å¯¹ä½ çš„ commit æ“ä½œè®¾ç½®å…³è”çš„é‚®ç®±åœ°å€
git config --global user.email "chuenwei0129@gmail.com"
# å¯ç”¨æœ‰å¸®åŠ©çš„å½©è‰²å‘½ä»¤è¡Œè¾“å‡º
git config --global color.ui auto
```

#### æŸ¥çœ‹ Git é…ç½®

```perl
# åˆ—å‡ºå½“å‰é…ç½®
git config --list
# åˆ—å‡ºæœ¬åœ° Repository é…ç½®
git config --local --list
# åˆ—å‡ºå…¨å±€é…ç½®
git config --global --list
# åˆ—å‡ºç³»ç»Ÿé…ç½®
git config --system --list
```

#### æŠŠ Git çš„é»˜è®¤ä¸»åˆ†æ”¯ master ä¿®æ”¹æˆ main

1. å°† Git é»˜è®¤åˆ†æ”¯æ”¹ä¸º main

    ```perl
    git config --global init.defaultBranch main
    ```

2. ä¿®æ”¹å·²åˆ›å»ºé¡¹ç›®çš„ä¸»åˆ†æ”¯ä¸º main

    ```perl
    # æŠŠå½“å‰ master åˆ†æ”¯æ”¹åä¸º mainï¼Œå…¶ä¸­ -M çš„æ„æ€æ˜¯ç§»åŠ¨æˆ–è€…é‡å‘½åå½“å‰åˆ†æ”¯
    git branch -M main
    ```

#### é…ç½® Git çš„é»˜è®¤ç¼–è¾‘å™¨ä¸º VSCode

Git é»˜è®¤ç¼–è¾‘å™¨æ˜¯ vimï¼Œä¸è¿‡æœ€æ–°ç‰ˆçš„ Git å®‰è£…æ—¶å·²ç»å¯ä»¥é€‰æ‹©é»˜è®¤ç¼–è¾‘å™¨äº†ã€‚

**ç¬¬ä¸€æ­¥**ï¼šç¡®ä¿ä½ å·²ç»å®‰è£…äº† VSCode å¹¶ä¸”é…ç½®äº†ç¯å¢ƒå˜é‡

**ç¬¬äºŒæ­¥**ï¼šé…ç½® core.editor å±æ€§

```perl
git config --global core.editor "code --wait"
```

æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤åå°±å¯ä»¥äº†ã€‚ä½†æ˜¯æ¯æ¬¡éƒ½æ˜¯ä»¥æ–°å»ºä¸€ä¸ª tab é¡µçš„æ–¹å¼æ‰“å¼€ç¼–è¾‘å™¨ï¼Œå¦‚æœä½ å¸Œæœ›æ¯æ¬¡éƒ½æ‰“å¼€ä¸€ä¸ªæ–°çª—å£ï¼Œé‚£ä¹ˆå°±éœ€è¦åŠ ä¸Š `--new-window` å‚æ•°ã€‚

```perl
git config --global core.editor "code --wait --new-window"
```

å¦‚æœæƒ³æ¢å¤ vimï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å³å¯

```perl
git config --global --unset core.editor
```

### git stage

> git çš„ addï¼Œæ˜¯ä¸€ä¸ªå®¹æ˜“å¼•èµ·ç–‘é—®çš„å‘½ä»¤ã€‚åŒæ—¶ï¼Œ`git diff --cached` æ˜¯æ¯”è¾ƒ stage çš„æ–‡ä»¶çš„å·®å¼‚çš„ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªä¸ç›´è§‚çš„å‘½ä»¤ã€‚

github 2008 å¹´çš„ blog ä¸­ï¼Œä¹Ÿæåˆ°ï¼Œå®¹æ˜“å¼•èµ·æ··æ·†ï¼š

> things like making use of the term â€˜stageâ€™ for things that happen in the index (such as using â€˜git diff â€”stagedâ€™ instead of â€˜git diff â€”cachedâ€™) is being worked on. Iâ€™m excited that staging files may soon be done via â€˜git stageâ€™ rather-than/in-addition-to â€˜git addâ€™. This is nice for new users who often have a hard time seeing why you have to keep â€˜git addâ€™ing to stage your changes.

äº‹å®ä¸Šï¼Œåœ¨ git çš„åç»­ç‰ˆæœ¬ä¸­ï¼Œå°±åšäº†ä¸¤ä¸ªä¿®æ”¹ï¼š

`git stage` ä½œä¸º `git add` çš„ä¸€ä¸ªåŒä¹‰è¯

`git diff --staged` ä½œä¸º `git diff --cached` çš„ç›¸åŒå‘½ä»¤

ä¸ºäº†å®¹æ˜“ç†è§£ï¼Œæ¨èå¤§å®¶ä½¿ç”¨ `git stage` å’Œ `git diff --staged` è¿™ä¸¤ä¸ªå‘½ä»¤ï¼Œè€Œ `git add` å’Œ `git diff --cached` è¿™ä¸¤ä¸ªå‘½ä»¤ï¼Œä»…ä»…ä¸ºäº†ä¿æŒå’Œä»¥å‰çš„å…¼å®¹åšä¿ç•™ã€‚

### git commit

æœ‰æ—¶å€™æˆ‘ä»¬æäº¤å®Œäº†æ‰å‘ç°æ¼æ‰äº†å‡ ä¸ªæ–‡ä»¶æ²¡æœ‰æ·»åŠ ï¼Œæˆ–è€…æäº¤ä¿¡æ¯å†™é”™äº†ã€‚æ­¤æ—¶ï¼Œå¯ä»¥è¿è¡Œå¸¦æœ‰ `--amend` é€‰é¡¹çš„æäº¤å‘½ä»¤æ¥é‡æ–°æäº¤ï¼š

```perl
git commit --amend
```

ä¾‹å¦‚ï¼Œä½ æäº¤åå‘ç°å¿˜è®°äº†æš‚å­˜æŸäº›éœ€è¦çš„ä¿®æ”¹ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·æ“ä½œï¼š

```perl
git commit -m 'initial commit'
git add forgotten_file
git commit --amend
# ä¼šè¿›å…¥ç¼–è¾‘å™¨ï¼Œå¯å°†ç¬¬ä¸€æ¬¡æäº¤çš„æäº¤ä¿¡æ¯ä¿®æ”¹ä¸ºç¬¬äºŒæ¬¡æäº¤çš„æäº¤ä¿¡æ¯
```

æœ€ç»ˆä½ åªä¼šæœ‰ä¸€ä¸ªæäº¤ â€”â€” ç¬¬äºŒæ¬¡æäº¤å°†ä»£æ›¿ç¬¬ä¸€æ¬¡æäº¤çš„ç»“æœã€‚

### Git ä¸­çš„æ’¤é”€

> [git å·¥ä½œåŸç†ä¸æ’¤é”€æ“ä½œå›¾è§£](https://www.waynerv.com/posts/git-undo-intro/)

### git pull

`git pull` å‘½ä»¤ç­‰ä»·äºï¼šå…ˆæ‰§è¡Œ `git fetch`ï¼Œå†æ‰§è¡Œ `git merge FETCH_HEAD` å°†è¿œç¨‹ä»“åº“å¯¹åº”åˆ†æ”¯çš„æœ€æ–°æäº¤åˆå¹¶åˆ°å½“å‰æœ¬åœ°åˆ†æ”¯ä¸­ã€‚

`git fetch` ä¼šæŸ¥è¯¢æ‰€æœ‰çš„è¿œç¨‹ä»“åº“æ‰€åŒ…å«åˆ†æ”¯çš„æœ€æ–°æäº¤ï¼Œå¹¶å°†å…¶è®°å½•åˆ° **.git/FETCH_HEAD** æ–‡ä»¶ä¸­ã€‚

> **.git/FETCH_HEAD** æ˜¯ä¸€ä¸ªç‰ˆæœ¬é“¾æ¥ï¼ŒæŒ‡å‘ç€ç›®å‰å·²ç»ä»è¿œç¨‹ä»“åº“å–ä¸‹æ¥çš„æ‰€æœ‰åˆ†æ”¯çš„æœ€æ–°æäº¤ã€‚

#### ä¸å»ºè®®åœ¨æ²¡æœ‰ä¸ºåç¦»åˆ†æ”¯æŒ‡å®šåˆå¹¶ç­–ç•¥æ—¶æ‰§è¡Œ pull æ“ä½œ

`git pull` æœ‰è¿™å‡ é¡¹å¸¸è§çš„é€‰é¡¹æ­é…ï¼š

- ä¸å¸¦ä»»ä½•é€‰é¡¹çš„ `git pull` å‘½ä»¤ï¼šå…ˆå°è¯•å¿«è¿›åˆå¹¶ï¼Œå¦‚æœä¸è¡Œå†è¿›è¡Œæ­£å¸¸åˆå¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤ã€‚
- `git pull --ff-only` å‘½ä»¤ï¼šåªå°è¯•å¿«è¿›åˆå¹¶ï¼Œå¦‚æœä¸è¡Œåˆ™ç»ˆæ­¢å½“å‰åˆå¹¶æ“ä½œã€‚
- `git pull --no-ff` å‘½ä»¤ï¼šç¦æ­¢å¿«è¿›åˆå¹¶ï¼Œå³ä¸ç®¡èƒ½ä¸èƒ½å¿«è¿›åˆå¹¶ï¼Œæœ€åéƒ½ä¼šè¿›è¡Œæ­£å¸¸åˆå¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„æäº¤ã€‚
- `git pull --rebase` å‘½ä»¤ï¼šå…ˆå°è¯•å¿«è¿›åˆå¹¶ï¼Œå¦‚æœä¸è¡Œå†è¿›è¡Œå˜åŸºåˆå¹¶ã€‚

å½“ä½¿ç”¨ Git ç‰ˆæœ¬ä¸º 2.27.0 ä»¥ä¸Šæ—¶ï¼Œä½¿ç”¨ `git pull` å‘½ä»¤å‡ºç°ä»¥ä¸‹çš„è­¦å‘Šï¼š

```perl
warning: Pulling without specifying how to reconcile divergent branches is
discouraged. You can squelch this message by running one of the following
commands sometime before your next pull:

  git config pull.rebase false  # merge (the default strategy)
  git config pull.rebase true   # rebase
  git config pull.ff only       # fast-forward only

You can replace "git config" with "git config --global" to set a default
preference for all repositories. You can also pass --rebase, --no-rebase,
or --ff-only on the command line to override the configured default per
invocation.
```

è¯¥è­¦å‘Šçš„ä¸­æ–‡ç‰ˆæœ¬æ–‡æ¡ˆæè¿°å¦‚ä¸‹ï¼š

```perl
warning: ä¸å»ºè®®åœ¨æ²¡æœ‰ä¸ºåç¦»åˆ†æ”¯æŒ‡å®šåˆå¹¶ç­–ç•¥æ—¶æ‰§è¡Œ pull æ“ä½œã€‚
æ‚¨å¯ä»¥åœ¨æ‰§è¡Œä¸‹ä¸€æ¬¡ pull æ“ä½œä¹‹å‰æ‰§è¡Œä¸‹é¢ä¸€æ¡å‘½ä»¤æ¥æŠ‘åˆ¶æœ¬æ¶ˆæ¯ï¼š

git config pull.rebase false  # åˆå¹¶ï¼ˆé»˜è®¤ç­–ç•¥ï¼‰
git config pull.rebase true   # å˜åŸº
git config pull.ff only       # ä»…å¿«è¿›

æ‚¨å¯ä»¥å°† "git config" æ›¿æ¢ä¸º "git config --global" ä»¥ä¾¿ä¸ºæ‰€æœ‰ä»“åº“è®¾ç½®
ç¼ºçœçš„é…ç½®é¡¹ã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œ pull å‘½ä»¤æ—¶æ·»åŠ  --rebaseã€--no-rebaseï¼Œ
æˆ–è€… --ff-only å‚æ•°è¦†ç›–ç¼ºçœè®¾ç½®ã€‚
```

**é¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯åç¦»åˆ†æ”¯**ï¼š

å½“æœ¬åœ°çš„åˆ†æ”¯è½åäºè¿œç¨‹åˆ†æ”¯æ—¶ï¼Œæœ¬åœ°åˆ†æ”¯åˆè‡ªè¡Œä¿®æ”¹é¡¹ç›®æ–‡ä»¶ç”Ÿæˆäº†æ–°çš„æäº¤ï¼Œè¿™æ—¶æœ¬åœ°åˆ†æ”¯å†æ‰§è¡Œ `git pull` å‘½ä»¤å°±ä¸èƒ½å¿«è¿›åˆå¹¶ï¼Œå¹¶ä¸”è¿˜å®¹æ˜“å‘ç”Ÿå†²çªã€‚è¿™æ—¶çš„æœ¬åœ°åˆ†æ”¯ä¾¿ç§°ä¸ºåç¦»åˆ†æ”¯ï¼Œå› ä¸ºè¿™æ—¶çš„æœ¬åœ°åˆ†æ”¯çš„æœ€æ–°æäº¤è·Ÿè¿œç¨‹åˆ†æ”¯çš„æœ€æ–°æäº¤ä¸åŒï¼Œäº§ç”Ÿäº†åç¦»ã€‚

**æ¥ç€ç†è§£ä»€ä¹ˆæ˜¯åˆå¹¶ç­–ç•¥**ï¼š

åˆå¹¶ç­–ç•¥ä¾¿æ˜¯ `git merge --ff-only`ã€`git merge --no-ff`ã€`git merge --rebase` è¿™ä¸‰ç§å¸¸è§çš„åˆå¹¶ç­–ç•¥ï¼Œåˆ†åˆ«ä»£è¡¨ç€å¿«è¿›åˆå¹¶ã€éå¿«è¿›æ™®é€šåˆå¹¶ã€å˜åŸºåˆå¹¶ã€‚

è€Œæˆ‘ä»¬æ‰§è¡Œä¸å¸¦ä»»ä½•é€‰é¡¹çš„ `git pull` å‘½ä»¤æ—¶ï¼ŒGit å°±ä¸çŸ¥é“æˆ‘ä»¬åˆ°åº•æƒ³ç”¨å“ªç§åˆå¹¶ç­–ç•¥æ¥æ‰§è¡Œ `git pull`ï¼Œå› æ­¤ Git ä¼šç»™å‡ºä¸Šè¿°çš„è­¦å‘Šæ–‡æ¡ˆï¼Œå»ºè®®æˆ‘ä»¬é€šè¿‡ `git config` å‘½ä»¤åº”è¯¥æŒ‰ç…§è¿™ä¸‰ç§åˆå¹¶ç­–ç•¥çš„å“ªç§æ¥æ‰§è¡Œã€‚

**è§£å†³é—®é¢˜**ï¼š

- ä¿æŒå½“å‰çš„é»˜è®¤åˆå¹¶ç­–ç•¥ï¼š`git config pull.rebase false`ï¼Œ
å› ä¸º `pull.ff` é»˜è®¤æ˜¯æ²¡æœ‰æŒ‡å®šçš„ï¼Œè€Œæ²¡æœ‰æŒ‡å®šçš„ `pull.ff` çš„é»˜è®¤å€¼ä¸æ˜¾å¼æŒ‡å®šä¸º `false` çš„æ•ˆæœä¸€è‡´ã€‚
- `git pull` æ—¶åªæ¥å—å¿«è¿›åˆå¹¶å’Œå˜åŸºåˆå¹¶ï¼š`git config pull.ff only`ï¼Œä¿è¯æ¯æ¬¡æ‰§è¡Œä¸å¸¦é€‰é¡¹çš„ `git pull` æ—¶è¦ä¹ˆå¿«è¿›åˆå¹¶æˆåŠŸï¼Œè¦ä¹ˆå¿«è¿›åˆå¹¶å¤±è´¥ã€‚å¦‚æœå¿«è¿›åˆå¹¶å¤±è´¥ï¼Œå†æ˜¾å¼æ‰§è¡Œ `git pull --rebase` è¿›è¡Œå˜åŸºåˆå¹¶å³å¯ã€‚

#### åˆå¹¶ä¸¤ä¸ªé»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰å…±åŒåŸºç¡€çš„åˆ†æ”¯

> **I always see this error if when I create a new Github repository with a README.md, then pull it to a local repository at the first time.**

```perl
git pull origin <branch-name> --allow-unrelated-histories
```

> "git merge" used to allow merging two branches that have no common base by default, which led to a brand new history of an existing project created and then get pulled by an unsuspecting maintainer, which allowed an unnecessary parallel history merged into the existing project. The command has been taught not to allow this by default, with an escape hatch --allow-unrelated-histories option to be used in a rare event that merges histories of two projects that started their lives independently.

### git stash

ä¼šæœ‰è¿™ä¹ˆä¸€ä¸ªåœºæ™¯ï¼Œç°åœ¨ä½ æ­£åœ¨ç”¨ä½ çš„ feature åˆ†æ”¯ä¸Šå¼€å‘æ–°åŠŸèƒ½ã€‚è¿™æ—¶ï¼Œç”Ÿäº§ç¯å¢ƒä¸Šå‡ºç°äº†ä¸€ä¸ª bug éœ€è¦ç´§æ€¥ä¿®å¤ï¼Œä½†æ˜¯ä½ è¿™éƒ¨åˆ†ä»£ç è¿˜æ²¡å¼€å‘å®Œï¼Œä¸æƒ³æäº¤ï¼Œæ€ä¹ˆåŠï¼Ÿè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨ `git stash` å‘½ä»¤å…ˆæŠŠå·¥ä½œåŒºå·²ç»ä¿®æ”¹çš„æ–‡ä»¶æš‚å­˜èµ·æ¥ï¼Œç„¶ååˆ‡æ¢åˆ° hotfix åˆ†æ”¯ä¸Šè¿›è¡Œ bug çš„ä¿®å¤ï¼Œä¿®å¤å®Œæˆåï¼Œåˆ‡æ¢å› feature åˆ†æ”¯ï¼Œä»å †æ ˆä¸­æ¢å¤åˆšåˆšä¿å­˜çš„å†…å®¹ã€‚

åŸºæœ¬å‘½ä»¤å¦‚ä¸‹

```perl
git stash # æŠŠæœ¬åœ°çš„æ”¹åŠ¨æš‚å­˜èµ·æ¥
git stash save "message" # æ‰§è¡Œå­˜å‚¨æ—¶ï¼Œæ·»åŠ å¤‡æ³¨ï¼Œæ–¹ä¾¿æŸ¥æ‰¾ã€‚
git stash pop # åº”ç”¨æœ€è¿‘ä¸€æ¬¡æš‚å­˜çš„ä¿®æ”¹ï¼Œå¹¶åˆ é™¤æš‚å­˜çš„è®°å½•
git stash apply  # åº”ç”¨æŸä¸ªå­˜å‚¨ï¼Œä½†ä¸ä¼šæŠŠå­˜å‚¨ä»å­˜å‚¨åˆ—è¡¨ä¸­åˆ é™¤ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬ä¸€ä¸ªå­˜å‚¨ï¼Œå³ stash@{0}ï¼Œå¦‚æœè¦ä½¿ç”¨å…¶ä»–ä¸ªï¼Œgit stash apply stash@{$num}
git stash list # æŸ¥çœ‹ stash æœ‰å“ªäº›å­˜å‚¨
git stash clear # åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„ stash
```

ä¾‹å¦‚ï¼Œæˆ‘æ­£åœ¨å¼€å‘ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä¿®æ”¹äº† `1.js` æ–‡ä»¶é‡Œçš„å†…å®¹ï¼Œ

è¿˜æ²¡å¼€å‘å®Œæˆï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘æƒ³åˆ‡æ¢åˆ° hotfix åˆ†æ”¯ä¸Šä¿®å¤ bugï¼Œå¾—æš‚åœä¸‹å¼€å‘åˆ‡æ¢åˆ° hotfix åˆ†æ”¯ï¼Œä½†æ˜¯ç°åœ¨å·¥ä½œåŒºè¿˜æœ‰å†…å®¹ï¼Œæ­¤æ—¶å¦‚æœåˆ‡æ¢åˆ†æ”¯ Git ä¼šæŠ¥å‡ºä¸‹é¢çš„é”™è¯¯

```perl
error: Your local changes to the following files would be overwritten by checkout:
        1.js
Please commit your changes or stash them before you switch branches.
Aborting
```

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-74s.png)

ä¸Šé¢é‚£å¥è¯çš„æ„æ€å°±æ˜¯è¯´å·¥ä½œåŒºæœ‰æ–‡ä»¶ä¿®æ”¹ï¼Œä¸èƒ½æäº¤ï¼Œéœ€è¦å…ˆè¿›è¡Œ commit æˆ–è€… stash æ“ä½œï¼Œæ‰§è¡Œ git stashï¼Œç»“æœå¦‚ä¸‹

```perl
Saved working directory and index state WIP on stash: 22e561c feat: add 1.js
```

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-76d.png)

æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„å·¥ä½œåŒºå·²ç»å¹²å‡€äº†ï¼Œå¯ä»¥åˆ‡æ¢åˆ° hotfix åˆ†æ”¯è¿›è¡Œ bug ä¿®å¤çš„å·¥ä½œï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨ bug ä¿®å¤å®Œæˆäº†ï¼Œç»§ç»­åˆ‡å› feature åˆ†æ”¯è¿›è¡ŒåŸæœ¬åŠŸèƒ½çš„å¼€å‘ï¼Œæ­¤æ—¶åªéœ€è¦æ‰§è¡Œ `git stash pop`ï¼Œä¹‹å‰æˆ‘ä»¬æš‚å­˜çš„ä¿®æ”¹å°±ä¼šæ¢å¤åˆ°å·¥ä½œåŒºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-776.png)

å½“æˆ‘ä»¬æƒ³è¦æš‚å­˜æ–‡ä»¶ï¼Œåˆ‡æ¢åˆ†æ”¯åšæŸäº›äº‹çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ `git stash` è¿™ç§æœºåˆ¶å¸®åŠ©å¼€å‘ã€‚

> æ¨èåœ¨ä½¿ç”¨ stash çš„ç›¸å…³å‘½ä»¤æ—¶ï¼Œæ¯ä¸€æ¬¡æš‚å­˜çš„æ—¶å€™ï¼Œä¸è¦ç›´æ¥ä½¿ç”¨ `git stash` å‘½ä»¤è¿›è¡Œæš‚å­˜ä¸‹æ¥ï¼Œè€Œæ˜¯ä½¿ç”¨ `git stash save "message..."` è¿™ç§æ–¹å¼ï¼Œç»™æœ¬æ¬¡çš„æäº¤åšä¸€ä¸ªä¿¡æ¯çš„è®°å½•ã€‚è¿™æ ·ï¼Œæƒ³åº”ç”¨æ›´æ”¹çš„æ—¶å€™ï¼Œå…ˆé€šè¿‡ `git stash list` æŸ¥çœ‹ä¸€ä¸‹æ‰€æœ‰çš„æš‚å­˜åˆ—è¡¨ã€‚ä¹‹åï¼Œæ¨èä½¿ç”¨ `git stash apply stash@${num}` çš„æ–¹å¼è¿›è¡Œåº”ç”¨å¯¹åº”çš„ stashï¼Œè¿™æ ·ä¸ä¼šæ¸…ç©ºå·²æœ‰çš„ stash çš„åˆ—è¡¨é¡¹ï¼Œå¹¶ä¸”èƒ½åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œåŒºï¼Œä¸éœ€è¦è¿™ä¸ªæš‚å­˜çš„è¯ï¼Œå†æ‰‹åŠ¨æ¸…é™¤å°±å¯ä»¥äº†ã€‚

### git rebase

#### git rebase ä½œç”¨äºåˆ†æ”¯åˆå¹¶

> rebase ç¿»è¯‘ä¸ºå˜åŸºï¼Œä»–çš„ä½œç”¨å’Œ merge å¾ˆç›¸ä¼¼ï¼Œç”¨äºæŠŠä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ä¸Šã€‚

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/b169721a6bfc42a7b4754f7c5d65672d_tplv-k3u1fbpfcp-zoom-in-crop-mark_1304_0_0_0.webp)

1. `git merge` å’Œ `git rebase` çš„åŒºåˆ«

    ä¸åŒäº `git rebase` çš„æ˜¯ï¼Œ`git merge` åœ¨ä¸æ˜¯ fast-forwardï¼ˆå¿«é€Ÿåˆå¹¶ï¼‰çš„æƒ…å†µä¸‹ï¼Œä¼šäº§ç”Ÿä¸€æ¡é¢å¤–çš„åˆå¹¶è®°å½•ï¼Œç±»ä¼¼ `Merge branch 'xxx' into 'xxx'` çš„ä¸€æ¡æäº¤ä¿¡æ¯ã€‚

    å¦å¤–ï¼Œåœ¨è§£å†³å†²çªçš„æ—¶å€™ï¼Œç”¨ merge åªéœ€è¦è§£å†³ä¸€æ¬¡å†²çªå³å¯ï¼Œç®€å•ç²—æš´ï¼Œè€Œç”¨ rebase çš„æ—¶å€™ ï¼Œéœ€è¦ä¾æ¬¡è§£å†³æ¯æ¬¡çš„å†²çªï¼Œæ‰å¯ä»¥æäº¤ã€‚

2. è§£å†³ git rebase æ“ä½œåæ¨é€è¿œç«¯åˆ†æ”¯ä¸æˆåŠŸçš„é—®é¢˜

    ```perl
    git push -f
    ```

#### git rebase äº¤äº’æ¨¡å¼

åœ¨å¼€å‘ä¸­ï¼Œå¸¸ä¼šé‡åˆ°åœ¨ä¸€ä¸ªåˆ†æ”¯ä¸Šäº§ç”Ÿäº†å¾ˆå¤šçš„æ— æ•ˆçš„æäº¤ï¼Œè¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ rebase çš„äº¤äº’å¼æ¨¡å¼å¯ä»¥æŠŠå·²ç»å‘ç”Ÿçš„å¤šæ¬¡æäº¤å‹ç¼©æˆä¸€æ¬¡æäº¤ï¼Œå¾—åˆ°äº†ä¸€ä¸ªå¹²å‡€çš„æäº¤å†å²ï¼Œä¾‹å¦‚æŸä¸ªåˆ†æ”¯çš„æäº¤å†å²æƒ…å†µå¦‚ä¸‹ï¼š

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-147.png)

è¿›å…¥äº¤äº’å¼æ¨¡å¼çš„æ–¹å¼æ˜¯æ‰§è¡Œï¼š

```perl
git rebase -i <base-commit>
```

å‚æ•° `base-commit` å°±æ˜¯æŒ‡æ˜æ“ä½œçš„åŸºç‚¹æäº¤å¯¹è±¡ï¼ŒåŸºäºè¿™ä¸ªåŸºç‚¹è¿›è¡Œ `rebase` çš„æ“ä½œï¼Œå¯¹äºä¸Šè¿°æäº¤å†å²çš„ä¾‹å­ï¼Œæˆ‘ä»¬è¦æŠŠæœ€åçš„ä¸€ä¸ªæäº¤å¯¹è±¡ï¼ˆ 8061e866 ï¼‰ä¹‹å‰çš„æäº¤å‹ç¼©æˆä¸€æ¬¡æäº¤ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„å‘½ä»¤æ ¼å¼æ˜¯ï¼š

```perl
git rebase -i 8061e866
```

> TIPSï¼šæœ‰æ—¶å€™ `git rebase -i --root` ä¼šå¾ˆæœ‰ç”¨

æ­¤æ—¶ä¼šè¿›å…¥ä¸€ä¸ª vim çš„äº¤äº’å¼é¡µé¢ï¼Œç¼–è¾‘å™¨åˆ—å‡ºçš„ä¿¡æ¯åƒä¸‹åˆ—è¿™æ ·ã€‚

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-1c4.png)

æƒ³è¦åˆå¹¶è¿™ä¸€å †æ›´æ”¹ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ Squash ç­–ç•¥è¿›è¡Œåˆå¹¶ï¼Œå³æŠŠå½“å‰çš„ commit å’Œå®ƒçš„ä¸Šä¸€ä¸ª commit å†…å®¹è¿›è¡Œåˆå¹¶ï¼Œ å¤§æ¦‚å¯ä»¥è¡¨ç¤ºä¸ºä¸‹é¢è¿™æ ·ï¼Œåœ¨äº¤äº’æ¨¡å¼çš„ rebase ä¸‹ï¼Œè‡³å°‘ä¿ç•™ä¸€ä¸ª pickï¼Œå¦åˆ™å‘½ä»¤ä¼šæ‰§è¡Œå¤±è´¥ã€‚

ä¿®æ”¹æ–‡ä»¶å æŒ‰ä¸‹ `:` ç„¶å `wq` ä¿å­˜é€€å‡ºï¼Œæ­¤æ—¶åˆä¼šå¼¹å‡ºä¸€ä¸ªç¼–è¾‘é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢æ˜¯ç”¨æ¥ç¼–è¾‘æäº¤çš„ä¿¡æ¯ï¼Œä¿®æ”¹ä¸º `feat: å˜åŸº`ï¼Œæœ€åä¿å­˜ä¸€ä¸‹

![](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/terminal/SCR-20220403-1be.png)

> ç‰¹åˆ«æ³¨æ„ï¼Œåªèƒ½åœ¨è‡ªå·±ä½¿ç”¨çš„ feature åˆ†æ”¯ä¸Šè¿›è¡Œ rebase æ“ä½œï¼Œä¸å…è®¸åœ¨é›†æˆåˆ†æ”¯ä¸Šè¿›è¡Œ rebaseï¼Œå› ä¸ºè¿™ç§æ“ä½œä¼šä¿®æ”¹é›†æˆåˆ†æ”¯çš„å†å²è®°å½•ã€‚

### git cherry-pick

`git cherry-pick` å¯ä»¥ç†è§£ä¸ºâ€æŒ‘æ‹£â€æäº¤ï¼Œå’Œ merge åˆå¹¶ä¸€ä¸ªåˆ†æ”¯çš„æ‰€æœ‰æäº¤ä¸åŒçš„æ˜¯ï¼Œå®ƒä¼šè·å–æŸä¸€ä¸ªåˆ†æ”¯çš„å•ç¬”æäº¤ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªæ–°çš„æäº¤å¼•å…¥åˆ°ä½ å½“å‰åˆ†æ”¯ä¸Šã€‚å½“æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°åˆå…¥å…¶ä»–åˆ†æ”¯çš„æäº¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³å¯¹æ•´ä¸ªåˆ†æ”¯è¿›è¡Œåˆå¹¶ï¼Œè€Œæ˜¯åªæƒ³å°†æŸä¸€æ¬¡æäº¤åˆå…¥åˆ°æœ¬åœ°å½“å‰åˆ†æ”¯ä¸Šï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨ `git cherry-pick` äº†ã€‚

ä¸€æ¬¡è½¬ç§»å¤šä¸ªæäº¤ï¼š

```perl
git cherry-pick commit1 commit2
```

ä¸Šé¢çš„å‘½ä»¤å°† commit1 å’Œ commit2 ä¸¤ä¸ªæäº¤åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ã€‚

å¤šä¸ªè¿ç»­çš„ commitï¼Œä¹Ÿå¯åŒºé—´å¤åˆ¶ï¼š

```perl
git cherry-pick commit1^..commit2
```

ä¸Šé¢çš„å‘½ä»¤å°† commit1 åˆ° commit2 è¿™ä¸ªåŒºé—´çš„ commit éƒ½åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ï¼ˆåŒ…å« commit1ã€commit2ï¼‰ï¼Œcommit1 æ˜¯æœ€æ—©çš„æäº¤ã€‚

### git push

å¦‚æœå½“å‰åˆ†æ”¯ä¸å¤šä¸ªä¸»æœºå­˜åœ¨è¿½è¸ªå…³ç³»ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ -u é€‰é¡¹ä¼šæŒ‡å®šä¸€ä¸ªé»˜è®¤ä¸»æœºï¼Œè¿™æ ·åé¢å°±å¯ä»¥ä¸åŠ ä»»ä½•å‚æ•°ä½¿ç”¨ git push

## Git Cheat Sheet

> [Git Cheat Sheet](https://shfshanyue.github.io/cheat-sheets/git)

## Git é£è¡Œè§„åˆ™

> [Git é£è¡Œè§„åˆ™](https://github.com/k88hudson/git-flight-rules/blob/master/README_zh-CN.md)

## Github å·¥ä½œæµ

> [ååˆ†é’Ÿå­¦ä¼šæ­£ç¡®çš„ Github å·¥ä½œæµï¼Œå’Œå¼€æºä½œè€…ä»¬ä½¿ç”¨åŒä¸€å¥—æµç¨‹](https://www.bilibili.com/video/BV19e4y1q7JJ)

## Mac ä¸­ Git å¤§å°å†™é—®é¢˜

### é—®é¢˜

Mac / Windows ç¯å¢ƒä¸‹ Git åœ¨ä¸è®¾ç½®å¤§å°å†™æ•æ„Ÿè§„åˆ™çš„æ—¶å€™é»˜è®¤å¤§å°å†™æ˜¯ä¸æ•æ„Ÿï¼Œè€Œ Linux ä¸‹ Git æ˜¯é»˜è®¤å¤§å°å†™æ•æ„Ÿçš„ã€‚

**å¦‚æœä¸æ˜¯å¿…é¡»è¦å’Œ linux ç”¨æˆ·ä¸€èµ·å·¥ä½œï¼Œä¸å»ºè®®æ”¹å˜é»˜è®¤è¡Œä¸ºã€‚**

> [ä¸ºä»€ä¹ˆ Git é»˜è®¤ä¸åŒºåˆ†æ–‡ä»¶å¤¹å¤§å°å†™ï¼Ÿ](https://www.zhihu.com/question/57779034)

å¯ä»¥é€šè¿‡ `git mv` æ“ä½œæ¥é¿å… Git æœªè¯†åˆ«ï¼š

```perl
git mv myfolder tmp
git mv tmp MyFolder
```

ä¹Ÿå¯ä»¥ä¿®æ”¹ `git config` æ¥è¾¾åˆ°åŒºåˆ†å¤§å°å†™ï¼š

```perl
git config core.ignorecase false
```

### æ¡ˆä¾‹

#### é—®é¢˜å¤ç°

åœ¨ Mac ä¸Šå¼€å‘ç¨‹åºï¼Œå¹¶ä½¿ç”¨ Git è¿›è¡Œç‰ˆæœ¬ç®¡ç†ï¼Œåœ¨ä½¿ç”¨ React ç¼–å†™ Component æ—¶ï¼Œç»„ä»¶åä¸€èˆ¬å»ºè®®é¦–å­—æ¯å¤§å†™ã€‚

**åœ¨ React ç»„ä»¶çš„æ–‡ä»¶è¿›è¡Œå‘½åæ—¶ï¼Œåˆšå¼€å§‹æ˜¯å°å†™ï¼Œåæ¥ä¸ºäº†ä¿æŒå›¢é˜Ÿä¸€è‡´ï¼Œåˆæ”¹æˆäº†å¤§å†™ï¼Œç„¶è€Œ Git ä¸ä¼šå‘ç°å¤§å°å†™çš„å˜åŒ–ï¼Œæ­¤æ—¶å°±å‡ºäº†é—®é¢˜ã€‚**

å†æ¢³ç†ä¸€éè¿™ä¸ªé€»è¾‘ï¼š

1. å°æ˜ç¼–å†™ç»„ä»¶ `button.js`ï¼Œæäº¤ä»£ç 
2. å°æ˜è§‰å¾—ç»„ä»¶å‘½åä¸å¦¥ï¼Œæ”¹ä¸º `Button.js`
3. å°æ˜å¹¶ä¿®æ”¹æ‰€æœ‰æ–‡ä»¶å¯¹å®ƒçš„å¼•ç”¨ï¼Œæœ¬åœ°ç¯å¢ƒè¿è¡Œæ­£å¸¸ï¼Œæäº¤ä»£ç 
4. æ„å»ºæœåŠ¡å™¨é€šè¿‡ Git æ‹‰å–ä»£ç ï¼Œè¿›è¡Œæ„å»ºï¼Œ**Git å¹¶æœªè®¤è¯†åˆ° `button.js` å¤§å°å†™å‘ç”Ÿå˜åŒ–**ï¼Œæ‰€æœ‰å¼•ç”¨ `Button.js` çš„ç»„ä»¶å‘ç”ŸæŠ¥é”™ï¼Œå¤±è´¥

#### è§£å†³é—®é¢˜

é€šè¿‡ `git mv`ï¼Œåœ¨ Git æš‚å­˜åŒºä¸­å†æ›´æ”¹ä¸€éæ–‡ä»¶å¤§å°å†™è§£å†³é—®é¢˜

```perl
git mv test Test
```

ä½†æ˜¯ä¿®æ”¹æ–‡ä»¶å¤¹æ—¶ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼š

```js
fatal: renaming 'dir' failed: Invalid argument
```

ä½¿ç”¨ä¸‹è¾¹æ–¹æ³•æ³•ä¿®æ”¹ï¼š

```perl
git mv dir DirTemp
git mv DirTemp Dir
```

## gitignore

æœ‰æ—¶ä¸€äº›æ–‡ä»¶æœ€å¥½ä¸è¦ç”¨ Git è·Ÿè¸ªã€‚è¿™é€šå¸¸åœ¨åä¸º `.gitignore` çš„ç‰¹æ®Šæ–‡ä»¶ä¸­å®Œæˆã€‚ä½ å¯ä»¥åœ¨ [github.com/github/gitignore](https://github.com/github/gitignore) æ‰¾åˆ°æœ‰ç”¨çš„ `.gitignore` æ–‡ä»¶æ¨¡æ¿ã€‚

**é—®é¢˜ï¼š**

åœ¨ä½¿ç”¨ git è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œå°†æƒ³è¢«å¿½ç•¥çš„æ–‡ä»¶(æ–‡ä»¶å¤¹)é…ç½®åˆ° `.gitignore` æ–‡ä»¶ä¸­åï¼Œå®é™…ä¿®æ”¹äº†æƒ³è¢«å¿½ç•¥çš„æ–‡ä»¶ï¼Œè°ƒç”¨ `git status` æŸ¥çœ‹æ—¶ï¼Œä»ç„¶ä¼šæç¤ºæäº¤è¿™äº›æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´å®é™…å¹¶æ²¡æœ‰è¢«å¿½ç•¥

**åŸå› ï¼š**

åŸå› æ˜¯ `git ignore` åªä¼šå¯¹ä¸åœ¨ git ä»“åº“ä¸­çš„æ–‡ä»¶è¿›è¡Œå¿½ç•¥ï¼Œå¦‚æœè¿™äº›æ–‡ä»¶å·²ç»åœ¨ git ä»“åº“ä¸­ï¼Œåˆ™ä¸ä¼šå¿½ç•¥ã€‚æ‰€ä»¥å¦‚æœéœ€è¦å¿½ç•¥çš„æ–‡ä»¶å·²ç»æäº¤åˆ°æœ¬åœ°ä»“åº“ï¼Œåˆ™éœ€è¦ä»æœ¬åœ°ä»“åº“ä¸­åˆ é™¤æ‰ï¼Œå¦‚æœå·²ç»æäº¤åˆ°è¿œç«¯ä»“åº“ï¼Œåˆ™éœ€è¦ä»è¿œç«¯ä»“åº“ä¸­åˆ é™¤ã€‚åˆ é™¤ `.gitignore` æ–‡ä»¶æ‰èƒ½å®é™…ç”Ÿæ•ˆã€‚

**ä¸ºä»€ä¹ˆæˆ‘å¢åŠ äº† `.gitignore` é‡Œçš„è§„åˆ™å´æ²¡æœ‰æ•ˆæœï¼Ÿ**

è¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¯¯è§£äº† `.gitignore` æ–‡ä»¶çš„ç”¨é€”ï¼Œè¯¥æ–‡ä»¶åªèƒ½ä½œç”¨äº `Untracked Files`ï¼Œä¹Ÿå°±æ˜¯é‚£äº›ä»æ¥æ²¡æœ‰è¢« Git è®°å½•è¿‡çš„æ–‡ä»¶ï¼ˆè‡ªæ·»åŠ ä»¥åï¼Œä»æœª add åŠ commit è¿‡çš„æ–‡ä»¶ï¼‰ã€‚

ä¹‹æ‰€ä»¥ä½ çš„è§„åˆ™ä¸ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºé‚£äº› `.log` æ–‡ä»¶æ›¾ç»è¢« Git è®°å½•è¿‡ï¼Œå› æ­¤ `.gitignore` å¯¹å®ƒä»¬å®Œå…¨æ— æ•ˆã€‚

## å‚è€ƒèµ„æ–™

- [æˆ‘åœ¨å·¥ä½œä¸­æ˜¯å¦‚ä½•ä½¿ç”¨ Git çš„](https://juejin.cn/post/6974184935804534815)
- [é«˜é¢‘ Git é¢è¯•é¢˜](https://zhuanlan.zhihu.com/p/101954895)
- [Git refusing to merge unrelated histories on rebase](https://stackoverflow.com/questions/37937984/git-refusing-to-merge-unrelated-histories-on-rebase)
- [ä¸å»ºè®®åœ¨æ²¡æœ‰ä¸ºåç¦»åˆ†æ”¯æŒ‡å®šåˆå¹¶ç­–ç•¥æ—¶æ‰§è¡Œ pull æ“ä½œ](https://blog.csdn.net/wq6ylg08/article/details/114106272)
