---
group:
  title: 2023 ğŸ°
  order: -2023
title: Dumi ä½¿ç”¨è®°å½•
toc: content
---

> [å®˜ç½‘å¯¼èˆª](https://d.umijs.org/guide/initialize)

## ç›®å½•ç»“æ„

æœ¬ç«™æ˜¯é€šè¿‡ `create-dumi` åˆ›å»ºçš„ React æ¨¡æ¿ (`React é€‰é¡¹`)ç”Ÿæˆçš„ï¼Œç›®å½•ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š

- **`docs`** å­˜æ”¾ç¬”è®°ã€åšå®¢ã€ç¢ç‰‡åŒ–çŸ¥è¯†ç­‰ã€‚
- **`src`** å­˜æ”¾å¼€å‘ npm åŒ…çš„æºç ã€‚
- **`public`** å­˜æ”¾é™æ€èµ„æºã€‚
- **`.dumirc.ts`** dumi çš„é…ç½®æ–‡ä»¶ã€‚
- **`.fatherrc.ts`** father çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºç»„ä»¶åº“æ‰“åŒ…ã€‚

<Tree>
  <ul>
    <li>
      docs
      <small>æ–‡æ¡£ç›®å½•</small>
      <ul>
        <li>
          index.md
          <small>ç½‘ç«™é¦–é¡µ</small>
        </li>
        <li>
          about.md
          <small>å…³äºé¡µ</small>
        </li>
        <li>
          blog
          <ul>
            <li>
              index.md
              <small>åšå®¢å½’æ¡£</small>
            </li>
            <li>
              dumi.md
              <small>æŸä¸€ç¯‡åšå®¢</small>
            </li>
          </ul>
        </li>
        <li>
          notes
          <ul>
            <!-- <li>
              index.md
              <small>å¯é€‰ï¼Œä¸é…ç½®çš„è¯ï¼Œnav é»˜è®¤ä¼šå±•ç¤ºä¸º notes</small>
            </li> -->
            <li>
              css
              <ul>
                <li>
                  index.md
                  <small>äºŒçº§å¯¼èˆªé¡µä¸‹ css ä¸“é¢˜å½’æ¡£</small>
                </li>
                <li>
                  flex.md
                  <small>äºŒçº§å¯¼èˆªé¡µä¸‹ css ä¸“é¢˜ä¸‹æŸä¸€ç¯‡æ–‡ç« </small>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li>
      src
      <small>åº“æºç ç›®å½•</small>
      <ul>
        <li>
          components
          <small>ç»„ä»¶åº“æºç ç›®å½•</small>
          <ul>
            <li>
              Foo
              <small>å•ä¸ªç»„ä»¶</small>
              <ul>
                <li>
                  index.tsx
                  <small>ç»„ä»¶æºç </small>
                </li>
                <li>
                  index.md
                  <small>ç»„ä»¶æ–‡æ¡£</small>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          hooks
          <small>Hooks æºç ç›®å½•</small>
          <ul>
            <li>
              use-foo
              <small>å•ä¸ª Hooks</small>
              <ul>
                <li>
                  index.ts
                  <small>hooks æºç </small>
                </li>
                <li>
                  index.md
                  <small>hooks æ–‡æ¡£</small>
                </li>
              </ul>
            </li>
          </ul>
        </li>
        <li>
          index.ts
          <small>åº“å…¥å£æ–‡ä»¶</small>
        </li>
      </ul>
    </li>
    <li>
      public
      <small>é™æ€åº¦èµ„æºç›®å½•</small>
      <ul></ul>
    </li>
    <li>
      .dumirc.ts
      <small>dumi çš„é…ç½®æ–‡ä»¶</small>
    </li>
    <li>
      .fatherrc.ts
      <small> father çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºç»„ä»¶åº“æ‰“åŒ… </small>
    </li>
  </ul>
</Tree>

## å†™æ–‡æ¡£æ—¶çš„æ³¨æ„äº‹é¡¹

1. åœ¨ dumi é‡Œï¼Œdocs è·¯å¾„ä¸‹çš„æ–‡æ¡£ä¼šæ ¹æ®åµŒå¥—ç»“æ„è‡ªåŠ¨è¯†åˆ«å¹¶å½’ç±»åˆ°ä¸åŒçš„å¯¼èˆªç±»ç›®ä¸‹ï¼›dumi é»˜è®¤ä¼šå°† src ä¸‹çš„æ–‡æ¡£éƒ½å½’ç±»åˆ° `/components` ä¸‹ (å¯ä»¥é…ç½®ä¿®æ”¹)ï¼›

2. åœ¨ docs ä¸­å†™æ–‡æ¡£æ—¶ï¼Œdumi ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰ä»¥ `.` å’Œ `_` å¼€å¤´çš„æ–‡ä»¶åŠæ–‡ä»¶å¤¹ï¼Œä»…è¯†åˆ« `.md` åç¼€çš„æ–‡ä»¶ï¼Œè¯†åˆ«è·¯å¾„å¯é€šè¿‡ `resolve.docDirs` è¿›è¡Œä¿®æ”¹ï¼›

3. dumi ä¼šè‡ªåŠ¨å°† Markdown æ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªæ ‡é¢˜ä½œä¸ºè¯¥æ–‡æ¡£çš„æ ‡é¢˜ï¼Œå¦‚æœæ²¡æœ‰æ ‡é¢˜ï¼Œåˆ™ä¼šä½¿ç”¨æ–‡ä»¶åä½œä¸ºæ ‡é¢˜ã€‚

## å¦‚ä½•é…ç½® [tailwindcss v4](https://tailwindcss.com/docs/preflight)

> https://github.com/umijs/umi/issues/12911#issuecomment-3079109376

## å¦‚ä½•é…ç½® tailwindcss v3

`tailwindcss` é…ç½®é¡¹éœ€è¦å®‰è£… `@umijs/plugins`ï¼Œå¹¶ä¸”æŒ‚è½½ `@umijs/plugins/dist/tailwindcss` æ’ä»¶æ‰èƒ½ä½¿ç”¨ã€‚

å…·ä½“å®ç°ï¼Œä¸ºä»¥ä¸‹æ­¥éª¤ï¼š

1. å®‰è£…ï¼š

   ```bash
   pnpm i @umijs/plugins tailwindcss -D
   ```

2. åœ¨ `.dumirc.ts` ä¸­é…ç½®ï¼š

   ```js
   plugins: ['@umijs/plugins/dist/tailwindcss'];
   ```

3. å¯ç”¨ `tailwindcss`ï¼šåŒæ ·åœ¨ `.dumirc.ts` åŠ å…¥

   ```js
   tailwindcss: {
     //...
   }
   ```

4. ç¡®ä¿åœ¨æ ¹ç›®å½•ä¸‹å·²åˆ›å»º `tailwind.config.js` å’Œ `tailwind.css`ã€‚

   ![20240613235249](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240613235249.png)

5. é…ç½® `tailwind.config.js`ï¼š

   ```js
   /** @type {import('tailwindcss').Config} */
   module.exports = {
     // å…³é—­ tailwindcss æä¾›çš„æµè§ˆå™¨æ ·å¼é‡ç½®ï¼Œå¦åˆ™ä¼šä¸ antd reset æ ·å¼å†²çªã€‚
     corePlugins: {
       preflight: false,
     },
     content: ['./code/**/*.{js,jsx,ts,tsx}', './src/**/*.{js,jsx,ts,tsx}'],
     theme: {
       extend: {},
     },
     plugins: [],
   };
   ```

   æœªå…³é—­ tailwindcss æä¾›çš„æµè§ˆå™¨æ ·å¼é‡ç½®ï¼š

   ![20240614052556](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240614052556.png)

## é…ç½® zhlint æ ¼å¼åŒ– Markdown

å®‰è£… `zhlint`ï¼š

```bash
pnpm i zhlint -D
```

é…ç½® `package.json`ï¼š

```json
"lint:md": "zhlint \"./docs/**/*.md\" --fix"
```

## æˆ‘çš„ FrontMatter é…ç½®

### ç½‘ç«™é¦–é¡µ - `docs/index.md`

```yaml
---
title: é¦–é¡µ
hero:
  title: Welcome
  description: Make Me Great Again
  actions:
    - text: å…¥å£
      link: /about
    - text: GitHub
      link: https://github.com/chuenwei0129/awesome-me
---
```

### å…³äºé¡µ - `docs/about.md`

```yaml
---
nav:
  title: å…³äº
  order: 0
title: æˆ‘çš„æ ‡é¢˜
order: -1
---
```

### åšå®¢ä¸“é¢˜ - `docs/blog/index.md`

```yaml
---
nav:
  title: Blog
  order: 0
group:
  title: ä»‹ç»
  order: -9999 # ç¡®ä¿åœ¨åˆ†ç»„ä¸­æ’é¦–ä½
title: è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
---
```

### åšå®¢ä¸“é¢˜ä¸‹çš„æ–‡ç«  - `docs/blog/dumi.md`

```yaml
group:
  title: 2024 ğŸ²
  order: -2024
title: æˆ‘å¦‚ä½•ä½¿ç”¨ dumi
---
```

### äºŒçº§å¯¼èˆª - `docs/notes/index.md`

```yaml
---
nav:
  title: çŸ¥è¯†åº“
  order: 999
---
```

### äºŒçº§å¯¼èˆªä¸‹çš„ JS ä¸“é¢˜ - `docs/notes/js/index.md`

```yaml
---
nav:
  second:
    title: JavaScript
    order: 0
group:
  title: ä»‹ç»
  order: -999
title: è¿™æ˜¯ä»€ä¹ˆï¼Ÿ
---
```

### äºŒçº§å¯¼èˆªä¸‹çš„ JS ä¸“é¢˜ä¸‹çš„æ–‡ç«  - `docs/notes/js/null-undefined.md`

```yaml
---
group:
  title: æ•°æ®ç±»å‹
  order: -1
title: Null ä¸ Undefined
order: -1
toc: content
---
```

## éƒ¨ç½²åˆ° GitHub Pages

### é…ç½® `.dumirc.ts`

ç”±äº GitHub Pages æ˜¯[éåŸŸåæ ¹è·¯å¾„éƒ¨ç½²](https://d.umijs.org/guide/faq#%E9%9D%9E%E6%A0%B9%E7%9B%AE%E5%BD%95%E9%83%A8%E7%BD%B2)ï¼Œç¬¬ä¸€ä¸ªè¦æ³¨æ„çš„å°±æ˜¯ `.dumirc.ts` é…ç½®ä¸­ï¼Œæˆ‘ä»¬è¦æŠŠ `base` å’Œ `publicPath` æ”¹æˆé¡¹ç›®ä»“åº“åç§°çš„è·¯å¾„ã€‚

```ts
// .dumirc.ts
import { defineConfig } from 'dumi';

export default defineConfig({
  outputPath: 'docs-dist',
  base: '/awesome-me/', // æ–‡æ¡£èµ·å§‹è·¯ç”±
  publicPath: '/awesome-me/', // é™æ€èµ„æºèµ·å§‹è·¯å¾„
});
```

> æ–‡æ¡£é¡¹ç›®ç‹¬ç«‹æ—¶ï¼Œé€šå¸¸ `base` å’Œ `publicPath` é…ç½®é¡¹ç›¸åŒã€‚

å½“æˆ‘ä»¬éƒ¨ç½²åˆ° GitHub æ—¶ï¼Œç½‘ç«™è·¯å¾„ä¸Šä¼šåŠ ä¸Šé¡¹ç›®çš„ä»“åº“åã€‚ä¾‹å¦‚ `chuenwei0129.github.io/awesome-me/`ã€‚

- **`base` çš„ä½œç”¨**ï¼šåœ¨ `docs` æ–‡ä»¶å¤¹ç”Ÿæˆçš„è·¯ç”± `/` å’Œ `/about`ï¼Œå¦‚æœéƒ¨ç½²åˆ° GitHub å¯èƒ½ä¼šè·¯ç”±è·³è½¬é”™è¯¯ï¼Œå› æ­¤å¿…é¡»ç»™è·¯ç”±è¡¥ä¸Šå‰ç¼€ `awesome-me`ã€‚
- **`publicPath` çš„ä½œç”¨**ï¼šä¿è¯æ‰“åŒ…åé™æ€èµ„æºè·¯å¾„æ­£ç¡®ï¼Œå¯¹æ‰“åŒ…å `index.html` ä¸­å¼•å…¥çš„é™æ€èµ„æºè·¯å¾„åŠ ä¸Šå‰ç¼€ã€‚æ­¤å¤„ä¹Ÿå³ä»£è¡¨ `/` æ˜ å°„çš„è·¯å¾„ä¸º `/awesome-me`ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥ `/public` æ–‡ä»¶æ—¶éœ€æ³¨æ„ï¼Œä¾‹å¦‚ï¼š`/logo.png` å®é™…ä¸Šè¦å†™æˆ `/awesome-me/logo.png` æ‰èƒ½æ­£ç¡®å¼•å…¥ã€‚

### æ‰‹åŠ¨éƒ¨ç½²

å€ŸåŠ© `gh-pages` å¯ä»¥è½»æ¾å¸®åŠ©æˆ‘ä»¬éƒ¨ç½²æ–‡æ¡£åˆ° GitHub Pagesï¼š

```bash
pnpm install gh-pages --save-dev
```

åœ¨ `package.json` ä¸­æ·»åŠ ï¼š

```json
"scripts": {
  "deploy": "gh-pages -d doc-dist"
}
```

å…ˆç¼–è¯‘ç”Ÿæˆ `doc-dist` ç›®å½•ï¼Œç„¶åå†ä¸€é”®å‘å¸ƒï¼š

```bash
npm run deploy
```

### è‡ªåŠ¨éƒ¨ç½²

åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º `.github/workflows/gh-pages.yml` æ–‡ä»¶ã€‚

```yaml
name: github pages

on:
  push:
    branches:
      - main # default branch

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: Install dependencies
        run: npm install
      - name: Build with dumi
        run: npm run docs:build
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs-dist
```

**è§£é‡Š**ï¼šæ¯æ¬¡æœ‰æ–°ä»£ç æ›´æ–°åˆ°ä¸»åˆ†æ”¯æ—¶ï¼Œä¼šè§¦å‘ GitHub Actionï¼Œ`gh-pages` å·¥å…·ä¼šè‡ªåŠ¨æ‰“åŒ…å¹¶å‘å¸ƒåˆ° `gh-pages` åˆ†æ”¯ï¼Œä»¥ä¾¿è®©æºç å’Œæ‰“åŒ…ä»£ç åŒºåˆ†å¼€æ¥ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ `GITHUB_TOKEN` è¢«æˆæƒä¸ºè¯»å†™æƒé™ã€‚

![GitHub Token æƒé™è®¾ç½®](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/react/20241022214856.png)

ç„¶ååœ¨ GitHub çš„è®¾ç½®ä¸­ï¼Œé€‰æ‹© `gh-pages` åˆ†æ”¯ä½œä¸ºç½‘ç«™æ„å»ºåˆ†æ”¯ã€‚

![è®¾ç½®æ„å»ºåˆ†æ”¯](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/react/d320e499c3664a95b3a843206dfe025b%7Etplv-k3u1fbpfcp-zoom-in-crop-mark_1512_0_0_0.webp)

### è‡ªå®šä¹‰åŸŸå

1. **æ²¡æœ‰åŸŸåçš„è¯å…ˆå»ç”³è¯·ä¸€ä¸ªåŸŸå**

   è´­ä¹°å®Œæˆä¹‹åä¸ç”¨å¤‡æ¡ˆï¼Œç›´æ¥è¿›è¡ŒåŸŸåè§£æã€‚

2. **åŸŸåè§£æ**

   ![åŸŸåè§£æ](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/react/20241110144929.png)

3. **é¡¹ç›®è®¾ç½®**

   - ä¿®æ”¹ `.dumirc.ts` ä¸­çš„ `base` å’Œ `publicPath` ä¸º `/`ã€‚
   - ä¿®æ”¹ `.github/workflows/gh-pages.yml` æ–‡ä»¶

   ```yaml
   name: github pages

   on:
     push:
       branches:
         - main # default branch

   jobs:
     deploy:
       runs-on: ubuntu-latest
       steps:
         - name: Checkout
           uses: actions/checkout@v3
           with:
             fetch-depth: 0
         - name: Install dependencies
           run: npm install
         - name: Build with dumi
           run: npm run docs:build
         - name: Create CNAME file
           run: echo "blog.chuenwei.cyou" > ./docs-dist/CNAME
         - name: Deploy
           uses: peaceiris/actions-gh-pages@v3
           with:
             github_token: ${{ secrets.GITHUB_TOKEN }}
             publish_dir: ./docs-dist
   ```
