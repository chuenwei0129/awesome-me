<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Engineering Spec Sheet - Updated</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
      MathJax = {
        tex: {
          inlineMath: [
            ['$', '$'],
            ['\\(', '\\)'],
          ],
          displayMath: [['$$', '$$']],
        },
        svg: { fontCache: 'global' },
      };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

    <style>
      :root {
        /* Palette - Strict & Cold */
        --bg-outer: #f1f5f9; /* Slate-100 */
        --bg-paper: #ffffff; /* White */
        --ink-primary: #0f172a; /* Slate-900 (High Contrast) */
        --ink-secondary: #475569; /* Slate-600 */
        --border-heavy: #0f172a; /* 2px Solid Black */
        --border-light: #cbd5e1; /* 1px Slate-300 */

        --f-sans: 'Inter', sans-serif;
        --f-mono: 'JetBrains Mono', monospace;
      }

      /* RESET */
      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        padding: 40px;
        background-color: var(--bg-outer);
        color: var(--ink-primary);
        font-family: var(--f-sans);
        display: flex;
        justify-content: center;
        min-height: 100vh;
      }

      /* --- BLOCK: Spec Sheet --- */
      .spec-sheet {
        width: 100%;
        max-width: 1024px;
        background: var(--bg-paper);
        border: 2px solid var(--border-heavy);
        position: relative;
        display: grid;
        grid-template-rows: auto 1fr auto;
        box-shadow: 0 0 0 10px rgba(0, 0, 0, 0.02);
      }

      .spec-sheet::before {
        content: 'SCALE 1:1';
        position: absolute;
        top: -25px;
        right: 0;
        font-family: var(--f-mono);
        font-size: 10px;
        color: var(--ink-secondary);
        letter-spacing: 2px;
      }

      /* --- ELEMENT: Decorative Marks (BEM) --- */
      .spec-sheet__mark {
        position: absolute;
        width: 20px;
        height: 20px;
        border: 1px solid var(--ink-primary);
        z-index: 10;
      }

      .spec-sheet__mark--tl {
        top: -1px;
        left: -1px;
        border-right: none;
        border-bottom: none;
      }

      .spec-sheet__mark--tr {
        top: -1px;
        right: -1px;
        border-left: none;
        border-bottom: none;
      }

      .spec-sheet__mark--bl {
        bottom: -1px;
        left: -1px;
        border-right: none;
        border-top: none;
      }

      .spec-sheet__mark--br {
        bottom: -1px;
        right: -1px;
        border-left: none;
        border-top: none;
      }

      /* --- ELEMENT: Header --- */
      .spec-sheet__header {
        display: grid;
        grid-template-columns: 1fr 200px;
        border-bottom: 2px solid var(--border-heavy);
      }

      /* --- ELEMENT: Title Group --- */
      .spec-sheet__title-group {
        padding: 24px;
        border-right: 1px solid var(--border-light);
      }

      .spec-sheet__main-title {
        margin: 0;
        font-family: var(--f-sans);
        font-weight: 900;
        text-transform: uppercase;
        font-size: 24px;
        line-height: 1.1;
        letter-spacing: -0.5px;
      }

      .spec-sheet__subtitle {
        font-family: var(--f-mono);
        font-size: 12px;
        color: var(--ink-secondary);
        margin-top: 8px;
        display: block;
      }

      /* --- ELEMENT: Meta Info --- */
      .spec-sheet__meta {
        display: grid;
        grid-template-rows: repeat(4, 1fr); /* Changed to 4 rows */
        font-family: var(--f-mono);
        font-size: 11px;
      }

      .spec-sheet__meta-item {
        border-bottom: 1px solid var(--border-light);
        padding: 4px 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .spec-sheet__meta-item:last-child {
        border-bottom: none;
      }

      .spec-sheet__meta-label {
        color: var(--ink-secondary);
        font-weight: 700;
        margin-right: 8px;
      }

      /* --- ELEMENT: Content --- */
      .spec-sheet__content {
        padding: 40px;
        font-size: 15px;
        line-height: 1.6;
      }

      /* --- ELEMENT: Footer --- */
      .spec-sheet__footer {
        border-top: 2px solid var(--border-heavy);
        padding: 12px 24px;
        display: flex;
        justify-content: space-between;
        font-family: var(--f-mono);
        font-size: 10px;
        text-transform: uppercase;
        background: #f8fafc;
      }

      /* --- MARKDOWN CONTENT STYLES (Scoped to Content) --- */

      /* Headings */
      .spec-sheet__content h1,
      .spec-sheet__content h2,
      .spec-sheet__content h3,
      .spec-sheet__content h4,
      .spec-sheet__content h5,
      .spec-sheet__content h6 {
        font-family: var(--f-sans);
        color: var(--ink-primary);
        text-transform: uppercase;
        letter-spacing: 0.02em;
        margin-top: 2em;
        margin-bottom: 1em;
      }

      .spec-sheet__content h1 {
        font-size: 20px;
        border-bottom: 3px solid var(--ink-primary);
        padding-bottom: 10px;
      }

      .spec-sheet__content h2 {
        font-size: 16px;
        font-weight: 900;
        border-bottom: 2px solid var(--ink-primary);
        padding-bottom: 8px;
        display: flex;
        align-items: center;
      }
      .spec-sheet__content h2::before {
        content: '//';
        margin-right: 8px;
        color: var(--ink-secondary);
        font-family: var(--f-mono);
      }

      .spec-sheet__content h3 {
        font-size: 14px;
        font-weight: 700;
        font-family: var(--f-mono);
      }
      .spec-sheet__content h3::before {
        content: '>> ';
        color: var(--ink-secondary);
      }

      .spec-sheet__content h4 {
        font-size: 13px;
        font-weight: 600;
        text-decoration: underline;
      }

      /* Text Elements */
      .spec-sheet__content p {
        margin-bottom: 1.2em;
        text-align: justify;
      }
      .spec-sheet__content strong {
        font-weight: 900;
        color: var(--ink-primary);
      }
      .spec-sheet__content em {
        font-style: italic;
        color: var(--ink-secondary);
      }
      .spec-sheet__content del {
        text-decoration: line-through;
        opacity: 0.6;
      }
      .spec-sheet__content a {
        color: var(--ink-primary);
        text-decoration: underline;
        font-weight: 600;
        transition: opacity 0.2s;
      }
      .spec-sheet__content a:hover {
        opacity: 0.7;
      }

      /* Lists */
      .spec-sheet__content ul,
      .spec-sheet__content ol {
        padding-left: 20px;
        margin-bottom: 24px;
      }
      .spec-sheet__content ul {
        list-style: none;
      }
      .spec-sheet__content ul li::before {
        content: '■';
        font-size: 8px;
        margin-right: 12px;
        position: relative;
        top: -2px;
        color: var(--ink-secondary);
      }
      .spec-sheet__content ol {
        font-family: var(--f-mono);
        list-style-type: decimal-leading-zero;
      }
      .spec-sheet__content li {
        margin-bottom: 8px;
      }

      /* Task List specific */
      .spec-sheet__content ul.contains-task-list {
        list-style: none;
        padding-left: 0;
      }
      .spec-sheet__content ul.contains-task-list li::before {
        content: none;
      }
      .spec-sheet__content input[type='checkbox'] {
        margin-right: 10px;
        accent-color: var(--ink-primary);
      }

      /* Code Blocks */
      .spec-sheet__content pre {
        background: #f8fafc;
        border: 1px solid var(--ink-primary);
        padding: 16px;
        font-family: var(--f-mono);
        font-size: 13px;
        overflow-x: auto;
        margin: 24px 0;
        position: relative;
      }
      .spec-sheet__content pre::after {
        content: 'EXEC_BLOCK';
        position: absolute;
        top: 0;
        right: 0;
        background: var(--ink-primary);
        color: white;
        font-size: 9px;
        padding: 2px 6px;
      }
      .spec-sheet__content code {
        font-family: var(--f-mono);
      }
      .spec-sheet__content p code,
      .spec-sheet__content li code {
        background: #f1f5f9;
        border: 1px solid var(--border-light);
        padding: 2px 4px;
        font-size: 0.9em;
        border-radius: 2px;
      }

      /* Tables */
      .spec-sheet__content table {
        width: 100%;
        border-collapse: collapse;
        font-family: var(--f-mono);
        font-size: 13px;
        margin: 24px 0;
        border: 1px solid var(--ink-primary);
      }
      .spec-sheet__content th,
      .spec-sheet__content td {
        border: 1px solid var(--border-light);
        padding: 10px 12px;
        text-align: left;
      }
      .spec-sheet__content th {
        background: #f1f5f9;
        border-bottom: 1px solid var(--ink-primary);
        font-weight: 700;
        text-transform: uppercase;
      }

      /* Mermaid */
      .mermaid {
        background: white;
        border: 1px dashed var(--ink-secondary);
        padding: 20px;
        margin: 24px 0;
        display: flex;
        justify-content: center;
      }

      /* Quotes */
      .spec-sheet__content blockquote {
        border-left: 4px solid var(--ink-primary);
        margin: 24px 0;
        padding: 8px 24px;
        background: #f8fafc;
        font-family: var(--f-mono);
        font-size: 13px;
        color: var(--ink-secondary);
      }

      /* Utils */
      .spec-sheet__content hr {
        border: 0;
        border-top: 1px dashed var(--border-light);
        margin: 40px 0;
      }

      @media (max-width: 768px) {
        body {
          padding: 10px;
        }
        .spec-sheet {
          border-width: 1px;
        }
        .spec-sheet__header {
          grid-template-columns: 1fr;
        }
        .spec-sheet__content {
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="spec-sheet">
      <!-- Corner Marks -->
      <div class="spec-sheet__mark spec-sheet__mark--tl"></div>
      <div class="spec-sheet__mark spec-sheet__mark--tr"></div>
      <div class="spec-sheet__mark spec-sheet__mark--bl"></div>
      <div class="spec-sheet__mark spec-sheet__mark--br"></div>

      <!-- Header Block -->
      <header class="spec-sheet__header">
        <div class="spec-sheet__title-group">
          <!-- ID added for JS injection of time -->
          <h1 id="dynamic-title" class="spec-sheet__main-title">
            LOADING_TIMESTAMP...
          </h1>
          <span class="spec-sheet__subtitle"
            >PROJECT: NEURAL_LINK_V2 // CONFIDENTIAL</span
          >
        </div>
        <div class="spec-sheet__meta">
          <!-- 4 Meta Items -->
          <div class="spec-sheet__meta-item">
            <span class="spec-sheet__meta-label">DOC_ID</span>
            <span>SPEC-8842</span>
          </div>
          <div class="spec-sheet__meta-item">
            <span class="spec-sheet__meta-label">DATE</span>
            <span id="date-display">2023-10-27</span>
          </div>
          <div class="spec-sheet__meta-item">
            <span class="spec-sheet__meta-label">REV</span>
            <span>1.0.4 RC</span>
          </div>
          <div class="spec-sheet__meta-item">
            <span class="spec-sheet__meta-label">STATUS</span>
            <span>APPROVED</span>
          </div>
        </div>
      </header>

      <!-- Main Content -->
      <div id="markdown-output" class="spec-sheet__content">
        <!-- Content injected via JS -->
      </div>

      <!-- Footer Block -->
      <footer class="spec-sheet__footer">
        <span>Generated by System Renderer</span>
        <span>Page 1 of 1</span>
        <span>Approved for Engineering Use</span>
      </footer>
    </div>

    <!-- DATA SOURCE -->
    <script>
      const markdownSource = `
## 01. Typographic Standards

This section demonstrates the full range of text formatting available in the renderer.

### Text Styles
Primary logic is defined by **bold declarations**, while secondary logic uses *italicized contexts*.
Deprecations are marked with ~~strikethrough~~ syntax.
Variable inline references look like \`const x = 1\`.
External references: [System Manual v2.0](https://example.com).

### Blockquote Protocol
> **CRITICAL WARNING:** Direct memory access (DMA) is disabled by default. 
> Ensure secure kernel flag \`--unsafe-dma\` is active before override.

---

## 02. Lists & Organization

### Unordered List (Components)
*   **Sensor Array**: 64-bit precision input.
*   **Processing Unit**: Neural core v5.
*   **Output**: Holographic projection buffer.

### Ordered List (Initialization Sequence)
1.  Power on self-test (POST).
2.  Load kernel modules.
3.  Mount file systems.
4.  Initiate signal handshake.

### Task List (Deployment Status)
- [x] Hardware verification
- [x] Firmware update (v1.0.4)
- [ ] Field calibration
- [ ] User sign-off

---

## 03. Visual Logic (Mermaid)

The following diagram illustrates the signal processing flow. Note the orthogonal routing.

\`\`\`mermaid
flowchart TD
    A[INPUT_SENSOR] -->|Raw Data| B(Pre-Processor)
    B --> C{Signal Valid?}
    C -->|YES| D[Core_Logic_Unit]
    C -->|NO| E[Error_Handler]
    D --> F[Output_Buffer]
    E --> F
    F --> G[Render_Engine]
    style A fill:#fff,stroke:#0f172a,stroke-width:2px
    style B fill:#fff,stroke:#0f172a,stroke-width:1px
    style C fill:#fff,stroke:#0f172a,stroke-width:1px
    style D fill:#fff,stroke:#0f172a,stroke-width:1px
    style E fill:#f1f5f9,stroke:#0f172a,stroke-width:1px,stroke-dasharray: 5 5
    style F fill:#fff,stroke:#0f172a,stroke-width:1px
    style G fill:#0f172a,stroke:#0f172a,stroke-width:1px,color:#fff
    linkStyle default stroke:#0f172a,stroke-width:1px,fill:none;
\`\`\`

---

## 04. Physics Calculation (LaTeX)

Energy dissipation is calculated using the integrated surface integral:

$$
\\oint_S \\mathbf{E} \\cdot d\\mathbf{A} = \\frac{Q_{enc}}{\\varepsilon_0}
$$

Matrix transformation for the 3D projection vector $V_{proj}$:

$$
\\begin{bmatrix} x' \\\\ y' \\\\ z' \\end{bmatrix} = 
\\begin{bmatrix} 
\\cos \\theta & -\\sin \\theta & 0 \\\\ 
\\sin \\theta & \\cos \\theta & 0 \\\\ 
0 & 0 & 1 
\\end{bmatrix} 
\\begin{bmatrix} x \\\\ y \\\\ z \\end{bmatrix}
$$

---

## 05. Data Structures

The standard packet format for transmission (Big Endian):

| Byte Offset | Field Name | Data Type | Description |
| :--- | :--- | :--- | :--- |
| 0x00 | \`PKT_HEADER\` | UINT32 | Magic number (0xDEADBEEF) |
| 0x04 | \`PAYLOAD_LEN\` | UINT16 | Length of data payload |
| 0x06 | \`CMD_ID\` | UINT8 | Command Instruction Code |
| 0x07 | \`CHECKSUM\` | UINT8 | XOR Checksum |

---

## 06. Implementation Code

\`\`\`rust
fn initialize_kernel() -> Result<(), KernelError> {
    let config = SystemConfig::load("/etc/sys_config.toml")?;

    // Establishing secure handshake
    if !config.verify_signature() {
        return Err(KernelError::SecurityViolation);
    }

    println!(">> System Initialized at address: {:p}", &config);
    Ok(())
}
\`\`\`
`;

      // --- RENDERING ENGINE ---
      document.addEventListener('DOMContentLoaded', () => {
        const now = new Date();

        // 1. Set Title to Current Update Time
        const timeString = now.toLocaleString('zh-CN', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit',
          hour12: false,
        });
        document.getElementById('dynamic-title').textContent =
          '更新时间: ' + timeString;

        // 2. Set Meta Date
        document.getElementById('date-display').textContent = now
          .toISOString()
          .split('T')[0];

        // 3. Mermaid Config
        mermaid.initialize({
          startOnLoad: false,
          flowchart: {
            curve: 'step' /* Orthogonal lines */,
            htmlLabels: true,
          },
          theme: 'base',
          themeVariables: {
            primaryColor: '#ffffff',
            primaryTextColor: '#0f172a',
            primaryBorderColor: '#0f172a',
            lineColor: '#0f172a',
            secondaryColor: '#f8fafc',
            tertiaryColor: '#ffffff',
            fontFamily: 'JetBrains Mono',
          },
        });

        // 4. Marked Config
        const renderer = new marked.Renderer();

        // Custom Code Block Renderer
        renderer.code = (code, lang) => {
          if (lang === 'mermaid') {
            return `<div class="mermaid">${code}</div>`;
          }
          return `<pre><code class="language-${lang}">${code}</code></pre>`;
        };

        // Custom Table Renderer
        renderer.table = (header, body) => {
          return `
            <table>
                <thead>${header}</thead>
                <tbody>${body}</tbody>
            </table>
          `;
        };

        // 5. Render
        const output = document.getElementById('markdown-output');
        output.innerHTML = marked.parse(markdownSource, { renderer: renderer });

        // 6. Trigger Diagram Render
        mermaid.run({ querySelector: '.mermaid' });

        // 7. Trigger MathJax
        if (window.MathJax) MathJax.typesetPromise();
      });
    </script>
  </body>
</html>
