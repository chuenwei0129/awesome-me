---
group:
  title: tools
  order: 5
title: git
toc: content
---

# ğŸ“˜ ä½¿ç”¨ SSH æäº¤ Git ä»£ç ï¼šä»åŸç†åˆ°å®æˆ˜ï¼ˆè¶…è¯¦ç»†æŒ‡å—ï¼‰

Git æ”¯æŒä¸¤ç§å¸¸è§çš„è¿œç¨‹è¿æ¥æ–¹å¼ï¼š**HTTPS** å’Œ **SSH**ã€‚

æ— è®ºä½ ä½¿ç”¨ GitHubã€GitLabã€Giteeã€Bitbucketï¼Œéƒ½å‡ ä¹å®Œå…¨ä¸€è‡´ã€‚

éšç€ä¼ä¸šå®‰å…¨è¦æ±‚ä¸æ–­æé«˜ã€GitHub å¯¹ token çš„å…¨é¢æ¨è¡Œï¼Œ**ä½¿ç”¨ SSH è¿›è¡Œ Git æ“ä½œå·²ç»æˆä¸ºç°ä»£å›¢é˜Ÿçš„ä¸»æµé€‰æ‹©**ã€‚

ç„¶è€Œè®¸å¤šå¼€å‘è€…åœ¨ä½¿ç”¨ SSH æ—¶ä¼šé‡åˆ°å„ç§é—®é¢˜ï¼š

- â€œPermission denied (publickey)â€
- â€œno mutual signature supportedâ€
- â€œHost key verification failedâ€
- Mac ç¦ç”¨äº† ssh-rsa æ€ä¹ˆåŠï¼Ÿ
- å¤šä¸ª GitHub è´¦å·å¦‚ä½•åˆ‡æ¢ï¼Ÿ
- æ€æ ·é¿å…æ¯æ¬¡è¾“å¯†ç ï¼Ÿ

æœ¬ç¯‡æ–‡ç« å°†ä» **åŸç† â†’ é…ç½® â†’ å®æˆ˜ â†’ å¤šè´¦å· â†’ æ’é”™** ç”¨æœ€æ¸…æ™°çš„æ–¹å¼å¸¦ä½ å®Œå…¨ææ‡‚ SSHã€‚

---

# ğŸ¯ é€‚åˆé˜…è¯»çš„äºº

- Git æ–°æ‰‹ï¼Œæƒ³å…å¯†ç æäº¤ä»£ç 
- ä½¿ç”¨ HTTPS å¸¸å¸¸å› ä¸ºå¯†ç /token çš„é—®é¢˜æ„Ÿåˆ°éº»çƒ¦
- æƒ³ææ‡‚ SSH çš„çœŸå®å·¥ä½œåŸç†
- æœ‰å¤šå¥— GitHub/GitLab è´¦å·
- ç»å¸¸é‡åˆ° SSH è¿æ¥å¤±è´¥ç­‰æŠ¥é”™
- macOS ç”¨æˆ·é‡åˆ° â€œxxxx no mutual signatureâ€ é—®é¢˜

---

# ğŸ“Œ ç›®å½•

1. [ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ SSHï¼Ÿ](#ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨-ssh)
2. [SSH æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ˆå›¾è§£ï¼‰](#ssh-æ˜¯å¦‚ä½•å·¥ä½œçš„å›¾è§£)
3. [ç”Ÿæˆ SSH Keyï¼ˆmacOS / Windows / Linuxï¼‰](#ç”Ÿæˆ-ssh-keymacos--windows--linux)
4. [æŠŠå…¬é’¥æ·»åŠ åˆ° GitHub](#æŠŠå…¬é’¥æ·»åŠ åˆ°-github)
5. [é…ç½® SSHï¼ˆssh-agent + ssh-configï¼‰](#é…ç½®-sshssh-agent--ssh-config)
6. [æµ‹è¯• SSH æ˜¯å¦æˆåŠŸ](#æµ‹è¯•-ssh-æ˜¯å¦æˆåŠŸ)
7. [å¤šè´¦å·ã€å¤šä»“åº“ SSH é…ç½®æ–¹æ¡ˆ](#å¤šè´¦å·å¤šä»“åº“-ssh-é…ç½®æ–¹æ¡ˆ)
8. [å¸¸è§é”™è¯¯ä¸å®Œæ•´è§£å†³æ–¹æ¡ˆ](#å¸¸è§é”™è¯¯ä¸å®Œæ•´è§£å†³æ–¹æ¡ˆ)
9. [æœ€ä½³å®è·µæ€»ç»“](#æœ€ä½³å®è·µæ€»ç»“)

---

# 1. ä¸ºä»€ä¹ˆæ¨èä½¿ç”¨ SSHï¼Ÿ

å…ˆæ¥çœ‹æœ€é‡è¦çš„é—®é¢˜ï¼š**ä¸ºä»€ä¹ˆä½ åº”è¯¥ç”¨ SSH è€Œä¸æ˜¯ HTTPSï¼Ÿ**

## ğŸ”’ HTTPS çš„é—®é¢˜

- éœ€è¦è¾“å…¥è´¦å·å¯†ç 
- 2021 ä»¥å GitHub ç¦æ­¢å¯†ç ï¼Œå¿…é¡»ä½¿ç”¨ **Personal Access Token**
- token ä¼šè¿‡æœŸã€è¢« revokeï¼Œå¾ˆéº»çƒ¦
- å¤šè´¦å·æéš¾ç®¡ç†

## ğŸ”‘ SSH çš„ä¼˜åŠ¿

### âœ” 1. å®Œå…¨å…å¯†ç 

ä½ ç”Ÿæˆå¯†é’¥åï¼Œpush/pull ä¸éœ€è¦å†è¾“å…¥ä»»ä½•å¯†ç ã€‚

### âœ” 2. å®‰å…¨æ€§æ›´é«˜

ç§é’¥ç•™åœ¨æœ¬æœºï¼Œä¸ä¼šä¸Šä¼ æˆ–æ³„éœ²ã€‚
GitHub åªä¿å­˜ä½ çš„å…¬é’¥ï¼Œå¤–æ³„ä¹Ÿæ²¡é£é™©ã€‚

### âœ” 3. æ”¯æŒå¤šè´¦å·

ä½ å¯ä»¥ä¸ºå…¬å¸è´¦å·ã€ä¸ªäººè´¦å·åˆ›å»ºå¤šæŠŠ keyï¼Œäº’ä¸å½±å“ã€‚

### âœ” 4. æ”¯æŒè‡ªåŠ¨åŠ è½½

æ­é… ssh-agent + config å¯ä¸€åŠ³æ°¸é€¸ã€‚

ğŸ‘‰ **SSH æ˜¯ç°ä»£ Git æ“ä½œçš„æœ€ä½³å®è·µã€‚**

---

# 2. SSH æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ˆå›¾è§£ï¼‰

è¿™æ˜¯æœ€å®¹æ˜“è¢«å¿½ç•¥ä½†åˆæœ€é‡è¦çš„éƒ¨åˆ†ã€‚

---

## ğŸ§  æ ¸å¿ƒåŸç†ï¼ˆéå¸¸ç®€å•ï¼‰

SSH è®¤è¯åŸºäºï¼š

- **ç§é’¥ï¼ˆprivate keyï¼‰**ï¼šä¿å­˜åœ¨ä½ ç”µè„‘æœ¬åœ°
- **å…¬é’¥ï¼ˆpublic keyï¼‰**ï¼šæ”¾åœ¨ GitHub/GitLab è´¦å·é‡Œ

å½“ä½ æ‰§è¡Œï¼š

```
git push
```

GitHub ä¼šè¦æ±‚ä½ è¯æ˜â€œä½ æ‹¥æœ‰å¯¹åº”çš„ç§é’¥â€ã€‚

SSH ä¼šåšä»€ä¹ˆï¼Ÿ

1. GitHub æ‰¾åˆ°ä½ ä¸Šä¼ è¿‡çš„å…¬é’¥
2. GitHub å‘ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ï¼Œè®©ä½ ç”¨ **ç§é’¥ç­¾å**
3. GitHub ç”¨å…¬é’¥éªŒè¯ç­¾å
4. å¦‚æœåŒ¹é… â†’ ä½ å°±æ˜¯å¯†é’¥æŒæœ‰è€… â†’ æˆæƒæˆåŠŸ

ğŸ‘‰ **SSH ä¸è¯†åˆ«ä½ çš„æœºå™¨ï¼Œä¸è¯†åˆ«ä½ çš„è´¦å·ï¼ŒåªéªŒè¯â€œä½ æ˜¯å¦æ‹¥æœ‰è¯¥ç§é’¥â€ã€‚**

---

# 3. ç”Ÿæˆ SSH Keyï¼ˆmacOS / Windows / Linuxï¼‰

å»ºè®®ä½¿ç”¨ **ed25519**ï¼ˆå®‰å…¨ã€çŸ­ã€ç°ä»£ç®—æ³•ï¼‰ã€‚

## macOS / Linux

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

æŒ‰å›è½¦å³å¯ã€‚

å®ƒä¼šåœ¨ï¼š

```
~/.ssh/id_ed25519
~/.ssh/id_ed25519.pub
```

ç”Ÿæˆç§é’¥å’Œå…¬é’¥ã€‚

---

## Windowsï¼ˆGit Bashï¼‰

æ‰“å¼€ Git Bashï¼š

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
```

è·¯å¾„åŒæ ·æ˜¯ `~/.ssh/` ä¸‹ã€‚

---

# 4. æŠŠå…¬é’¥æ·»åŠ åˆ° GitHub

## 1. å¤åˆ¶å…¬é’¥å†…å®¹

```bash
cat ~/.ssh/id_ed25519.pub
```

å¤åˆ¶å‡ºæ¥ï¼ˆä» `ssh-ed25519` å¼€å¤´ï¼‰ã€‚

## 2. æ‰“å¼€ GitHub â†’ Settings â†’ SSH and GPG Keys

æ·»åŠ ä¸€ä¸ªæ–°çš„ SSH keyã€‚

å°±è¿™äº›ã€‚

---

# 5. é…ç½® SSHï¼ˆssh-agent + ssh-configï¼‰

## âœ” 1. å¯åŠ¨ ssh-agent

macOSï¼š

```bash
eval "$(ssh-agent -s)"
```

## âœ” 2. æ·»åŠ ç§é’¥åˆ° ssh-agent

```bash
ssh-add ~/.ssh/id_ed25519
```

ğŸ‘‰ ä»æ­¤æ— éœ€æ¯æ¬¡éƒ½è¾“å…¥å¯†ç ã€‚

---

## âœ” 3. é…ç½® ~/.ssh/configï¼ˆæ¨èå¿…åšï¼‰

ç¼–è¾‘æ–‡ä»¶ï¼š

```bash
nano ~/.ssh/config
```

å†™å…¥ï¼š

```
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_ed25519
    AddKeysToAgent yes
```

ä½œç”¨ï¼š

- æŒ‡å®š GitHub é»˜è®¤ä½¿ç”¨ id_ed25519
- è‡ªåŠ¨ä½œ agent
- å¤šè´¦å·æ—¶å¯ä»¥è¦†ç›– Host åç§°ï¼ˆè§åæ–‡ï¼‰

---

# 6. æµ‹è¯• SSH æ˜¯å¦æˆåŠŸ

ç›´æ¥è¿è¡Œï¼š

```bash
ssh -T git@github.com
```

è¾“å‡ºç±»ä¼¼ï¼š

```
Hi username! You've successfully authenticated, but GitHub does not provide shell access.
```

ğŸ‰ å®Œæˆï¼

---

# 7. å¤šè´¦å·/å¤šä»“åº“ SSH é…ç½®æ–¹æ¡ˆ

è¿™æ˜¯å¼€å‘è€…æœ€å›°æ‰°çš„é—®é¢˜ã€‚ä¸‹é¢ç»™ä½  **æ ‡å‡†å¯ç”¨çš„æœ€ä½³è§£æ³•**ã€‚

---

## ğŸ¯ åœºæ™¯ï¼šä½ æœ‰ä¸¤ä¸ªè´¦å·

- ä¸ªäºº GitHubï¼š`id_ed25519_personal`
- å…¬å¸ GitHubï¼š`id_ed25519_work`

## 1. ç”Ÿæˆä¸¤æŠŠ key

```bash
ssh-keygen -t ed25519 -f ~/.ssh/id_ed25519_personal -C "you@gmail.com"
ssh-keygen -t ed25519 -f ~/.ssh/id_ed25519_work -C "you@company.com"
```

## 2. ~/.ssh/config é…ç½®

```
# Personal
Host github.com
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_ed25519_personal

# Company
Host github-company
    HostName github.com
    User git
    IdentityFile ~/.ssh/id_ed25519_work
```

## 3. å…‹éš†ä»“åº“æ—¶ä½¿ç”¨ä¸åŒ Host

ä¸ªäººä»“åº“ï¼š

```bash
git clone git@github.com:username/repo.git
```

å…¬å¸ä»“åº“ï¼š

```bash
git clone git@github-company:company/repo.git
```

ğŸ‘‰ é€šè¿‡åˆ‡æ¢ Host å®ç°å¤šè´¦å·éš”ç¦»ï¼Œæ— å†²çªã€æ— å¯†ç ã€æœ€ç¨³å®šã€‚

---

# 8. å¸¸è§é”™è¯¯ä¸å®Œæ•´è§£å†³æ–¹æ¡ˆ

ä¸‹é¢æ˜¯å¼€å‘è€…æœ€å¸¸è§çš„ SSH æŠ¥é”™ã€‚

---

## âŒ 1. Permission denied (publickey)

åŸå› ï¼š

- å…¬é’¥æ²¡åŠ åˆ° GitHub
- config å†™é”™
- key æ²¡åŠ åˆ° agent
- æƒé™ä¸å¯¹ï¼ˆmacOS å¸¸è§ï¼‰

è§£å†³ï¼š

```bash
chmod 600 ~/.ssh/id_ed25519
chmod 700 ~/.ssh
ssh-add ~/.ssh/id_ed25519
```

---

## âŒ 2. macOS â€œno mutual signature algorithmâ€

ä» macOS Ventura å¼€å§‹ç¦ç”¨ ssh-rsaã€‚

**ä¸è¦å¯ç”¨è€æ—§ ssh-rsaï¼**

æ­£ç¡®è§£å†³æ–¹æ³•ï¼š

ğŸ‘‰ **é‡æ–°ç”Ÿæˆ ed25519 key**ï¼ˆæœ€å®‰å…¨ï¼‰

```bash
ssh-keygen -t ed25519 -C "your_email"
```

---

## âŒ 3. Host key verification failed

åŸå› ï¼šGitHub çš„æœåŠ¡å™¨ key å˜åŒ–ï¼ˆæˆ–ä½ é¦–æ¬¡è¿æ¥ï¼‰ã€‚

è§£å†³ï¼š

```bash
ssh-keygen -R github.com
ssh -T git@github.com
```

---

# 9. æœ€ä½³å®è·µæ€»ç»“

âœ” ä¼˜å…ˆä½¿ç”¨ `ed25519`
âœ” ä½¿ç”¨ `ssh-agent` è‡ªåŠ¨åŠ è½½ç§é’¥
âœ” å§‹ç»ˆé…ç½® `~/.ssh/config`
âœ” å¤šè´¦å·ä½¿ç”¨å¤šä¸ª Hostï¼ˆgithub & github-companyï¼‰
âœ” ä¸è¦å†ä½¿ç”¨ HTTPS + tokenï¼ˆç¹ç & å®¹æ˜“è¿‡æœŸï¼‰
âœ” é‡åˆ° macOS ç­¾åæŠ¥é”™ â†’ ç”¨ ED25519 é‡å»º key


