---
title: JWT
order: 3
toc: content
group:
  title: WEB
---

## ä¸ºä»€ä¹ˆé€‰æ‹© JWT Token è®¤è¯æœºåˆ¶ï¼Ÿ ğŸ¤”

åœ¨ä¹‹å‰æ¢è®¨çš„ Session è®¤è¯æœºåˆ¶ä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°é€šè¿‡æœåŠ¡ç«¯å…±äº«çš„ session å¯ä»¥å®ç°ç”¨æˆ·èº«ä»½çš„ç¡®è®¤ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€å®šçš„å±€é™æ€§ï¼Œæ¯”å¦‚éœ€è¦æ­å»ºä¸€ä¸ªä¸“é—¨çš„ Redis é›†ç¾¤æ¥å­˜å‚¨ session ä¿¡æ¯ã€‚å¯¹äºä¸€äº›å¤§å‹ä¼ä¸šè€Œè¨€ï¼Œä½¿ç”¨ Redis æ˜¯æ—¥å¸¸æ“ä½œï¼Œä½†å¯¹äºè§„æ¨¡è¾ƒå°çš„å…¬å¸ï¼Œå¯èƒ½ä»–ä»¬çš„ä¸šåŠ¡é‡è¿˜æ²¡æœ‰åˆ°è¾¾éå¾—ä½¿ç”¨ Redis çš„ç¨‹åº¦ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æœºåˆ¶å¯ä»¥ä¸ä¾èµ–äºæœåŠ¡ç«¯å­˜å‚¨ session æ¥éªŒè¯ç”¨æˆ·èº«ä»½å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯æœ¬æ–‡è¦ä»‹ç»çš„å…³é”®æŠ€æœ¯ï¼š**JWT Token**ã€‚

## JWT Token è®¤è¯çš„å·¥ä½œæµç¨‹ ğŸ”„

![Tokenè®¤è¯æµç¨‹ç¤ºæ„å›¾](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240419173603.png)

1. ç”¨æˆ·é€šè¿‡è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼ŒæœåŠ¡ç«¯åœ¨è®¤è¯æˆåŠŸåä¼šè¿”å›ä¸€ä¸ª JWT Token ç»™å®¢æˆ·ç«¯ã€‚
2. å®¢æˆ·ç«¯å°†è¿™ä¸ª JWT Token ä¿å­˜åœ¨æœ¬åœ°ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨ `localStorage` æˆ–è€… `cookie`ã€‚
3. å½“ç”¨æˆ·å°è¯•è®¿é—®ä¸€ä¸ªå—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºæ—¶ï¼Œä»–ä»¬éœ€è¦åœ¨è¯·æ±‚å¤´çš„ **Authorization** å­—æ®µä¸­æ·»åŠ  tokenï¼Œæ ¼å¼ä¸º `Authorization: Bearer <token>`ã€‚

æ‚¨å¯èƒ½å¯¹æ­¤æœ‰ä»¥ä¸‹ç–‘é—®ï¼š

- æ—¢ç„¶ token åªå­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼ŒæœåŠ¡ç«¯å¹¶æ²¡æœ‰å­˜å‚¨ï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥éšæ„æ„é€ ä¸€ä¸ª token å‘é€ç»™æœåŠ¡å™¨å‘¢ï¼Ÿ

  ç­”æ¡ˆæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæœåŠ¡å™¨ä¼šé€šè¿‡ä¸€å¥—æ ¡éªŒæœºåˆ¶æ¥éªŒè¯ token çš„åˆæ³•æ€§ã€‚

- ä¸åƒ session é‚£æ ·é€šè¿‡ sessionId æ¥ç¡®å®šç”¨æˆ·èº«ä»½ï¼Œé‚£ä¹ˆå¦‚ä½•ç¡®å®šæ˜¯å“ªä¸ªç”¨æˆ·å‘¢ï¼Ÿ

  å®é™…ä¸Šï¼Œtoken æœ¬èº«å¯ä»¥åŒ…å«ç”¨æˆ·ä¿¡æ¯ï¼Œé€šè¿‡è§£å¯†å°±èƒ½è·å–åˆ°ã€‚

## ä»€ä¹ˆæ˜¯ JWTï¼Ÿ ğŸ¥¸

> å‚è€ƒï¼š[JSON Web Token å…¥é—¨æ•™ç¨‹](https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html)

äº’è”ç½‘æœåŠ¡ç¦»ä¸å¼€ç”¨æˆ·è®¤è¯ã€‚

ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ session æ•°æ®æŒä¹…åŒ–ï¼Œå†™å…¥æ•°æ®åº“æˆ–åˆ«çš„æŒä¹…å±‚ã€‚å„ç§æœåŠ¡æ”¶åˆ°è¯·æ±‚åï¼Œéƒ½å‘æŒä¹…å±‚è¯·æ±‚æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯æ¶æ„æ¸…æ™°ï¼Œç¼ºç‚¹æ˜¯å·¥ç¨‹é‡æ¯”è¾ƒå¤§ã€‚å¦å¤–ï¼ŒæŒä¹…å±‚ä¸‡ä¸€æŒ‚äº†ï¼Œå°±ä¼šå¤±è´¥ã€‚

å¦ä¸€ç§æ–¹æ¡ˆæ˜¯æœåŠ¡å™¨ç´¢æ€§ä¸ä¿å­˜ session æ•°æ®äº†ï¼Œæ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å‘å›æœåŠ¡å™¨ã€‚JWT å°±æ˜¯è¿™ç§æ–¹æ¡ˆçš„ä¸€ä¸ªä»£è¡¨ã€‚

JWT çš„åŸç†æ˜¯ï¼ŒæœåŠ¡å™¨è®¤è¯ä»¥åï¼Œç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡ï¼Œå‘å›ç»™ç”¨æˆ·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚

```json
{
  "å§“å": "å¼ ä¸‰",
  "è§’è‰²": "ç®¡ç†å‘˜",
  "åˆ°æœŸæ—¶é—´": "2018å¹´7æœˆ1æ—¥0ç‚¹0åˆ†"
}
```

ä»¥åï¼Œç”¨æˆ·ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™ï¼Œéƒ½è¦å‘å›è¿™ä¸ª JSON å¯¹è±¡ã€‚æœåŠ¡å™¨å®Œå…¨åªé è¿™ä¸ªå¯¹è±¡è®¤å®šç”¨æˆ·èº«ä»½ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåŠ ä¸Šç­¾åã€‚

æœåŠ¡å™¨å°±ä¸ä¿å­˜ä»»ä½• session æ•°æ®äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡å™¨å˜æˆæ— çŠ¶æ€äº†ï¼Œä»è€Œæ¯”è¾ƒå®¹æ˜“å®ç°æ‰©å±•ã€‚

JWT ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š

```sh
Header.Payload.Signature
```

![JWTç»“æ„ç¤ºæ„å›¾](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240419202516.png)

1. **Header**ï¼šä¸€ä¸ª JSON å¯¹è±¡ï¼Œæè¿° JWT çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ç­¾åç®—æ³•ç­‰ä¿¡æ¯ã€‚
2. **Payload**ï¼šä¸€ä¸ª JSON å¯¹è±¡ï¼ŒåŒ…å«éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚ä¾‹å¦‚ç”¨æˆ· IDã€è§’è‰²ç­‰ã€‚
3. **Signature**ï¼šJWT çš„ç­¾åï¼Œç”¨äºéªŒè¯ token çš„åˆæ³•æ€§ï¼Œé˜²æ­¢æ•°æ®ç¯¡æ”¹ã€‚

## å¦‚ä½•ä½¿ç”¨ JWTï¼Ÿ ğŸš€

å¯åŠ¨åç«¯æœåŠ¡å™¨ï¼š

```bash
node server.mjs
```

åç«¯ä»£ç ï¼š

```js
import cors from 'cors';
import express from 'express';
import jwt from 'jsonwebtoken';

const app = express();
app.use(express.json());
app.use(cors());

const JWT_SECRET = 'your_jwt_secret_key';

// ç™»å½•è·¯ç”±
app.post('/login', (req, res) => {
  const { username, password } = req.body;

  // ç®€å•çš„ç”¨æˆ·é‰´å®šï¼ˆæ­¤å¤„çœç•¥æ•°æ®åº“å¤„ç†ï¼‰
  if (username && password) {
    const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });
    return res.json({ token });
  }

  res.status(401).json({ message: 'Invalid credentials' });
});

// éªŒè¯ä¸­é—´ä»¶
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];

  if (!token) return res.sendStatus(401);

  jwt.verify(token, JWT_SECRET, (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
};

// å—ä¿æŠ¤çš„è·¯ç”±
app.get('/protected', authenticateToken, (req, res) => {
  res.json({ message: 'This is a protected route', user: req.user });
});

app.listen(4396, () => {
  console.log('Server running on http://localhost:4396');
});
```

å‰ç«¯åº”ç”¨ï¼š

```tsx
import React, { useState } from 'react';

const Login: React.FC = () => {
  const [username, setUsername] = useState('');
  const [password, setPassword] = useState('');
  const [message, setMessage] = useState('');

  const handleLogin = async (event: React.FormEvent) => {
    event.preventDefault();
    try {
      const response = await fetch('http://localhost:4396/login', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ username, password }),
      });

      if (response.ok) {
        const data = await response.json();
        setMessage(`Login successful! Token: ${data.token}`);

        // ä½¿ç”¨ token è®¿é—®å—ä¿æŠ¤è·¯ç”±
        const protectedResponse = await fetch(
          'http://localhost:4396/protected',
          {
            headers: {
              Authorization: `Bearer ${data.token}`,
            },
          },
        );

        if (protectedResponse.ok) {
          const protectedData = await protectedResponse.json();
          console.log('ğŸš€ ~ handleLogin ~ protectedData:', protectedData);
        }
      } else {
        setMessage('Login failed');
      }
    } catch (error) {
      setMessage('An error occurred');
    }
  };

  return (
    <div>
      <form onSubmit={handleLogin} className="overflow-scroll">
        <h2>Login</h2>
        <input
          type="text"
          placeholder="Username"
          value={username}
          onChange={(e) => setUsername(e.target.value)}
        />
        <input
          type="password"
          placeholder="Password"
          value={password}
          onChange={(e) => setPassword(e.target.value)}
        />
        <button type="submit">Login</button>
        {message && <p className="text-wrap">{message}</p>}
      </form>
    </div>
  );
};

export default Login;
```

## æ³¨æ„äº‹é¡¹ âš ï¸

JWT çš„ä¼˜åŠ¿åœ¨äºï¼Œåªè¦æœåŠ¡å™¨çš„å¯†é’¥æ²¡æœ‰æ³„éœ²ï¼Œç”Ÿæˆçš„ token å°±æ˜¯å®‰å…¨çš„ã€‚å› ä¸ºå¦‚æœæœ‰äººè¯•å›¾ä¼ªé€  tokenï¼Œåœ¨ç­¾åéªŒè¯ç¯èŠ‚å°†æ— æ³•é€šè¿‡ï¼Œä»è€Œåˆ¤å®š token éæ³•ã€‚

é€šè¿‡ Token è®¤è¯ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°è§£å†³äº† token å¿…é¡»ä¿å­˜åœ¨æœåŠ¡å™¨çš„é—®é¢˜ï¼Œå®ç°äº†åˆ†å¸ƒå¼å­˜å‚¨ï¼ˆtoken ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼‰ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**ä¸€æ—¦ token è¢«æœåŠ¡å™¨ç”Ÿæˆï¼Œé™¤éè¿‡æœŸï¼Œå¦åˆ™æ— æ³•ä½¿å…¶å¤±æ•ˆ**ã€‚

è¿˜éœ€è¦ç•™æ„çš„æ˜¯ï¼š

- Token é€šå¸¸å­˜æ”¾åœ¨è¯·æ±‚å¤´çš„ **Authorization** å­—æ®µä¸­ï¼Œè€Œä¸æ˜¯ **Cookie**ã€‚
- JWT é»˜è®¤ä¸åŠ å¯†ï¼Œä½†å¯ä»¥è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚ç”ŸæˆåŸå§‹ Token åï¼Œå¯ä»¥ç”¨å¯†é’¥å†æ¬¡åŠ å¯†ã€‚
- å¦‚æœä¸åŠ å¯†ï¼Œä¸åº”å°†æ•æ„Ÿæ•°æ®å†™å…¥ JWTã€‚
- ä¸ºé˜²æ­¢ç›—ç”¨ï¼Œå»ºè®®ä¸é€šè¿‡ HTTP æ˜æ–‡ä¼ è¾“ JWTï¼Œè€Œåº”ä½¿ç”¨ **HTTPS** åè®®ã€‚

## ä¸ºä»€ä¹ˆ JWT ä¸€èˆ¬æ˜¯æ”¾åœ¨ header çš„ Authorization è‡ªå®šä¹‰å¤´é‡Œï¼Œè€Œä¸æ˜¯æ”¾åœ¨ Cookie é‡Œï¼Ÿ ğŸ§

- **è·¨ç«™è®¿é—®çš„é™åˆ¶**ï¼šCookie æœ¬èº«å…·å¤‡è·¨ç«™è®¿é—®çš„é™åˆ¶ï¼Œè¿™**æ„å‘³ç€ä¸åŒçš„ç½‘ç«™æ— æ³•å…±äº«åŒä¸€ä¸ª Cookie**ã€‚è¿™ä¸€ç‰¹æ€§ç»™å®ç°å¤šåº”ç”¨æˆ–å¤šç³»ç»Ÿé—´çš„å•ç‚¹ç™»å½• (SSO) å¸¦æ¥äº†æŒ‘æˆ˜ï¼Œå› ä¸ºå®ƒè¦æ±‚é‡‡å–é¢å¤–çš„ç­–ç•¥ä»¥å®ç°è·¨ç«™çš„è®¤è¯çŠ¶æ€å…±äº«ã€‚

- **ç§»åŠ¨ç«¯çš„å…¼å®¹æ€§é—®é¢˜**ï¼šåœ¨ç§»åŠ¨åº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é¢ä¸´ä¸€ä¸ªç°å®â€”â€”åŸç”Ÿè¯·æ±‚ä¸æ”¯æŒ Cookieã€‚é‰´äº Session ID é€šå¸¸å‚¨å­˜åœ¨ Cookie ä¸­ï¼Œè¿™ä¸€ç‚¹æ„å‘³ç€ä¼ ç»Ÿçš„åŸºäº Session çš„è®¤è¯æ–¹å¼åœ¨ç§»åŠ¨å¹³å°ä¸Šçš„é€‚ç”¨æ€§å—é™ã€‚ä¸ä¹‹ç›¸æ¯”ï¼ŒJWT æä¾›äº†ä¸€ä¸ªæ›´ä¸ºçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚ä½œä¸ºä¸€ä¸ªæ ‡å‡†åŒ–çš„ä»¤ç‰Œï¼ŒJWT å¯ä»¥é€šè¿‡ HTTP å¤´éƒ¨çš„ **Authorization** å­—æ®µè¿›è¡Œä¼ è¾“ï¼Œé¿å…äº†å¯¹ Cookie çš„ä¾èµ–ã€‚å¾—ç›Šäº JWT çš„è®¾è®¡ï¼Œå®ƒè‡ªç„¶è€Œç„¶åœ°æ”¯æŒè·¨å¹³å°åº”ç”¨ï¼Œä»è€Œæå‡äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚

## Token çš„ç¼ºç‚¹ âš ï¸

å°½ç®¡ Token åœ¨ç°ä»£ç½‘ç»œå®‰å…¨ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ï¼Œä½†å®ƒå¹¶éä¸‡èƒ½ã€‚äº‹å®ä¸Šï¼Œå¾ˆå¤šå¤§å‹ä¼ä¸šæ›´å€¾å‘äºä½¿ç”¨ Session æœºåˆ¶ã€‚Token çš„ä¸è¶³ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š

1. **Token é•¿åº¦é—®é¢˜**ï¼šToken ç”±å¤´éƒ¨ (header) å’Œè½½è· (payload) ç¼–ç è€Œæˆï¼Œé€šå¸¸æ¯”ä¼ ç»Ÿçš„ Session ID è¦é•¿å¾—å¤šã€‚éšç€å­˜å‚¨åœ¨ Token ä¸­çš„ä¿¡æ¯å¢å¤šï¼Œå…¶é•¿åº¦ä¹Ÿéšä¹‹å¢åŠ ã€‚è¿™æ„å‘³ç€æ¯æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šæºå¸¦ä¸€ä¸ªè¾ƒé•¿çš„ Tokenï¼Œè¿™æ— ç–‘å¢åŠ äº†ç½‘ç»œè¯·æ±‚çš„è´Ÿæ‹…ã€‚

2. **å®‰å…¨æ€§è€ƒé‡**ï¼šToken ä¸€èˆ¬å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œä½†å…·ä½“å­˜æ”¾ä½ç½®åˆ™æ˜¯ä¸ªé—®é¢˜ã€‚ç”±äº Token çš„é•¿åº¦é—®é¢˜ï¼Œå°†å…¶å­˜å‚¨åœ¨ Cookie ä¸­å¯èƒ½ä¼šå¯¼è‡´è¶…å‡º Cookie çš„å¤§å°é™åˆ¶ï¼Œå› æ­¤ï¼Œå®ƒä»¬é€šå¸¸è¢«å­˜å‚¨åœ¨æœ¬åœ°å­˜å‚¨ (å¦‚ LocalStorage) ä¸­ã€‚è¿™æ ·åšå¸¦æ¥äº†å®‰å…¨éšæ‚£ï¼Œå› ä¸º LocalStorage å¯ä»¥è¢« JavaScript ç›´æ¥è®¿é—®ï¼Œè¿™å¯èƒ½ä¼šè¢«æ¶æ„è„šæœ¬åˆ©ç”¨ã€‚**æ­¤å¤–ï¼Œä¸€æ—¦ Token è¢«å‘æ”¾ï¼Œå°±æ— æ³•è¢«æœåŠ¡ç«¯ä¸»åŠ¨ä½¿å…¶å¤±æ•ˆï¼Œåªèƒ½ç­‰å¾…å…¶è‡ªç„¶è¿‡æœŸã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæœåŠ¡ç«¯æ£€æµ‹åˆ°å®‰å…¨å¨èƒï¼Œä¹Ÿæ— æ³•ç«‹å³åºŸé™¤å·²ç»å‘æ”¾çš„ Tokenã€‚**

## æ— æ„Ÿåˆ·æ–° Token æœºåˆ¶ ğŸ”„

### æ¦‚è¿°

JSON Web Token (JWT) è™½ç„¶æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„èº«ä»½éªŒè¯æ–¹å¼ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼š**ä¸€æ—¦ç­¾å‘ï¼Œé™¤éæœåŠ¡å™¨é‡‡å–é¢å¤–æªæ–½ï¼Œå¦åˆ™å®ƒä¼šä¸€ç›´æœ‰æ•ˆç›´åˆ°è¿‡æœŸ**ã€‚ä¸ºäº†é™ä½æ½œåœ¨çš„å®‰å…¨é£é™©ï¼Œæ¨èä½¿ç”¨æœ‰æ•ˆæœŸè¾ƒçŸ­çš„ JWTã€‚ä¸ºäº†è¿›ä¸€æ­¥æå‡å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒï¼Œå¼•å…¥äº†æ— æ„Ÿåˆ·æ–°ä»¤ç‰Œæœºåˆ¶ã€‚

æ— æ„Ÿåˆ·æ–°ä»¤ç‰Œæœºåˆ¶å…è®¸å‰ç«¯åº”ç”¨è‡ªåŠ¨æ›´æ–°è®¿é—®ä»¤ç‰Œ (Access Token)ï¼Œè€Œæ— éœ€ç”¨æˆ·æ‰‹åŠ¨ä»‹å…¥ï¼Œä»è€Œæ— ç¼ç»´æŠ¤ä¼šè¯çš„æŒç»­æ€§å’Œåº”ç”¨çš„å®‰å…¨æ€§ã€‚è¿™ä¸€æœºåˆ¶å°¤å…¶é€‚ç”¨äºéœ€è¦æä¾›æµç•…ç”¨æˆ·ä½“éªŒçš„å•é¡µåº”ç”¨ (SPA) å’Œç§»åŠ¨åº”ç”¨ã€‚

### å·¥ä½œåŸç†

![20240419213638](https://raw.githubusercontent.com/chuenwei0129/my-picgo-repo/master/me/20240419213638.png)

1. **åŒä»¤ç‰Œç³»ç»Ÿ**ï¼šç”¨æˆ·é¦–æ¬¡ç™»å½•æ—¶ï¼Œèº«ä»½éªŒè¯æœåŠ¡å™¨åŒæ—¶å‘æ”¾çŸ­æœŸæœ‰æ•ˆçš„ Access Token å’Œé•¿æœŸçš„ Refresh Tokenã€‚Access Token ç”¨äºè®¿é—®å—ä¿æŠ¤èµ„æºï¼ŒRefresh Token åˆ™ç”¨äºåœ¨ Access Token è¿‡æœŸæ—¶è·å–æ–°çš„ Access Tokenã€‚

2. **è‡ªåŠ¨åˆ·æ–°**ï¼šå‰ç«¯åº”ç”¨ç›‘æ§ Access Token çš„æœ‰æ•ˆæœŸã€‚å½“ Access Token æ¥è¿‘è¿‡æœŸæˆ–å·²è¿‡æœŸæ—¶ï¼Œåº”ç”¨å°†è‡ªåŠ¨ä½¿ç”¨ Refresh Token è¯·æ±‚èº«ä»½éªŒè¯æœåŠ¡å™¨é¢å‘æ–°çš„ Access Tokenï¼Œæ— éœ€ç”¨æˆ·å‚ä¸ã€‚

3. **ä»¤ç‰Œæ›´æ–°**ï¼šèº«ä»½éªŒè¯æœåŠ¡å™¨åœ¨éªŒè¯ Refresh Token æœ‰æ•ˆåï¼Œå‘æ”¾æ–°çš„ Access Token (æœ‰æ—¶ä¹ŸåŒ…æ‹¬æ–°çš„ Refresh Token)ã€‚å‰ç«¯åº”ç”¨éšåæ›´æ–°å­˜å‚¨çš„ä»¤ç‰Œä¿¡æ¯ï¼Œç¡®ä¿åç»­ API è¯·æ±‚èƒ½å¤Ÿä½¿ç”¨æ–°çš„ Access Tokenã€‚

### å®æ–½ç­–ç•¥

- **HTTP è¯·æ±‚æ‹¦æˆª**ï¼šé€šè¿‡ HTTP è¯·æ±‚æ‹¦æˆªå™¨ (å¦‚ Angular çš„ HttpInterceptor æˆ– Axios çš„ interceptors)ï¼Œç›‘æµ‹ API å“åº”çŠ¶æ€ã€‚è‹¥å‘ç° Access Token å¤±æ•ˆ (é€šå¸¸è¡¨ç°ä¸º 401 æˆ– 403 é”™è¯¯)ï¼Œåˆ™è‡ªåŠ¨è§¦å‘ Token åˆ·æ–°æµç¨‹ã€‚

- **å‰ç«¯å­˜å‚¨**ï¼šé€‰æ‹©åˆé€‚çš„å­˜å‚¨æ–¹å¼ (LocalStorageã€SessionStorage æˆ–å†…å­˜) å¯¹å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚ä¸åŒçš„å­˜å‚¨æ–¹æ¡ˆæœ‰å…¶ä¼˜ç¼ºç‚¹ï¼Œéœ€æ ¹æ®åº”ç”¨éœ€æ±‚è°¨æ…é€‰æ‹©ã€‚

- **å®‰å…¨æªæ–½**ï¼šä¸ºé˜²æ­¢ Refresh Token æ³„éœ²ï¼Œå®æ–½æ— æ„Ÿåˆ·æ–°ä»¤ç‰Œæœºåˆ¶æ—¶åº”è€ƒè™‘é¢å¤–çš„å®‰å…¨æªæ–½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä½¿ç”¨å®‰å…¨çš„ä»¤ç‰Œå­˜å‚¨æ–¹æ¡ˆã€åˆç†è®¾ç½®ä»¤ç‰Œæœ‰æ•ˆæœŸã€å¼ºåˆ¶ä½¿ç”¨ HTTPS ç­‰ã€‚

## æ‹“å±•ï¼šOAuth ğŸŒ

> [ä½ ç®¡è¿™ç ´ç©æ„å« OAuth](https://mp.weixin.qq.com/s?__biz=Mzk0MjE3NDE0Ng==&mid=2247496108&idx=1&sn=e8571ca239c974e8e93a10a12190497f&chksm=c2c58b01f5b20217de013699bd6978ae213d545605d4de49a19348b01241ebe2dd534b671767&scene=178&cur_album_id=1703494881072955395#rd)
