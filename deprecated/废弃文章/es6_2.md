# é€Ÿè¯» ECMAScript 6 å…¥é—¨ï¼ˆäºŒï¼‰<!-- omit in toc -->

- [è¿ç®—ç¬¦](#è¿ç®—ç¬¦)
- [æ•°å€¼](#æ•°å€¼)
  - [æ•°å€¼åˆ†éš”ç¬¦](#æ•°å€¼åˆ†éš”ç¬¦)
  - [Number.isNaN()](#numberisnan)
  - [BigInt æ•°æ®ç±»å‹](#bigint-æ•°æ®ç±»å‹)
    - [`BigInt` å‡½æ•°](#bigint-å‡½æ•°)
    - [è½¬æ¢è§„åˆ™](#è½¬æ¢è§„åˆ™)
    - [æ•°å­¦è¿ç®—](#æ•°å­¦è¿ç®—)
- [å­—ç¬¦ä¸²](#å­—ç¬¦ä¸²)
  - [å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•](#å­—ç¬¦çš„-unicode-è¡¨ç¤ºæ³•)
  - [ç›´æ¥è¾“å…¥ U+2028 å’Œ U+2029](#ç›´æ¥è¾“å…¥-u2028-å’Œ-u2029)
  - [JSON.stringify() çš„æ”¹é€ ](#jsonstringify-çš„æ”¹é€ )
  - [æ¨¡æ¿å­—ç¬¦ä¸²](#æ¨¡æ¿å­—ç¬¦ä¸²)
  - [å®ä¾‹æ–¹æ³•ï¼šcodePointAt()](#å®ä¾‹æ–¹æ³•codepointat)
  - [String.fromCodePoint()](#stringfromcodepoint)
  - [String.raw()](#stringraw)
- [æ•°ç»„](#æ•°ç»„)
  - [æ‰©å±•è¿ç®—ç¬¦](#æ‰©å±•è¿ç®—ç¬¦)
  - [Array.from()](#arrayfrom)
  - [Array.of()](#arrayof)
  - [å®ä¾‹æ–¹æ³•ï¼šentries()ï¼Œkeys() å’Œ values()](#å®ä¾‹æ–¹æ³•entrieskeys-å’Œ-values)
  - [æ•°ç»„çš„ç©ºä½](#æ•°ç»„çš„ç©ºä½)
- [å‡½æ•°](#å‡½æ•°)
  - [å‚æ•°](#å‚æ•°)
  - [å‡½æ•°çš„ length å±æ€§](#å‡½æ•°çš„-length-å±æ€§)
  - [å‚æ•°ä½œç”¨åŸŸ](#å‚æ•°ä½œç”¨åŸŸ)
  - [ç®­å¤´å‡½æ•°](#ç®­å¤´å‡½æ•°)
  - [å‡½æ•°å‚æ•°çš„å°¾é€—å·](#å‡½æ•°å‚æ•°çš„å°¾é€—å·)
  - [Function.prototype.toString()](#functionprototypetostring)
  - [catch è¯­å¥çœç•¥å‚æ•°](#catch-è¯­å¥çœç•¥å‚æ•°)
- [å¯¹è±¡](#å¯¹è±¡)
  - [å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•å’Œå±æ€§åè¡¨è¾¾å¼](#å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•å’Œå±æ€§åè¡¨è¾¾å¼)
  - [æ–¹æ³•çš„ name å±æ€§](#æ–¹æ³•çš„-name-å±æ€§)
  - [å±æ€§çš„å¯æšä¸¾æ€§](#å±æ€§çš„å¯æšä¸¾æ€§)
  - [å±æ€§çš„éå†](#å±æ€§çš„éå†)
  - [super å…³é”®å­—](#super-å…³é”®å­—)
  - [å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦](#å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦)
  - [å¯¹è±¡çš„æ–°å¢æ–¹æ³•](#å¯¹è±¡çš„æ–°å¢æ–¹æ³•)
- [Set å’Œ Map æ•°æ®ç»“æ„](#set-å’Œ-map-æ•°æ®ç»“æ„)
  - [Set](#set)
  - [WeakSet](#weakset)
  - [Map](#map)
  - [WeakMap](#weakmap)
  - [WeakRef](#weakref)
- [è§£æ„èµ‹å€¼](#è§£æ„èµ‹å€¼)
  - [æ•°ç»„çš„è§£æ„èµ‹å€¼](#æ•°ç»„çš„è§£æ„èµ‹å€¼)
  - [å¯¹è±¡çš„è§£æ„èµ‹å€¼](#å¯¹è±¡çš„è§£æ„èµ‹å€¼)
  - [åŸå§‹ç±»å‹åŒ…è£…å¯¹è±¡çš„è§£æ„èµ‹å€¼](#åŸå§‹ç±»å‹åŒ…è£…å¯¹è±¡çš„è§£æ„èµ‹å€¼)
  - [å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼](#å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼)
- [Symbol](#symbol)
  - [æ¦‚è¿°](#æ¦‚è¿°)
  - [å†…ç½®çš„ Symbol å€¼](#å†…ç½®çš„-symbol-å€¼)
    - [Symbol.hasInstance](#symbolhasinstance)
    - [Symbol.iterator](#symboliterator)
    - [Symbol.toPrimitive](#symboltoprimitive)

## [è¿ç®—ç¬¦](https://es6.ruanyifeng.com/#docs/operator)

```js
// æŒ‡æ•°è¿ç®—ç¬¦
// å³ç»“åˆæ€§
console.log(2 ** (3 ** 4))

let x = 2
console.log((x **= 2))


// é“¾åˆ¤æ–­è¿ç®—ç¬¦
// åœ¨é“¾å¼è°ƒç”¨çš„æ—¶å€™åˆ¤æ–­ï¼Œå·¦ä¾§çš„å¯¹è±¡æ˜¯å¦ä¸º null æˆ– undefinedã€‚å¦‚æœæ˜¯çš„ï¼Œå°±ä¸å†å¾€ä¸‹è¿ç®—ï¼Œè€Œæ˜¯è¿”å› undefinedã€‚
a?.b
// ç­‰åŒäº
a == null ? undefined : a.b

a?.[x]
// ç­‰åŒäº
a == null ? undefined : a[x]

a?.b()
// ç­‰åŒäº
a == null ? undefined : a.b()

a?.()
// ç­‰åŒäº
a == null ? undefined : a()

// ES2020 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ Null åˆ¤æ–­è¿ç®—ç¬¦ ??ã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼||ï¼Œä½†æ˜¯åªæœ‰è¿ç®—ç¬¦å·¦ä¾§çš„å€¼ä¸º null æˆ– undefined æ—¶ï¼Œæ‰ä¼šè¿”å›å³ä¾§çš„å€¼
console.log(null ?? 1) // 1

// é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦
// æˆ–èµ‹å€¼è¿ç®—ç¬¦
x ||= y
// ç­‰åŒäº
x || (x = y)

// ä¸èµ‹å€¼è¿ç®—ç¬¦
x &&= y
// ç­‰åŒäº
x && (x = y)

// Null èµ‹å€¼è¿ç®—ç¬¦
x ??= y
// ç­‰åŒäº
x ?? (x = y)
```

> [js ä¸­ x = x || y å’Œ x || (x = y) æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ](https://www.zhihu.com/question/414969457/answer/1416743993)

## [æ•°å€¼](https://es6.ruanyifeng.com/#docs/number)

### æ•°å€¼åˆ†éš”ç¬¦

ES2021ï¼Œå…è®¸ JavaScript çš„æ•°å€¼ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ä½œä¸ºåˆ†éš”ç¬¦ã€‚

è¿™ä¸ªæ•°å€¼åˆ†éš”ç¬¦æ²¡æœ‰æŒ‡å®šé—´éš”çš„ä½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æ¯ä¸‰ä½æ·»åŠ ä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œä¹Ÿå¯ä»¥æ¯ä¸€ä½ã€æ¯ä¸¤ä½ã€æ¯å››ä½æ·»åŠ ä¸€ä¸ªã€‚

æ•°å€¼åˆ†éš”ç¬¦æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚

- ä¸èƒ½æ”¾åœ¨æ•°å€¼çš„æœ€å‰é¢ï¼ˆleadingï¼‰æˆ–æœ€åé¢ï¼ˆtrailingï¼‰ã€‚
- ä¸èƒ½ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„åˆ†éš”ç¬¦è¿åœ¨ä¸€èµ·ã€‚
- å°æ•°ç‚¹çš„å‰åä¸èƒ½æœ‰åˆ†éš”ç¬¦ã€‚
- ç§‘å­¦è®¡æ•°æ³•é‡Œé¢ï¼Œè¡¨ç¤ºæŒ‡æ•°çš„ `e` æˆ– `E` å‰åä¸èƒ½æœ‰åˆ†éš”ç¬¦ã€‚

```js
console.log(123_00 === 12_300) // true
console.log(123_00_0000 === 1_23_00_0_000) // true
console.log(0.0000_1 === 0.00001) // true
console.log(1.2e1_0 === 12_000_000_000) // true
```

ä¸‹é¢ä¸‰ä¸ªå°†å­—ç¬¦ä¸²è½¬æˆæ•°å€¼çš„å‡½æ•°ï¼Œä¸æ”¯æŒæ•°å€¼åˆ†éš”ç¬¦ã€‚**ä¸»è¦åŸå› æ˜¯è¯­è¨€çš„è®¾è®¡è€…è®¤ä¸ºï¼Œæ•°å€¼åˆ†éš”ç¬¦ä¸»è¦æ˜¯ä¸ºäº†ç¼–ç æ—¶ä¹¦å†™æ•°å€¼çš„æ–¹ä¾¿ï¼Œè€Œä¸æ˜¯ä¸ºäº†å¤„ç†å¤–éƒ¨è¾“å…¥çš„æ•°æ®ã€‚**

- Number()
- parseInt()
- parseFloat()

```js
console.log(parseInt('123_00')) // 123
console.log(Number('123_00')) // NaN
```

### Number.isNaN()

`Number.isNaN()` åªæœ‰å¯¹äº `NaN` æ‰è¿”å› `true`ï¼Œé `NaN` ä¸€å¾‹è¿”å› `false`ã€‚

ä¸ä¼ ç»Ÿçš„å…¨å±€æ–¹æ³• `isNaN()` çš„åŒºåˆ«åœ¨äºï¼Œä¼ ç»Ÿæ–¹æ³•å…ˆè°ƒç”¨ `Number()` å°†éæ•°å€¼çš„å€¼è½¬ä¸ºæ•°å€¼ï¼Œå†è¿›è¡Œåˆ¤æ–­ï¼Œè€Œè¿™ä¸ªæ–°æ–¹æ³•åªå¯¹æ•°å€¼æœ‰æ•ˆã€‚

```js
console.log(isNaN(NaN)) // true
console.log(isNaN('NaN')) // true
console.log(Number.isNaN(NaN)) // true
console.log(Number.isNaN('NaN')) // false
```

### BigInt æ•°æ®ç±»å‹

`BigInt` å¯ä»¥ä½¿ç”¨è´Ÿå·ï¼ˆ-ï¼‰ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨æ­£å·ï¼ˆ+ï¼‰ï¼Œå› ä¸ºä¼šä¸ `asm.js` å†²çªã€‚

```js
console.log(2 ** 53 === 2 ** 53 + 1) // true
console.log(2n ** 53n === 2n ** 53n + 1n) // false
console.log(2n === 2) // false
console.log(typeof 2n) // "bigint"
```

#### `BigInt` å‡½æ•°

JavaScript åŸç”Ÿæä¾› `BigInt` å‡½æ•°ï¼Œå¯ä»¥ç”¨å®ƒç”Ÿæˆ `BigInt` ç±»å‹çš„æ•°å€¼ã€‚è½¬æ¢è§„åˆ™åŸºæœ¬ä¸ `Number()` ä¸€è‡´ï¼Œå°†å…¶ä»–ç±»å‹çš„å€¼è½¬ä¸º `BigInt`ã€‚

```js
BigInt(undefined) //TypeError
BigInt(null) // TypeError
BigInt('123n') // SyntaxError
BigInt(123) // 123n
BigInt('123') // 123n
BigInt(false) // 0n
BigInt(true) // 1n
BigInt(1.5) // RangeError
BigInt('1.5') // SyntaxError
```

#### è½¬æ¢è§„åˆ™

å¯ä»¥ä½¿ç”¨ `Boolean()`ã€`Number()` å’Œ `String()` è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œå°† `BigInt` å¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ã€æ•°å€¼å’Œå­—ç¬¦ä¸²ç±»å‹ã€‚

```js
Boolean(0n) // false
Boolean(1n) // true
Number(1n)  // 1
String(1n)  // "1"
!0n // true
!1n // false
```

#### æ•°å­¦è¿ç®—

```js
9n / 5n // 1n
```

å‡ ä¹æ‰€æœ‰çš„æ•°å€¼è¿ç®—ç¬¦éƒ½å¯ä»¥ç”¨åœ¨ `BigInt`ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªä¾‹å¤–ã€‚

- ä¸å¸¦ç¬¦å·çš„å³ç§»ä½è¿ç®—ç¬¦ `>>>`
- ä¸€å…ƒçš„æ±‚æ­£è¿ç®—ç¬¦ `+`

`BigInt` ä¸èƒ½ä¸æ™®é€šæ•°å€¼è¿›è¡Œæ··åˆè¿ç®—ã€‚

```js
1n + 1.3 // æŠ¥é”™
```

`BigInt` ä¸å­—ç¬¦ä¸²æ··åˆè¿ç®—æ—¶ï¼Œä¼šå…ˆè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå†è¿›è¡Œè¿ç®—ã€‚

```js
'' + 123n // "123"
```

## [å­—ç¬¦ä¸²](https://es6.ruanyifeng.com/#docs/string)

### å­—ç¬¦çš„ Unicode è¡¨ç¤ºæ³•

```js
'\z' === 'z'  // true
'\172' === 'z' // true
'\x7A' === 'z' // true
// è¿™ç§è¡¨ç¤ºæ³•åªé™äºç ç‚¹åœ¨\u0000~\uFFFFä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨ç¤º
'\u007A' === 'z' // true
// å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦
'\u{7A}' === 'z' // true
```

### ç›´æ¥è¾“å…¥ U+2028 å’Œ U+2029

JavaScript è§„å®šæœ‰ 5 ä¸ªå­—ç¬¦ï¼Œä¸èƒ½åœ¨å­—ç¬¦ä¸²é‡Œé¢ç›´æ¥ä½¿ç”¨ï¼Œåªèƒ½ä½¿ç”¨è½¬ä¹‰å½¢å¼ã€‚

- **U+005Cï¼š** åæ–œæ ï¼ˆreverse solidus)
- **U+000Dï¼š** å›è½¦ï¼ˆcarriage returnï¼‰
- **U+2028ï¼š** è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰
- **U+2029ï¼š** æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰
- **U+000Aï¼š** æ¢è¡Œç¬¦ï¼ˆline feedï¼‰

ä¸ºäº†å…¼å®¹ JSONï¼ŒES2019 å…è®¸ JavaScript å­—ç¬¦ä¸²ç›´æ¥è¾“å…¥ U+2028ï¼ˆè¡Œåˆ†éš”ç¬¦ï¼‰å’Œ U+2029ï¼ˆæ®µåˆ†éš”ç¬¦ï¼‰ã€‚

> æ³¨æ„ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²ç°åœ¨å°±å…è®¸ç›´æ¥è¾“å…¥è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚å¦å¤–ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¾ç„¶ä¸å…è®¸ç›´æ¥è¾“å…¥è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º JSON æœ¬æ¥å°±ä¸å…è®¸ç›´æ¥åŒ…å«æ­£åˆ™è¡¨è¾¾å¼ã€‚

### JSON.stringify() çš„æ”¹é€ 

æ ¹æ®æ ‡å‡†ï¼ŒJSON æ•°æ®å¿…é¡»æ˜¯ UTF-8 ç¼–ç ã€‚ä½†æ˜¯ï¼Œç°åœ¨çš„ `JSON.stringify()` æ–¹æ³•æœ‰å¯èƒ½è¿”å›ä¸ç¬¦åˆ UTF-8 æ ‡å‡†çš„å­—ç¬¦ä¸²ã€‚

å…·ä½“æ¥è¯´ï¼ŒUTF-8 æ ‡å‡†è§„å®šï¼Œ`0xD800` åˆ° `0xDFFF` ä¹‹é—´çš„ç ç‚¹ï¼Œä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»é…å¯¹ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œ`\uD834\uDF06` æ˜¯ä¸¤ä¸ªç ç‚¹ï¼Œä½†æ˜¯å¿…é¡»æ”¾åœ¨ä¸€èµ·é…å¯¹ä½¿ç”¨ï¼Œä»£è¡¨å­—ç¬¦ `ğŒ†`ã€‚è¿™æ˜¯ä¸ºäº†è¡¨ç¤ºç ç‚¹å¤§äº `0xFFFF` çš„å­—ç¬¦çš„ä¸€ç§å˜é€šæ–¹æ³•ã€‚å•ç‹¬ä½¿ç”¨ `\uD834` å’Œ `\uDF06` è¿™ä¸¤ä¸ªç ç‚¹æ˜¯ä¸åˆæ³•çš„ï¼Œæˆ–è€…é¢ å€’é¡ºåºä¹Ÿä¸è¡Œï¼Œå› ä¸º `\uDF06\uD834` å¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ã€‚

`JSON.stringify()` çš„é—®é¢˜åœ¨äºï¼Œå®ƒå¯èƒ½è¿”å› `0xD800` åˆ° `0xDFFF` ä¹‹é—´çš„å•ä¸ªç ç‚¹ã€‚

```js
JSON.stringify('\u{D834}') // "\u{D834}"
```

ä¸ºäº†ç¡®ä¿è¿”å›çš„æ˜¯åˆæ³•çš„ UTF-8 å­—ç¬¦ï¼Œ[ES2019](https://github.com/tc39/proposal-well-formed-stringify)Â æ”¹å˜äº† `JSON.stringify()` çš„è¡Œä¸ºã€‚å¦‚æœé‡åˆ° `0xD800` åˆ° `0xDFFF` ä¹‹é—´çš„å•ä¸ªç ç‚¹ï¼Œæˆ–è€…ä¸å­˜åœ¨çš„é…å¯¹å½¢å¼ï¼Œå®ƒä¼šè¿”å›è½¬ä¹‰å­—ç¬¦ä¸²ï¼Œç•™ç»™åº”ç”¨è‡ªå·±å†³å®šä¸‹ä¸€æ­¥çš„å¤„ç†ã€‚

```js
JSON.stringify('\u{D834}') // ""\\uD834""
JSON.stringify('\uDF06\uD834') // ""\\udf06\\ud834""
```

### æ¨¡æ¿å­—ç¬¦ä¸²

```js
let x = 1,
  y = 2
console.log(`${x} + ${y} = ${x + y}`) // 1 + 2 = 3

const fn = () => 'hello'
console.log(`${fn()} world`) // hello world

console.log(`hello ${'world'}`) // hello world

// å¯ä»¥åµŒå¥—
// æ ‡ç­¾æ¨¡æ¿
let a = 5
let b = 10

function tag(s, v1, v2) {
  console.log(s[0]) // 'hello '
  console.log(s[1]) // ' world '
  console.log(s[2]) // ''
  console.log(v1) // 15
  console.log(v2) // 50

  return 'OK'
}

console.log(tag`Hello ${a + b} world ${a * b}`) // OK

// å…ˆæŠŠä¸éœ€è¦æ›¿æ¢çš„å‚æ•°æå‡ºæ¥ [ 'Hello ', ' world ', ' ' ]
// å†è®¡ç®— 15
// 50
// tag([ 'Hello ', ' world ', ' ' ], 15, 50)
```

### å®ä¾‹æ–¹æ³•ï¼šcodePointAt()

JavaScript å†…éƒ¨ï¼Œå­—ç¬¦ä»¥ UTF-16 çš„æ ¼å¼å‚¨å­˜ï¼Œ**æ¯ä¸ªå­—ç¬¦å›ºå®šä¸º 2 ä¸ªå­—èŠ‚**ã€‚å¯¹äºé‚£äº›éœ€è¦ 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼ˆUnicode ç ç‚¹å¤§äº0xFFFFçš„å­—ç¬¦ï¼‰ï¼ŒJavaScript ä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªå­—ç¬¦ã€‚

```js
console.log('ğŸ‘'.length) // 2
console.log([...'ğŸ‘'].length) // 1
```

å¯¹äºè¿™ç§ 4 ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScript ä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º 2ï¼Œè€Œä¸”`charAt()` æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼Œ`charCodeAt()` æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚

ES6 æä¾›äº† `codePointAt()` æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç† 4 ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚

```js
let s = 'ğŸ‘a'
console.log(s.codePointAt(0).toString(16)) // 1f44d
console.log(s.codePointAt(2).toString(16)) // 61 'a'
```

`codePointAt()` æ–¹æ³•çš„å‚æ•°ï¼Œä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ a åœ¨å­—ç¬¦ä¸²sçš„æ­£ç¡®ä½ç½®åºå·åº”è¯¥æ˜¯ 1ï¼Œä½†æ˜¯å¿…é¡»å‘ `codePointAt()` æ–¹æ³•ä¼ å…¥ 2ã€‚

```js
for (let char of s) {
  console.log(char.codePointAt(0).toString(16))
}
```

`codePointAt()` æ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚

```js
function is32Bit(c) {
  return c.codePointAt(0) > 0xFFFF
}
```

### String.fromCodePoint()

ES6 æä¾›äº† `String.fromCodePoint()` æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«å¤§äº `0xFFFF` çš„å­—ç¬¦ï¼Œå¼¥è¡¥äº† `String.fromCharCode()` æ–¹æ³•çš„ä¸è¶³ã€‚åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸`codePointAt()` æ–¹æ³•ç›¸åã€‚

> æ³¨æ„ï¼ŒfromCodePoint æ–¹æ³•å®šä¹‰åœ¨ String å¯¹è±¡ä¸Šï¼Œè€Œ codePointAt æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚

### String.raw()

ES6 è¿˜ä¸ºåŸç”Ÿçš„ String å¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª `raw()` æ–¹æ³•ã€‚è¯¥æ–¹æ³•**è¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²**ï¼Œå¾€å¾€ç”¨äºæ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†æ–¹æ³•ã€‚

```js
console.log(`\\`) // '\'
console.log(String.raw`\\`) // '\\'
```

## [æ•°ç»„](https://es6.ruanyifeng.com/#docs/array)

### æ‰©å±•è¿ç®—ç¬¦

```js
// æ‰©å±•è¿ç®—ç¬¦åé¢è¿˜å¯ä»¥æ”¾ç½®è¡¨è¾¾å¼
// å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåˆ™ä¸äº§ç”Ÿä»»ä½•æ•ˆæœ
console.log([...(Math.random() > 0.5 ? [1, 2, 3] : [4, 5, 6]), ...[]])

// æ›¿ä»£å‡½æ•°çš„ apply() æ–¹æ³•
console.log(Math.max.apply(null, [1, 2, 3])) // 3
console.log(Math.max(...[1, 2, 3])) // 3

// èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«å››ä¸ªå­—èŠ‚çš„ Unicode å­—ç¬¦
console.log('ğŸ‘'.length) // 2
console.log([...'ğŸ‘'].length) // 1

// ä»»ä½•å®šä¹‰äº†éå†å™¨ï¼ˆIteratorï¼‰æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„
console.log([...new Set('hello')]) // ['h', 'e', 'l', 'o']
console.log([...new Map(Object.entries({ a: 1, b: 2 }))]) // [['a', 1], ['b', 2]]

// ç±»æ•°ç»„
console.log([...'hello world']) // ['h', 'e', 'l', 'l', 'o', ' ', 'w', 'o', 'r', 'l', 'd']
```

### Array.from()

`Array.from()` æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆarray-like objectï¼‰å’Œå¯éå†ï¼ˆiterableï¼‰çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ ES6 æ–°å¢çš„æ•°æ®ç»“æ„ Set å’Œ Mapï¼‰

```js
// å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼ŒArray.from()ä¼šè¿”å›ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ–°æ•°ç»„ã€‚
console.log(Array.from([1, 2, 3])) // [1, 2, 3]

// æ‰€è°“ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå³å¿…é¡»æœ‰ length å±æ€§ã€‚
console.log(Array.from({ length: 3 })) // [undefined, undefined, undefined]

// Array.from() è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„ map() æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚
console.log(Array.from([1, 2, 3], x => x ** x)) // [1, 4, 27]
// å¦‚æœ map() å‡½æ•°é‡Œé¢ç”¨åˆ°äº† this å…³é”®å­—ï¼Œè¿˜å¯ä»¥ä¼ å…¥ Array.from() çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š this
// å®ƒä¹Ÿèƒ½æ­£ç¡®å¤„ç†å„ç§ Unicode å­—ç¬¦
```

### Array.of()

`Array.of()` æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚

```js
Array.of(3, 11, 8) // [3,11,8]
Array.of(3) // [3]
Array.of(3).length // 1
```

è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•° `Array()` çš„ä¸è¶³ã€‚å› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´ `Array()` çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚

```js
Array() // []
Array(3) // [, , ,]
Array(3, 11, 8) // [3, 11, 8]
```

### å®ä¾‹æ–¹æ³•ï¼šentries()ï¼Œkeys() å’Œ values()

```js
// Array.prototype.keys() Array.prototype.values() Array.prototype.entries()
const arr2 = ['a', 'b', 'c']
for (let index of arr2.keys()) {
  console.log(index) // 0 1 2
}
for (let value of arr2.values()) {
  console.log(value) // a b c
}
for (let [index, value] of arr2.entries()) {
  console.log(index, value) // 0 a 1 b 2 c
}

// at()
console.log(arr2.at(-1)) // c
```

### æ•°ç»„çš„ç©ºä½

æ•°ç»„çš„ç©ºä½æŒ‡çš„æ˜¯ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ï¼Œæ¯”å¦‚ `Array()` æ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ã€‚

ç©ºä½ä¸æ˜¯ `undefined`ï¼ŒæŸä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº `undefined`ï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„ã€‚ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼ï¼Œ`in` è¿ç®—ç¬¦å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚

```js
console.log(0 in [undefined]) // true
console.log(0 in Array(1)) // false
```

ES6 åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º `undefined`ï¼Œæ‹·è´å’Œéå†éƒ½ä¸ä¼šå¿½ç•¥ã€‚

- `Array.from()` æ–¹æ³•ä¼šå°†æ•°ç»„çš„ç©ºä½ï¼Œè½¬ä¸º `undefined`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šå¿½ç•¥ç©ºä½ã€‚

- æ‰©å±•è¿ç®—ç¬¦ï¼ˆ`...`ï¼‰ä¹Ÿä¼šå°†ç©ºä½è½¬ä¸º`undefined`ã€‚

- `copyWithin()` ä¼šè¿ç©ºä½ä¸€èµ·æ‹·è´ã€‚

- `fill()` ä¼šå°†ç©ºä½è§†ä¸ºæ­£å¸¸çš„æ•°ç»„ä½ç½®ã€‚

- `for...of` å¾ªç¯ä¹Ÿä¼šéå†ç©ºä½ã€‚

- `entries()`ã€`keys()`ã€`values()`ã€`find()` å’Œ `findIndex()` ä¼šå°†ç©ºä½å¤„ç†æˆ `undefined`ã€‚

## [å‡½æ•°](https://es6.ruanyifeng.com/#docs/function)

### å‚æ•°

```js
// æƒ°æ€§æ±‚å€¼
let x = 99
const foo = (p = x + 1) => {
  console.log(p)
}
foo() // 100
x = 100
foo() // 101

// æ˜¾å¼è¾“å…¥ undefined ä½¿é»˜è®¤å€¼ç”Ÿæ•ˆ
function bar(x = 5, y = 6) {
  console.log(x, y)
}

bar(undefined, null) // 5 null
```

### å‡½æ•°çš„ length å±æ€§

æŒ‡å®šäº†é»˜è®¤å€¼ä»¥åï¼Œå‡½æ•°çš„ length å±æ€§ï¼Œå°†è¿”å›æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‡å®šäº†é»˜è®¤å€¼åï¼Œlength å±æ€§å°†å¤±çœŸã€‚

```js
console.log(function (...args) {}.length) // 0
```

### å‚æ•°ä½œç”¨åŸŸ

ä¸€æ—¦è®¾ç½®äº†å‚æ•°çš„é»˜è®¤å€¼ï¼Œå‡½æ•°è¿›è¡Œå£°æ˜åˆå§‹åŒ–æ—¶ï¼Œå‚æ•°ä¼šå½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼ˆcontextï¼‰ã€‚ç­‰åˆ°åˆå§‹åŒ–ç»“æŸï¼Œè¿™ä¸ªä½œç”¨åŸŸå°±ä¼šæ¶ˆå¤±ã€‚**è¿™ç§è¯­æ³•è¡Œä¸ºï¼Œåœ¨ä¸è®¾ç½®å‚æ•°é»˜è®¤å€¼æ—¶ï¼Œæ˜¯ä¸ä¼šå‡ºç°çš„**ï¼ˆä¸è®¾ç½®å‚æ•°é»˜è®¤å€¼æ—¶å‚æ•°ä¸å‡½æ•°ä½“åŒä¸€ä½œç”¨åŸŸï¼‰ã€‚

> [ES6 å‚æ•°ä½œç”¨åŸŸå’Œå‡½æ•°ä½“ä½œç”¨åŸŸæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ](https://www.zhihu.com/question/325718311/answer/693162235)

```js
function f2(
  x = 2,
  f = function () {
    x = 3
  }
) {
  var x
  f()
  console.log(x)
}

f2() // 2

function f1(
  x2 = 2,
  f = function () {
    x2 = 3
  }
) {
  let x2 = 5 // SyntaxError: Identifier 'x2' has already been declared
  f()
  console.log(x2)
}
f1()

// è™½ç„¶æ˜¯åŸºç¡€çŸ¥è¯†ï¼Œä½†ä¼°è®¡å¤§éƒ¨åˆ†äººä¸çŸ¥é“ï¼›å¸¦é»˜è®¤å‚æ•°å€¼çš„å‡½æ•°çš„å‡½æ•°ä½“é‡Œç¬¬ä¸€å±‚ä½œç”¨åŸŸä¸èƒ½å†å£°æ˜ lexical çš„åŒåå‚æ•°çš„åŸå› å¾ˆç®€å•ï¼šå¦‚æœè®©ä½ å£°æ˜äº†ï¼Œé‚£é‚£ä¸ªå‚æ•°çš„å®å‚è¿˜èƒ½æ‹¿çš„åˆ°å—ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†å’Œä¸å¸¦é»˜è®¤å‚æ•°å€¼çš„å‡½æ•°ç»Ÿä¸€ï¼›åŠ ä¸€å±‚ block å°±ç®¡ä¸ç€äº† {let y = 4}ï¼›åŠ ä¸ª debugger Chrome é‡Œèƒ½çœ‹åˆ°æ¯ä¸ª yã€‚
```

### ç®­å¤´å‡½æ•°

ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚

1. ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this` å¯¹è±¡ã€‚

2. ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥å¯¹ç®­å¤´å‡½æ•°ä½¿ç”¨ `new` å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚

3. ä¸å¯ä»¥ä½¿ç”¨ `arguments` å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨ `rest` å‚æ•°ä»£æ›¿ã€‚

4. ä¸å¯ä»¥ä½¿ç”¨ `yield` å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œ Generator å‡½æ•°ã€‚

> [ä¸ºä»€ä¹ˆç®­å¤´å‡½æ•°å¯ä»¥è¢« bind?](https://www.zhihu.com/question/329538868/answer/722663600)

### å‡½æ•°å‚æ•°çš„å°¾é€—å·

ES2017 å…è®¸å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å°¾é€—å·ï¼ˆtrailing commaï¼‰ã€‚

### Function.prototype.toString()

```js
function func(x, y = 'b') {
  // do something
}

console.log(func.toString())

// function func(x, y = 'b') {
//   do something
// }
```

### catch è¯­å¥çœç•¥å‚æ•°

```js
try {
  // ...
} catch {
  // ...
}
```

## [å¯¹è±¡](https://es6.ruanyifeng.com/#docs/object#%E5%B1%9E%E6%80%A7%E7%9A%84%E7%AE%80%E6%B4%81%E8%A1%A8%E7%A4%BA%E6%B3%95)

### å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•å’Œå±æ€§åè¡¨è¾¾å¼

```js
// å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•
let birth = '2000/01/01'

const Person = {
  _name: 'å¼ ä¸‰',

  // ç­‰åŒäº birth: birth
  birth,

  // ç­‰åŒäº hello: function ()...
  // ç±»å­—é¢é‡çš„æ–¹æ³•æœ‰ super å…³é”®å­—ï¼Œä¸Šé¢å‡½æ•°æ²¡æœ‰ super å…³é”®å­—
  // ç±»å­—é¢é‡çš„æ–¹æ³•ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°
  hello() {
    console.log('æˆ‘çš„åå­—æ˜¯', this.name)
  },

  get name() {
    return this._name
  },

  set name(value) {
    this._name = value
  }
}

// å±æ€§åè¡¨è¾¾å¼
let propKey = 'foo'
let key = { a: 1 }

let obj = {
  [propKey]: true,
  ['a' + 'bc']() {
    return 'abc'
  },
  // å±æ€§åè¡¨è¾¾å¼å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨å°†å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸² `[object Object]`
  [key]: true
}

console.log(obj) // { foo: true, abc: [Function: abc] } '[object Object]': true
```

### æ–¹æ³•çš„ name å±æ€§

å‡½æ•°çš„ `name` å±æ€§ï¼Œè¿”å›å‡½æ•°åã€‚å¯¹è±¡æ–¹æ³•ä¹Ÿæ˜¯å‡½æ•°ï¼Œå› æ­¤ä¹Ÿæœ‰ `name` å±æ€§ã€‚

```js
const person = {
  sayName() {
    console.log('hello!')
  }
}
person.sayName.name // "sayName"
```

ä¸Šé¢ä»£ç ä¸­ï¼Œæ–¹æ³•çš„ `name` å±æ€§è¿”å›å‡½æ•°åï¼ˆå³æ–¹æ³•åï¼‰ã€‚

å¦‚æœå¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨äº†å–å€¼å‡½æ•°ï¼ˆ`getter`ï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆ`setter`ï¼‰ï¼Œåˆ™ `name` å±æ€§ä¸æ˜¯åœ¨è¯¥æ–¹æ³•ä¸Šé¢ï¼Œè€Œæ˜¯è¯¥æ–¹æ³•çš„å±æ€§çš„æè¿°å¯¹è±¡çš„ `get` å’Œ `set` å±æ€§ä¸Šé¢ï¼Œè¿”å›å€¼æ˜¯æ–¹æ³•åå‰åŠ ä¸Š `get` å’Œ `set`ã€‚

```js
const obj1 = {
  get foo() {},
  set foo(x) {}
}

// obj.foo.name
// TypeError: Cannot read property 'name' of undefined

const descriptor = Object.getOwnPropertyDescriptor(obj1, 'foo')
console.log(descriptor.get.name) // "get foo"
console.log(descriptor.set.name) // "set foo"
```

æœ‰ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼š`bind` æ–¹æ³•åˆ›é€ çš„å‡½æ•°ï¼Œ`name` å±æ€§è¿”å› `bound` åŠ ä¸ŠåŸå‡½æ•°çš„åå­—ï¼›`Function` æ„é€ å‡½æ•°åˆ›é€ çš„å‡½æ•°ï¼Œ`name` å±æ€§è¿”å› `anonymous`ã€‚

```js
console.log(new Function().name) // "anonymous"

const doSomething = function () {
  // ...
}
console.log(doSomething.name) // "doSomething"
```

å¦‚æœå¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸ª `Symbol` å€¼ï¼Œé‚£ä¹ˆ `name` å±æ€§è¿”å›çš„æ˜¯è¿™ä¸ª `Symbol` å€¼çš„æè¿°ã€‚

```js
const key1 = Symbol('description')
const key2 = Symbol()
let obj2 = {
  [key1]() {},
  [key2]() {}
}
console.log(obj2[key1].name) // "description"
console.log(obj2[key2].name) // ""
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`key1` å¯¹åº”çš„ `Symbol` å€¼æœ‰æè¿°ï¼Œ`key2` æ²¡æœ‰ã€‚

### å±æ€§çš„å¯æšä¸¾æ€§

å¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªæè¿°å¯¹è±¡ï¼ˆDescriptorï¼‰ï¼Œç”¨æ¥æ§åˆ¶è¯¥å±æ€§çš„è¡Œä¸ºã€‚`Object.getOwnPropertyDescriptor` æ–¹æ³•å¯ä»¥è·å–è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚

```js
const obj3 = { foo: 1 }
const descriptor1 = Object.getOwnPropertyDescriptor(obj3, 'foo')

console.log(descriptor1) // { value: 1, writable: true, enumerable: true, configurable: true }
```

æè¿°å¯¹è±¡çš„ `enumerable` å±æ€§ï¼Œç§°ä¸ºâ€œå¯æšä¸¾æ€§â€ï¼Œå¦‚æœè¯¥å±æ€§ä¸º `false`ï¼Œå°±è¡¨ç¤ºæŸäº›æ“ä½œä¼šå¿½ç•¥å½“å‰å±æ€§ã€‚

- `for...in` å¾ªç¯ï¼š åªéå†**å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾**çš„å±æ€§ã€‚
- `Object.keys()`ï¼š è¿”å›å¯¹è±¡**è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾**çš„å±æ€§çš„é”®åã€‚
- `JSON.stringify()`ï¼š åªä¸²è¡ŒåŒ–**å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾**çš„å±æ€§ã€‚
- `Object.assign()`ï¼š å¿½ç•¥`enumerable`ä¸º`false`çš„å±æ€§ï¼Œ**åªæ‹·è´å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾**çš„å±æ€§ã€‚

### å±æ€§çš„éå†

ES6 ä¸€å…±æœ‰ 5 ç§æ–¹æ³•å¯ä»¥éå†å¯¹è±¡çš„å±æ€§ã€‚

> **ï¼ˆ1ï¼‰for...in**

`for...in` å¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å« `Symbol` å±æ€§ï¼‰ã€‚

> **ï¼ˆ2ï¼‰Object.keys(obj)**

`Object.keys` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å« `Symbol` å±æ€§ï¼‰çš„é”®åã€‚

> **ï¼ˆ3ï¼‰Object.getOwnPropertyNames(obj)**

`Object.getOwnPropertyNames` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰çš„é”®åã€‚

> **ï¼ˆ4ï¼‰Object.getOwnPropertySymbols(obj)**

`Object.getOwnPropertySymbols` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰ `Symbol` å±æ€§çš„é”®åã€‚

> **ï¼ˆ5ï¼‰Reflect.ownKeys(obj)**

`Reflect.ownKeys` è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰é”®åï¼Œä¸ç®¡é”®åæ˜¯ `Symbol` æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸ç®¡æ˜¯å¦å¯æšä¸¾ã€‚

ä»¥ä¸Šçš„ 5 ç§æ–¹æ³•éå†å¯¹è±¡çš„é”®åï¼Œéƒ½éµå®ˆåŒæ ·çš„å±æ€§éå†çš„æ¬¡åºè§„åˆ™ã€‚

- é¦–å…ˆéå†æ‰€æœ‰æ•°å€¼é”®ï¼ŒæŒ‰ç…§æ•°å€¼å‡åºæ’åˆ—ã€‚
- å…¶æ¬¡éå†æ‰€æœ‰å­—ç¬¦ä¸²é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ—ã€‚
- æœ€åéå†æ‰€æœ‰ `Symbol` é”®ï¼ŒæŒ‰ç…§åŠ å…¥æ—¶é—´å‡åºæ’åˆ—ã€‚

```js
console.log(
  Reflect.ownKeys({
    [Symbol()]: 1,
    10: 2,
    3: 3,
    a: 4
  })
) // [ '3', '10', 'a', Symbol() ]
```

ä¸Šé¢ä»£ç ä¸­ï¼Œ`Reflect.ownKeys` æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å‚æ•°å¯¹è±¡çš„æ‰€æœ‰å±æ€§ã€‚è¿™ä¸ªæ•°ç»„çš„å±æ€§æ¬¡åºæ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆæ˜¯æ•°å€¼å±æ€§ `3` å’Œ `10`ï¼Œå…¶æ¬¡æ˜¯å­—ç¬¦ä¸²å±æ€§ `a`ï¼Œæœ€åæ˜¯ `Symbol` å±æ€§ã€‚

### super å…³é”®å­—

`this` å…³é”®å­—æ€»æ˜¯æŒ‡å‘å‡½æ•°æ‰€åœ¨çš„å½“å‰å¯¹è±¡ï¼ŒES6 åˆæ–°å¢äº†å¦ä¸€ä¸ªç±»ä¼¼çš„å…³é”®å­— `super`ï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚

JavaScript å¼•æ“å†…éƒ¨ï¼Œ`super.foo` ç­‰åŒäº `Object.getPrototypeOf(this).foo`ï¼ˆå±æ€§ï¼‰æˆ– `Object.getPrototypeOf(this).foo.call(this)`ï¼ˆæ–¹æ³•ï¼‰ã€‚

```js
// æŠ¥é”™
const obj = {
  foo: super.foo
}

// æŠ¥é”™
const obj = {
  foo: () => super.foo
}

// æŠ¥é”™
const obj = {
  foo: function () {
    return super.foo
  }
}
```

### å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦

```js
let z = { a: 3, b: 4 }
let n = { ...z }
console.log(n) // { a: 3, b: 4 }

let arrLike = { ...[1, 2, 3] }
console.log(arrLike) // { '0': 1, '1': 2, '2': 3 }

console.log({ ...{}, ...{ a: 1 }, b: 2 }) // { a: 1, b: 2 }

// ç­‰åŒäº { ...Object(true), ...Object(null), ...} === {}
// å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒä¼šè‡ªåŠ¨è½¬æˆä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå› æ­¤è¿”å›çš„ä¸æ˜¯ç©ºå¯¹è±¡ã€‚
console.log({ ...1, ...'abc', ...true, ...null, ...undefined }) // { '0': 'a', '1': 'b', '2': 'c' }

// å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ï¼Œåªä¼šè¿”å›å‚æ•°å¯¹è±¡è‡ªèº«çš„ã€å¯æšä¸¾çš„å±æ€§
class C {
  p = 12
  m() {} // ä¸å¯æšä¸¾ï¼Œå®ä¾‹åŸå‹ä¸Šçš„æ–¹æ³•
}

let c = new C()
let clone = { ...c }

console.log(clone) // { p: 12 }

// ç­‰åŒäº console.log({ ...clone, ...{ q: 13 } })
Object.assign(clone, { q: 13 })
console.log(clone) // { p: 12, q: 13 }
```

### å¯¹è±¡çš„æ–°å¢æ–¹æ³•

```js
// Object.is()
console.log(+0 === -0) // true
console.log(NaN === NaN) // false

console.log(Object.is(+0, -0)) // false
console.log(Object.is(NaN, NaN)) // true

// Object.assign()
// Object.assign() æ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡ï¼ˆsourceï¼‰çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆtargetï¼‰ã€‚
const target = { a: 1 }
const source1 = { a: 2, b: 2 }
const source2 = { c: 3 }

Object.assign(target, source1, source2)
console.log(target) // { a: 2, b: 2, c: 3 }

// éšå¼ç±»å‹è½¬æ¢
console.log(typeof Object.assign(2)) // "object"

// å¦‚æœ undefined å’Œ null ä¸åœ¨é¦–å‚æ•°ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚
let obj4 = { a: 1 }
console.log(Object.assign(obj4, undefined, null) === obj4) // true

// å±æ€§åä¸º Symbol å€¼çš„å±æ€§ï¼Œä¹Ÿä¼šè¢« Object.assign() æ‹·è´ã€‚
console.log(Object.assign({ a: 'b' }, { [Symbol('c')]: 'd' })) // { a: 'b', [Symbol(c)]: 'd' }

// Object.assign æ–¹æ³•æ€»æ˜¯æ‹·è´ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œè€Œä¸ä¼šæ‹·è´å®ƒèƒŒåçš„èµ‹å€¼æ–¹æ³•æˆ–å–å€¼æ–¹æ³•ã€‚
const source3 = {
  get foo() {
    return 1
  }
}
const target2 = {}
console.log(Object.assign(target2, source3)) // { foo: 1 }

// Object.getOwnPropertyDescriptors()
const obj5 = {
  foo: 123,
  get bar() {
    return 'abc'
  }
}

console.log(Object.getOwnPropertyDescriptors(obj5)) // { foo: { value: 123, writable: true, enumerable: true, configurable: true }, bar: { get: [Function: get bar], set: undefined, enumerable: true, configurable: true } }

// __proto__å±æ€§ï¼ŒObject.setPrototypeOf()ï¼ŒObject.getPrototypeOf()
const obj6 = { a: 1 }
const obj7 = Object.create(obj6)
console.log(obj7.__proto__ === obj6) // true

Object.setPrototypeOf(obj7, null)
console.log(obj7.__proto__ === obj6) // false
console.log(Object.getPrototypeOf(obj7)) // null

// Object.keys()ï¼ŒObject.values()ï¼ŒObject.entries()
const obj8 = { foo: 123, bar: 456 }
console.log(Object.keys(obj8)) // [ 'foo', 'bar' ]
console.log(Object.values(obj8)) // [ 123, 456 ]
console.log(Object.entries(obj8)) // [ [ 'foo', 123 ], [ 'bar', 456 ] ]

// Object.fromEntries()
console.log(
  Object.fromEntries([
    ['foo', 123],
    ['bar', 456]
  ])
) // { foo: 123, bar: 456 }

const map = new Map([
  ['a', 1],
  ['b', 2]
])

console.log(Object.fromEntries(map)) // { a: 1, b: 2 }
```

## [Set å’Œ Map æ•°æ®ç»“æ„](https://es6.ruanyifeng.com/#docs/set-map)

å¦‚æœæŠŠä¸€ä¸ªå¯¹è±¡æ”¾å…¥åˆ°æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªæ•°ç»„å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¹Ÿå°±å­˜åœ¨ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼ˆä¸»åŠ¨ç”¨ null æ¸…é™¤å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ä¹Ÿæ— æ•ˆï¼‰ã€‚

ç±»ä¼¼çš„ï¼Œ**å¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¸¸è§„ Map çš„é”®ï¼Œé‚£ä¹ˆå½“ Map å­˜åœ¨æ—¶ï¼Œè¯¥å¯¹è±¡ä¹Ÿå°†å­˜åœ¨ã€‚å®ƒä¼šå ç”¨å†…å­˜**ï¼Œå¹¶ä¸”åº”è¯¥ä¸ä¼šè¢«ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ï¼‰å›æ”¶ã€‚

### Set

ES6 æä¾›äº†æ–°çš„æ•°æ®ç»“æ„ `Set`ã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚

`Set` å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–è€…å…·æœ‰ iterable æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ï¼‰ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–ã€‚

```js
const arrLike = {
  0: 'a',
  1: 'b',
  2: 'c',
  length: 3
}

// æŠ¥é”™
const s = new Set(arrLike)
console.log(s) // TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))

// æ•°ç»„åšä¸ºå‚æ•°
const s = new Set(Array.from(arrLike))
console.log(s) // Set(3) { 'a', 'b', 'c' }
```

å‘ `Set` åŠ å…¥å€¼çš„æ—¶å€™ï¼Œ**ä¸ä¼šå‘ç”Ÿç±»å‹è½¬æ¢**ï¼Œ`Set` å†…éƒ¨åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸åŒï¼Œä½¿ç”¨çš„ç®—æ³•å«åšâ€œSame-value-zero equalityâ€ï¼Œå®ƒç±»ä¼¼äºç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ï¼Œä¸»è¦çš„åŒºåˆ«æ˜¯**å‘ `Set` åŠ å…¥å€¼æ—¶è®¤ä¸º NaN ç­‰äºè‡ªèº«ï¼Œè€Œç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦è®¤ä¸º NaN ä¸ç­‰äºè‡ªèº«ã€‚**

```js
let a = NaN
let b = NaN

console.log(a === b) // false
console.log(Object.is(a, b)) // true

// add åªæ¥å—ç¬¬ä¸€ä¸ªå‚æ•°
s.add(a)
s.add(b)
s.add('d')

console.log(s) // Set(4) { 'a', 'b', 'c', NaN ,'d' }
```

**Set å®ä¾‹çš„å±æ€§å’Œæ–¹æ³•ï¼š**

- `Set.prototype.constructor`ï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯ Set å‡½æ•°ã€‚
- `Set.prototype.size`ï¼šè¿”å› `Set` å®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚
- `Set.prototype.add(value)`ï¼šæ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å› `Set` ç»“æ„æœ¬èº«ã€‚
- `Set.prototype.delete(value)`ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸã€‚
- `Set.prototype.has(value)`ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸º `Set` çš„æˆå‘˜ã€‚
- `Set.prototype.clear()`ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚
- `Set.prototype.keys()`ï¼šè¿”å›é”®åçš„éå†å™¨
- `Set.prototype.values()`ï¼šè¿”å›é”®å€¼çš„éå†å™¨
- `Set.prototype.entries()`ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨
- `Set.prototype.forEach()`ï¼šä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜

```js
// Set ç»“æ„çš„å®ä¾‹é»˜è®¤å¯éå†ï¼Œå®ƒçš„é»˜è®¤éå†å™¨ç”Ÿæˆå‡½æ•°å°±æ˜¯å®ƒçš„ values æ–¹æ³•ã€‚
Set.prototype[Symbol.iterator] === Set.prototype.values // true
```

### WeakSet

`WeakSet` ç»“æ„ä¸ `Set` ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆã€‚ä½†æ˜¯ï¼Œå®ƒä¸ `Set` æœ‰ä¸¤ä¸ªåŒºåˆ«ã€‚

é¦–å…ˆï¼Œ`WeakSet` çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œè€Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼ã€‚
å…¶æ¬¡ï¼Œ`WeakSet` ä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ä¸è€ƒè™‘ `WeakSet` å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚

**`WeakSet` æ²¡æœ‰ `size` å±æ€§ï¼Œæ²¡æœ‰åŠæ³•éå†å®ƒçš„æˆå‘˜ã€‚**

`WeakSet` ç»“æ„æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ã€‚

- **WeakSet.prototype.add(value)**ï¼šå‘ `WeakSet` å®ä¾‹æ·»åŠ ä¸€ä¸ªæ–°æˆå‘˜ã€‚
- **WeakSet.prototype.delete(value)**ï¼šæ¸…é™¤ `WeakSet` å®ä¾‹çš„æŒ‡å®šæˆå‘˜ã€‚
- **WeakSet.prototype.has(value)**ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªå€¼æ˜¯å¦åœ¨ `WeakSet` å®ä¾‹ä¹‹ä¸­ã€‚

### Map

ES6 æä¾›äº† `Map` æ•°æ®ç»“æ„ã€‚**å®ƒç±»ä¼¼äºå¯¹è±¡ï¼Œä¹Ÿæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œä½†æ˜¯â€œé”®â€çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®**ã€‚

ä»»ä½•å…·æœ‰ Iterator æ¥å£ã€ä¸”æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªåŒå…ƒç´ çš„æ•°ç»„çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥å½“ä½œ `Map` æ„é€ å‡½æ•°çš„å‚æ•°ã€‚

```js
const s1 = new Set([
  [1, 2],
  [3, 4]
])

console.log(s1) // Set(2) { [1, 2], [3, 4] }
const m1 = new Map(s1)
console.log(m1) // Map(2) { 1 => 2, 3 => 4 }
```

å¦‚æœ `Map` çš„é”®æ˜¯ä¸€ä¸ªç®€å•ç±»å‹çš„å€¼ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œåˆ™åªè¦ä¸¤ä¸ªå€¼ä¸¥æ ¼ç›¸ç­‰ï¼ˆè¡Œä¸ºåŒ `Object.is()`ï¼‰ï¼Œ`Map` å°†å…¶è§†ä¸ºä¸€ä¸ªé”®ã€‚

å¯¹äºå¯¹è±¡ï¼Œ`Map` çš„é”®å®é™…ä¸Šæ˜¯è·Ÿå†…å­˜åœ°å€ç»‘å®šçš„ï¼Œåªè¦å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œå°±è§†ä¸ºä¸¤ä¸ªé”®ã€‚

**å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•ï¼š**

- `size` å±æ€§è¿”å› `Map` ç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚
- `set` æ–¹æ³•è®¾ç½®é”®å `key` å¯¹åº”çš„é”®å€¼ä¸º `value`ï¼Œç„¶åè¿”å›æ•´ä¸ª  `Map` ç»“æ„ã€‚å¦‚æœ `key` å·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±æ–°ç”Ÿæˆè¯¥é”®ã€‚
- `get` æ–¹æ³•è¯»å– `key` å¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ° `key`ï¼Œè¿”å› `undefined`ã€‚
- `has` æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰ `Map` å¯¹è±¡ä¹‹ä¸­ã€‚
- `delete` æ–¹æ³•åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å› `true`ã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å› `false`ã€‚
- `clear` æ–¹æ³•æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚
- `Map.prototype.keys()`ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚
- `Map.prototype.values()`ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚
- `Map.prototype.entries()`ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚
- `Map.prototype.forEach()`ï¼šéå† `Map` çš„æ‰€æœ‰æˆå‘˜ã€‚

> éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ`Map` çš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚

```js
// å¯¹åŒä¸€ä¸ªé”®å¤šæ¬¡èµ‹å€¼ï¼Œåé¢çš„å€¼å°†è¦†ç›–å‰é¢çš„å€¼ã€‚
m1.set(NaN, 1)
m1.set(NaN, 2)
console.log(m1) // Map(2) { 1 => 2, 3 => 4, NaN => 2 }

// åªæœ‰å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ŒMap ç»“æ„æ‰å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚
let o = { a: 1 }
let o1 = { a: 1 }
let o2 = o
m1.set(o, 1)
m1.set(o1, 2)
m1.set(o2, 3)

console.log(m1) // Map(3) { 1 => 2, 3 => 4, NaN => 2, { a: 1 } => 3, { a: 1 } => 2  }

// å¦‚æœè¯»å–ä¸€ä¸ªæœªçŸ¥çš„é”®ï¼Œåˆ™è¿”å› `undefined`ã€‚
console.log(m1.get('c')) // undefined

// éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒMap çš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚
for (const it of m1.keys()) {
  console.log(it) // 1, 3, NaN, { a: 1 }, { a: 1 }
}
```

### WeakMap

WeakMapä¸Mapçš„åŒºåˆ«æœ‰ä¸¤ç‚¹ã€‚

é¦–å…ˆï¼Œ`WeakMap` åªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®åã€‚
å…¶æ¬¡ï¼Œ`WeakMap` çš„é”®åæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ã€‚

`WeakMap` ä¸ `Map` åœ¨ API ä¸Šçš„åŒºåˆ«ä¸»è¦æ˜¯ä¸¤ä¸ªï¼Œä¸€æ˜¯æ²¡æœ‰éå†æ“ä½œï¼ˆå³æ²¡æœ‰ `keys()`ã€`values()` å’Œ `entries()` æ–¹æ³•ï¼‰ï¼Œä¹Ÿæ²¡æœ‰ `size` å±æ€§ã€‚äºŒæ˜¯æ— æ³•æ¸…ç©ºï¼Œå³ä¸æ”¯æŒ `clear` æ–¹æ³•ã€‚å› æ­¤ï¼Œ`WeakMap` åªæœ‰å››ä¸ªæ–¹æ³•å¯ç”¨ï¼š`get()`ã€`set()`ã€`has()`ã€`delete()`ã€‚

### WeakRef

`WeakSet` å’Œ `WeakMap` æ˜¯åŸºäºå¼±å¼•ç”¨çš„æ•°æ®ç»“æ„ï¼ŒES2021 æ›´è¿›ä¸€æ­¥ï¼Œæä¾›äº† `WeakRef` å¯¹è±¡ï¼Œç”¨äºç›´æ¥åˆ›å»ºå¯¹è±¡çš„å¼±å¼•ç”¨ã€‚

```js
let target = { a: 1 }
let wr = new WeakRef(target)

// å¦‚æœåŸå§‹å¯¹è±¡å­˜åœ¨ï¼Œè¯¥æ–¹æ³•è¿”å›åŸå§‹å¯¹è±¡ï¼›å¦‚æœåŸå§‹å¯¹è±¡å·²ç»è¢«åƒåœ¾å›æ”¶æœºåˆ¶æ¸…é™¤ï¼Œè¯¥æ–¹æ³•è¿”å› undefinedã€‚
let target_origin = wr.deref()

if (target_origin) {
  console.log(wr.deref()) // { a: 1 }
}
```

ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œ`target` æ˜¯åŸå§‹å¯¹è±¡ï¼Œæ„é€ å‡½æ•° `WeakRef()` åˆ›å»ºäº†ä¸€ä¸ªåŸºäº `target` çš„æ–°å¯¹è±¡ `wr`ã€‚è¿™é‡Œï¼Œ`wr` å°±æ˜¯ä¸€ä¸ª `WeakRef` çš„å®ä¾‹ï¼Œå±äºå¯¹ `target` çš„å¼±å¼•ç”¨ï¼Œåƒåœ¾å›æ”¶æœºåˆ¶ä¸ä¼šè®¡å…¥è¿™ä¸ªå¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ`wr` çš„å¼•ç”¨ä¸ä¼šå¦¨ç¢åŸå§‹å¯¹è±¡ `target` è¢«åƒåœ¾å›æ”¶æœºåˆ¶æ¸…é™¤ã€‚

## [è§£æ„èµ‹å€¼](https://es6.ruanyifeng.com/#docs/destructuring)

### æ•°ç»„çš„è§£æ„èµ‹å€¼

```js
let [, , third] = [1, 2, 3]
console.log(third) // 3

let [first, ...rest] = [1, 2, 3]
console.log(first, rest) // 1 [2, 3]

let [foo, bar] = [1]
console.log(foo, bar) // 1 undefined

let [a] = [1, 2]
console.log(a) // 1

let [x, y, z] = new Set(['a', 'b', 'c'])
console.log(x, y, z) // a b c

let [[h, i], [j, k]] = new Map([
  [1, 2],
  [2, 3]
])
console.log(h, i, j, k) // 1 2 2 3

function* fibs() {
  let a = 0
  let b = 1
  while (true) {
    yield a
    ;[a, b] = [b, a + b]
  }
}
let [firstFib, secondFib, thirdFib, fourthFib, fifthFib] = fibs()
console.log(firstFib, secondFib, thirdFib, fourthFib, fifthFib) // 0 1 1 2 3

// é»˜è®¤å€¼
let [g = 1] = [undefined]
console.log(g) // 1

let [d = 1] = [null]
console.log(d) // null

// f() æƒ°æ€§æ±‚å€¼
const f = () => 1
let [e = f()] = [undefined]
let [r = f()] = [null]
console.log(e, r) // 1 null
```

### å¯¹è±¡çš„è§£æ„èµ‹å€¼

```js
let { q, w } = { q: 'q', w: 'w' }
console.log(q, w) // q w

let { x: q1 } = { x: 'x' }
console.log(q1) // x

let { w1 } = { w2: 'w2' }
console.log(w1) // undefined

// åµŒå¥—
let {
  y: { z: n }
} = { y: { z: 'z' } }
// y æ˜¯æ¨¡å¼ï¼Œä¸æ˜¯å˜é‡ï¼Œå› æ­¤ä¸ä¼šè¢«èµ‹å€¼
console.log(n) // z

let obj = {
  p: ['Hello', { y: 'World' }]
}
let {
  p: po,
  p: [he, { y: wo }]
} = obj
console.log(po, he, wo) // Hello { y: 'World' }  Hello World

// å¯¹è±¡é»˜è®¤å€¼
let { x1: x1 = 3 } = { x1: undefined }
console.log(x1) // 3
let { x2 = 3 } = { x2: null }
console.log(x2) // null
```

### åŸå§‹ç±»å‹åŒ…è£…å¯¹è±¡çš„è§£æ„èµ‹å€¼

```js
// å­—ç¬¦ä¸²
const [a1, b1, c1, d1, e1, f1, g1, h1] = 'hello'
console.log(a1, b1, c1, d1, e1, f1, g1, h1) // h e l l o undefined undefined undefined
const { length: len } = 'hello'
console.log(len) // 5

// æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼
let { toString: s } = 123
console.log(s === Number.prototype.toString) // true
let { valueOf: v } = true
console.log(v === Boolean.prototype.valueOf) // true

// null å’Œ undefined
let { length: len1 } = null
console.log(len1) // TypeError: Cannot destructure property 'length' of 'null' as it is null.
let { length: len2 } = undefined
console.log(len2) // TypeError: Cannot destructure property 'length' of 'undefined' as it is undefined.
```

### å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼

```js
;[
  [1, 2],
  [3, 4]
].map(([a, b]) => console.log(a + b)) // 3 7
;[1, undefined, 3].map((x = 'yes') => console.log(x)) // 1 yes 3
```

## [Symbol](https://es6.ruanyifeng.com/#docs/symbol)

### æ¦‚è¿°

ES6 å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹ `Symbol`ï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚

```js
let s1 = Symbol()
let s2 = Symbol('foo')
let s3 = Symbol('bar')
let s4 = Symbol()

// Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²
console.log(s1.toString(), s2.toString(), s3.toString()) // Symbol() Symbol(foo) Symbol(bar)
console.log(s1 === s4) // false
console.log(String(s1) === String(s4)) // true

// Symbol å€¼ä¹Ÿå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸ºæ•°å€¼
console.log(!s1) // false

// ES2019 æä¾›äº†ä¸€ä¸ªå®ä¾‹å±æ€§ descriptionï¼Œç›´æ¥è¿”å› Symbol çš„æè¿°ã€‚
console.log(s3.description) // bar

// æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é‡æ–°ä½¿ç”¨åŒä¸€ä¸ª Symbol å€¼ï¼ŒSymbol.for() æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚
let s5 = Symbol.for('foo')
let s6 = Symbol.for('foo')

console.log(s5 === s6) // true

// Symbol.keyFor() æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„ keyã€‚
console.log(Symbol.keyFor(s5)) // foo
console.log(Symbol.keyFor(s2)) // undefined

// Symbol.for() ä¸º Symbol å€¼ç™»è®°çš„åå­—ï¼Œæ˜¯å…¨å±€ç¯å¢ƒçš„ï¼Œä¸ç®¡æœ‰æ²¡æœ‰åœ¨å…¨å±€ç¯å¢ƒè¿è¡Œã€‚
```

### å†…ç½®çš„ Symbol å€¼

#### Symbol.hasInstance

å¯¹è±¡çš„ `Symbol.hasInstance` å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ã€‚å½“å…¶ä»–å¯¹è±¡ä½¿ç”¨`instanceof` è¿ç®—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè¯¥å¯¹è±¡çš„å®ä¾‹æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œ`foo instanceof Foo` åœ¨è¯­è¨€å†…éƒ¨ï¼Œå®é™…è°ƒç”¨çš„æ˜¯ `Foo[Symbol.hasInstance](foo)`ã€‚

```js
class MyClass {
  [Symbol.hasInstance](foo) {
    return foo instanceof Array;
  }
}

// foo instanceof Foo === Foo[Symbol.hasInstance](foo)
[1, 2, 3] instanceof new MyClass() // true
```

#### Symbol.iterator

å¯¹è±¡çš„ `Symbol.iterator` å±æ€§ï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„é»˜è®¤éå†å™¨æ–¹æ³•ã€‚

```js
const myIterable = {};
myIterable[Symbol.iterator] = function* () {
  yield 1
  yield 2
  yield 3
};

[...myIterable] // [1, 2, 3]
```

#### Symbol.toPrimitive

å¯¹è±¡çš„ `Symbol.toPrimitive` å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥å¯¹è±¡è¢«è½¬ä¸ºåŸå§‹ç±»å‹çš„å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡å¯¹åº”çš„åŸå§‹ç±»å‹å€¼ã€‚

`Symbol.toPrimitive` è¢«è°ƒç”¨æ—¶ï¼Œä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿ç®—çš„æ¨¡å¼ï¼Œä¸€å…±æœ‰ä¸‰ç§æ¨¡å¼ã€‚

- Numberï¼šè¯¥åœºåˆéœ€è¦è½¬æˆæ•°å€¼
- Stringï¼šè¯¥åœºåˆéœ€è¦è½¬æˆå­—ç¬¦ä¸²
- Defaultï¼šè¯¥åœºåˆå¯ä»¥è½¬æˆæ•°å€¼ï¼Œä¹Ÿå¯ä»¥è½¬æˆå­—ç¬¦ä¸²

```js
let obj = {
  [Symbol.toPrimitive](hint) {
    switch (hint) {
      case 'number':
        return 123;
      case 'string':
        return 'str';
      case 'default':
        return 'default';
      default:
        throw new Error();
      }
    }
};

2 * obj // 246
3 + obj // '3default'
obj == 'default' // true
String(obj) // 'str'
```

- [symbol ä¸ºä»€ä¹ˆæ²¡æœ‰åŒ…è£…ç±»å‹?](https://www.zhihu.com/question/316717095/answer/628772556)
